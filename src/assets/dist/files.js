webpackJsonp([2],{2:function(t,e,a){function n(t,e){i('[data-action="'+t+'"]').click(function(t){return t.preventDefault(),t.stopPropagation(),e(),!1})}var i=a(1);e.define=n},34:function(t,e,a){function n(t){location.href=w+"/open"+t}function i(t){t[0].ondragenter=function(e){return e.stopPropagation(),e.preventDefault(),e.dropEffect="copy",t.addClass("accept"),!1},t[0].ondragleave=function(e){return e.stopPropagation(),e.preventDefault(),t.removeClass("accept"),!1},t[0].ondragover=function(t){return t.stopPropagation(),t.preventDefault(),t.dropEffect="copy",!1},t[0].ondrop=function(e){e.stopPropagation(),e.preventDefault();var a=event.dataTransfer.files,n=new FormData;n.append("request_token",k);for(var i=0;i<a.length;i++)n.append("file"+i,a[i]);var r=new XMLHttpRequest;return r.open("POST",w+"/api/upload?path="+t.data("path")),r.send(n),!1}}function r(t){t.hasClass("file-directory")||t.dblclick(function(){return n(m(this).data("path")),!1}),t.click(function(t){return t.shiftKey?m(this).addClass("active"):(c(m(this).data("path")),history.pushState({cwd:C},document.title,w+"/files"+C),m(this).parent().parent().find("a").removeClass("active"),m(this).addClass("active")),!1})}function o(t){var e=m('<a class="file">');return e.text(t.name),q.filter(function(e){return e===t.path}).length>0&&e.addClass("active"),e.attr("data-path",t.path),e.attr("href",w+"/files"+t.path),e.addClass("file-"+t.type),r(e),e}function l(t,e){var a=m("<li>");a.append(o(e)),t.children("ul").append(a)}function f(t,e){var a=m('<li class="file-info">'),i=m('<span class="file">');i.addClass("file-"+e.type);var r=m('<span class="file-name">');r.text(e.name);var o=m('<span class="file-modified">');o.text(new Date(1e3*e.modified).toString());var l=m("<button>Open in editor</button>");l.click(function(){n(e.path)}),a.append(i).append(r).append(o).append(l),t.children("ul").append(a)}function s(){q.length<=1||(q.pop(),C=q[q.length-1],d(),history.pushState({cwd:C},document.title,w+"/files"+C))}function p(){x.data("path",null),u(x,C)}function c(t){var e=t.split("/"),t="";q=["/"];for(var a=0;a<e.length;a++)".."===e[a]?q.length>1&&(q.pop(),t=q[q.length-1]):""!==e[a]&&"."!==e[a]&&(t+="/"+e[a],q.push(t));C=q[q.length-1],d()}function d(){console.log("stack",q,"cwd",C,"stackOffset",D);var t=y.children(),e=t.length;D=Math.max(0,Math.min(D,q.length-1),q.length-e);for(var a=0;a<e;a++)if(D+a<q.length){var n=a;u(t.eq(n),q[D+n]),x=t.eq(n)}else u(t.eq(a),null);m(".header-path").text(C),document.title=C+" â€“ Files"}function u(t,e){if(t.data("path")!==e){var a=t.children("ul");a.empty(),t.data("path",null),null!==e&&m.ajax({url:w+"/api/list-files",data:{path:e},success:function(a){if(t.data("path",e),"directory"===a.type)for(var n=0;n<a.files.length;n++){var i=a.files[n];l(t,i)}else f(t,a)}})}}function h(){var t=y.children().length,e=Math.max(1,Math.floor(y.width()/200));if(e>t)for(var a=e-t,n=0;n<a;n++){var r=m('<div class="files-panel">');r.append("<ul>"),r.appendTo(y),i(r)}else{if(!(e<t))return!1;for(var o=t-e,n=0;n<o;n++)y.children().last().remove()}return y.children().css("width",100/e+"%"),!0}function v(){y.height(m(window).height()-150)}var m=a(1),g=a(2),w=m("body").data("path").replace(/\/$/,""),y=m(".files-columns"),k=y.data("token"),x=y.children().first(),C=x.data("path");x.data("path",null);var q=[],D=0,b=C;window.onpopstate=function(t){null!==t.state?c(t.state.cwd):b!==C&&c(b)},i(y.children().first()),h(),c(C),v(),m(window).resize(function(){h()&&d(),v()}),r(y.find("a")),g.define("back",function(){history.back()}),g.define("foreward",function(){history.go(1)}),g.define("up",function(){s()}),g.define("home",function(){c("/"),history.pushState({cwd:C},document.title,w+"/files"+C),y.find("a").removeClass("active")}),g.define("new-folder",function(){var t=prompt("Enter the new name:");if(null!==t){if(""===t)return void alert("Invalid name");var e;e="/"===C?C+t:C+"/"+t,m.ajax({url:w+"/api/make-dir",method:"post",data:{request_token:k,path:e},success:function(a){l(x,{name:t,path:e,type:"directory"}),c(e)}})}}),g.define("new-file",function(){var t=prompt("Enter the new name:");if(null!==t){if(""===t)return void alert("Invalid name");var e;e="/"===C?C+t:C+"/"+t,m.ajax({url:w+"/api/make-file",method:"post",data:{request_token:k,path:e},success:function(t){l(x,t),c(e)}})}}),g.define("trash",function(){confirm("Delete file: "+C)&&m.ajax({url:w+"/api/delete",method:"post",data:{request_token:k,path:C},success:function(t){s(),p()}})})}},[34]);
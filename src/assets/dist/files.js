webpackJsonp([1],[,,function(e,t,n){function a(e,t){for(var n=e.toLowerCase().split(/-|\+/),a={ctrlKey:"",altKey:"",shiftKey:""},e=n[n.length-1],i=0;i<n.length-1;i++)switch(n[i]){case"c":a.ctrlKey="c-";break;case"a":a.altKey="a-";break;case"s":a.shiftKey="s-"}e=a.ctrlKey+a.altKey+a.shiftKey+e,s[e]=t}function i(e,t){u[e]=t,c('[data-action="'+e+'"]').click(function(e){return e.preventDefault(),e.stopPropagation(),t(),!1})}function r(e){u[e]()}function o(e){"string"==typeof e?c('[data-action="'+e+'"]').attr("disabled",!1):e.forEach(o)}function l(e){"string"==typeof e?c('[data-action="'+e+'"]').attr("disabled",!0):e.forEach(l)}var c=n(1);t.define=i,t.enable=o,t.disable=l,t.activate=r,t.bind=a;var u={},s={};c(window).keydown(function(e){if(!e.defaultPrevented){var t="";return e.ctrlKey&&(t+="c-"),e.altKey&&(t+="a-"),e.shiftKey&&(t+="s-"),t+=e.key.toLowerCase(),console.log("pressed "+t),s.hasOwnProperty(t)?(r(s[t]),e.preventDefault(),e.stopPropagation(),!1):void 0}})},function(e,t){function n(e){var e=e.replace(/\/[^\/]+$/,"");return""===e?"/":e}function a(e){return e.replace(/^.*\//,"")}function i(e,t){e=e.trim(),e.startsWith("/")||(e=t+"/"+e);for(var n=e.split("/"),a=[],i=0;i<n.length;i++)".."===n[i]?a.length>=1&&a.pop():""!==n[i]&&"."!==n[i]&&a.push(n[i]);return"/"+a.join("/")}t.dirName=n,t.fileName=a,t.convert=i},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(a){"object"==typeof window&&(n=window)}e.exports=n},,function(e,t,n){(function(e,a){function i(e,t){this._id=e,this._clearFn=t}var r=n(45).nextTick,o=Function.prototype.apply,l=Array.prototype.slice,c={},u=0;t.setTimeout=function(){return new i(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=u++,a=!(arguments.length<2)&&l.call(arguments,1);return c[n]=!0,r(function(){c[n]&&(a?e.apply(null,a):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof a?a:function(e){delete c[e]}}).call(t,n(6).setImmediate,n(6).clearImmediate)},,,,,,,,,function(e,t,n){"use strict";(function(t){function a(e,t){function n(e){return se.containers.indexOf(e)!==-1||ue.isContainer(e)}function a(e){var t=e?"remove":"add";i(x,t,"mousedown",k),i(x,t,"mouseup",D)}function l(e){var t=e?"remove":"add";i(x,t,"mousemove",S)}function v(e){var t=e?"remove":"add";b[t](x,"selectstart",E),b[t](x,"click",E)}function g(){a(!0),D({})}function E(e){le&&e.preventDefault()}function k(e){te=e.clientX,ne=e.clientY;var t=1!==r(e)||e.metaKey||e.ctrlKey;if(!t){var n=e.target,a=P(n);a&&(le=a,l(),"mousedown"===e.type&&(h(n)?n.focus():e.preventDefault()))}}function S(e){if(le){if(0===r(e))return void D({});if(void 0===e.clientX||e.clientX!==te||void 0===e.clientY||e.clientY!==ne){if(ue.ignoreInputTextSelection){var t=y("clientX",e),n=y("clientY",e),a=T.elementFromPoint(t,n);if(h(a))return}var i=le;l(!0),v(),N(),I(i);var c=o(Q);Z=y("pageX",e)-c.left,ee=y("pageY",e)-c.top,C.add(re||Q,"gu-transit"),H(),A(e)}}}function P(e){if(!(se.dragging&&J||n(e))){for(var t=e;p(e)&&n(p(e))===!1;){if(ue.invalid(e,t))return;if(e=p(e),!e)return}var a=p(e);if(a&&!ue.invalid(e,t)){var i=ue.moves(e,a,t,m(e));if(i)return{item:e,source:a}}}}function O(e){return!!P(e)}function L(e){var t=P(e);t&&I(t)}function I(e){V(e.item,e.source)&&(re=e.item.cloneNode(!0),se.emit("cloned",re,e.item,"copy")),G=e.source,Q=e.item,ae=ie=m(e.item),se.dragging=!0,se.emit("drag",Q,G)}function _(){return!1}function N(){if(se.dragging){var e=re||Q;q(e,p(e))}}function K(){le=!1,l(!0),v(!0)}function D(e){if(K(),se.dragging){var t=re||Q,n=y("clientX",e),a=y("clientY",e),i=c(J,n,a),r=Y(i,n,a);r&&(re&&ue.copySortSource||!re||r!==G)?q(t,r):ue.removeOnSpill?X():j()}}function q(e,t){var n=p(e);re&&ue.copySortSource&&t===G&&n.removeChild(Q),F(t)?se.emit("cancel",e,G,G):se.emit("drop",e,t,G,ie),M()}function X(){if(se.dragging){var e=re||Q,t=p(e);t&&t.removeChild(e),se.emit(re?"cancel":"remove",e,t,G),M()}}function j(e){if(se.dragging){var t=arguments.length>0?e:ue.revertOnSpill,n=re||Q,a=p(n),i=F(a);i===!1&&t&&(re?a&&a.removeChild(re):G.insertBefore(n,ae)),i||t?se.emit("cancel",n,G,G):se.emit("drop",n,a,G,ie),M()}}function M(){var e=re||Q;K(),U(),e&&C.rm(e,"gu-transit"),oe&&clearTimeout(oe),se.dragging=!1,ce&&se.emit("out",e,ce,G),se.emit("dragend",e),G=Q=re=ae=ie=oe=ce=null}function F(e,t){var n;return n=void 0!==t?t:J?ie:m(re||Q),e===G&&n===ae}function Y(e,t,a){function i(){var i=n(r);if(i===!1)return!1;var o=$(r,e),l=z(r,o,t,a),c=F(r,l);return!!c||ue.accepts(Q,r,G,l)}for(var r=e;r&&!i();)r=p(r);return r}function A(e){function t(e){se.emit(e,u,ce,G)}function n(){d&&t("over")}function a(){ce&&t("out")}if(J){e.preventDefault();var i=y("clientX",e),r=y("clientY",e),o=i-Z,l=r-ee;J.style.left=o+"px",J.style.top=l+"px";var u=re||Q,s=c(J,i,r),f=Y(s,i,r),d=null!==f&&f!==ce;(d||null===f)&&(a(),ce=f,n());var h=p(u);if(f===G&&re&&!ue.copySortSource)return void(h&&h.removeChild(u));var v,g=$(f,s);if(null!==g)v=z(f,g,i,r);else{if(ue.revertOnSpill!==!0||re)return void(re&&h&&h.removeChild(u));v=ae,f=G}(null===v&&d||v!==u&&v!==m(u))&&(ie=v,f.insertBefore(u,v),se.emit("shadow",u,f,G))}}function B(e){C.rm(e,"gu-hide")}function R(e){se.dragging&&C.add(e,"gu-hide")}function H(){if(!J){var e=Q.getBoundingClientRect();J=Q.cloneNode(!0),J.style.width=f(e)+"px",J.style.height=d(e)+"px",C.rm(J,"gu-transit"),C.add(J,"gu-mirror"),ue.mirrorContainer.appendChild(J),i(x,"add","mousemove",A),C.add(ue.mirrorContainer,"gu-unselectable"),se.emit("cloned",J,Q,"mirror")}}function U(){J&&(C.rm(ue.mirrorContainer,"gu-unselectable"),i(x,"remove","mousemove",A),p(J).removeChild(J),J=null)}function $(e,t){for(var n=t;n!==e&&p(n)!==e;)n=p(n);return n===x?null:n}function z(e,t,n,a){function i(){var t,i,r,o=e.children.length;for(t=0;t<o;t++){if(i=e.children[t],r=i.getBoundingClientRect(),l&&r.left+r.width/2>n)return i;if(!l&&r.top+r.height/2>a)return i}return null}function r(){var e=t.getBoundingClientRect();return o(l?n>e.left+f(e)/2:a>e.top+d(e)/2)}function o(e){return e?m(t):t}var l="horizontal"===ue.direction,c=t!==e?r():i();return c}function V(e,t){return"boolean"==typeof ue.copy?ue.copy:ue.copy(e,t)}var W=arguments.length;1===W&&Array.isArray(e)===!1&&(t=e,e=[]);var J,G,Q,Z,ee,te,ne,ae,ie,re,oe,le,ce=null,ue=t||{};void 0===ue.moves&&(ue.moves=s),void 0===ue.accepts&&(ue.accepts=s),void 0===ue.invalid&&(ue.invalid=_),void 0===ue.containers&&(ue.containers=e||[]),void 0===ue.isContainer&&(ue.isContainer=u),void 0===ue.copy&&(ue.copy=!1),void 0===ue.copySortSource&&(ue.copySortSource=!1),void 0===ue.revertOnSpill&&(ue.revertOnSpill=!1),void 0===ue.removeOnSpill&&(ue.removeOnSpill=!1),void 0===ue.direction&&(ue.direction="vertical"),void 0===ue.ignoreInputTextSelection&&(ue.ignoreInputTextSelection=!0),void 0===ue.mirrorContainer&&(ue.mirrorContainer=T.body);var se=w({containers:ue.containers,start:L,end:N,cancel:j,remove:X,destroy:g,canMove:O,dragging:!1});return ue.removeOnSpill===!0&&se.on("over",B).on("out",R),a(),se}function i(e,n,a,i){var r={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},o={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},l={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};t.navigator.pointerEnabled?b[n](e,o[a],i):t.navigator.msPointerEnabled?b[n](e,l[a],i):(b[n](e,r[a],i),b[n](e,a,i))}function r(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var t=e.button;return void 0!==t?1&t?1:2&t?3:4&t?2:0:void 0}function o(e){var t=e.getBoundingClientRect();return{left:t.left+l("scrollLeft","pageXOffset"),top:t.top+l("scrollTop","pageYOffset")}}function l(e,n){return"undefined"!=typeof t[n]?t[n]:x.clientHeight?x[e]:T.body[e]}function c(e,t,n){var a,i=e||{},r=i.className;return i.className+=" gu-hide",a=T.elementFromPoint(t,n),i.className=r,a}function u(){return!1}function s(){return!0}function f(e){return e.width||e.right-e.left}function d(e){return e.height||e.bottom-e.top}function p(e){return e.parentNode===T?null:e.parentNode}function h(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||v(e)}function v(e){return!!e&&("false"!==e.contentEditable&&("true"===e.contentEditable||v(p(e))))}function m(e){function t(){var t=e;do t=t.nextSibling;while(t&&1!==t.nodeType);return t}return e.nextElementSibling||t()}function g(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function y(e,t){var n=g(t),a={pageX:"clientX",pageY:"clientY"};return e in a&&!(e in n)&&a[e]in n&&(e=a[e]),n[e]}var w=n(36),b=n(37),C=n(40),T=document,x=T.documentElement;e.exports=a}).call(t,n(4))},,function(e,t){},,,,,,,function(e,t,n){var a=n(1);t.shake=function(e,t){t="undefined"==typeof t?10:t;var n=2*t;return a(e).width(a(e).width()).animate({marginLeft:"+="+t},50).animate({marginLeft:"-="+n},50).animate({marginLeft:"+="+n},50).animate({marginLeft:"-="+t},50).queue(function(){a(e).css("width","").css("margin-left","").finish()})},t.onLongPress=function(e,t){var n=!1,a=function(e){n=!0},i=function(e){n=!1};e.addEventListener("touchstart",a),e.addEventListener("touchend",i),e.addEventListener("touchcancel",i),e.addEventListener("touchmove",i),e.addEventListener("contextmenu",function(e){if(n)return t(e)})}},function(e,t){e.exports=function(e,t){return Array.prototype.slice.call(e,t)}},,,,,,,,,,function(e,t,n){"use strict";var a=n(47);e.exports=function(e,t,n){e&&a(function(){e.apply(n||null,t||[])})}},function(e,t,n){"use strict";var a=n(25),i=n(35);e.exports=function(e,t){var n=t||{},r={};return void 0===e&&(e={}),e.on=function(t,n){return r[t]?r[t].push(n):r[t]=[n],e},e.once=function(t,n){return n._once=!0,e.on(t,n),e},e.off=function(t,n){var a=arguments.length;if(1===a)delete r[t];else if(0===a)r={};else{var i=r[t];if(!i)return e;i.splice(i.indexOf(n),1)}return e},e.emit=function(){var t=a(arguments);return e.emitterSnapshot(t.shift()).apply(this,t)},e.emitterSnapshot=function(t){var o=(r[t]||[]).slice(0);return function(){var r=a(arguments),l=this||e;if("error"===t&&n["throws"]!==!1&&!o.length)throw 1===r.length?r[0]:r;return o.forEach(function(a){n.async?i(a,r,l):a.apply(l,r),a._once&&e.off(t,a)}),e}},e}},function(e,t,n){"use strict";(function(t){function a(e,t,n,a){return e.addEventListener(t,n,a)}function i(e,t,n){return e.attachEvent("on"+t,u(e,t,n))}function r(e,t,n,a){return e.removeEventListener(t,n,a)}function o(e,t,n){var a=s(e,t,n);if(a)return e.detachEvent("on"+t,a)}function l(e,t,n){function a(){var e;return h.createEvent?(e=h.createEvent("Event"),e.initEvent(t,!0,!0)):h.createEventObject&&(e=h.createEventObject()),e}function i(){return new d(t,{detail:n})}var r=p.indexOf(t)===-1?i():a();e.dispatchEvent?e.dispatchEvent(r):e.fireEvent("on"+t,r)}function c(e,n,a){return function(n){var i=n||t.event;i.target=i.target||i.srcElement,i.preventDefault=i.preventDefault||function(){i.returnValue=!1},i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=!0},i.which=i.which||i.keyCode,a.call(e,i)}}function u(e,t,n){var a=s(e,t,n)||c(e,t,n);return g.push({wrapper:a,element:e,type:t,fn:n}),a}function s(e,t,n){var a=f(e,t,n);if(a){var i=g[a].wrapper;return g.splice(a,1),i}}function f(e,t,n){var a,i;for(a=0;a<g.length;a++)if(i=g[a],i.element===e&&i.type===t&&i.fn===n)return a}var d=n(39),p=n(38),h=t.document,v=a,m=r,g=[];t.addEventListener||(v=i,m=o),e.exports={add:v,remove:m,fabricate:l}}).call(t,n(4))},function(e,t,n){"use strict";(function(t){var n=[],a="",i=/^on/;for(a in t)i.test(a)&&n.push(a.slice(2));e.exports=n}).call(t,n(4))},function(e,t,n){(function(t){function n(){try{var e=new a("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(t){}return!1}var a=t.CustomEvent;e.exports=n()?a:"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),n.detail=t.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n}}).call(t,n(4))},function(e,t){"use strict";function n(e){var t=r[e];return t?t.lastIndex=0:r[e]=t=new RegExp(o+e+l,"g"),t}function a(e,t){var a=e.className;a.length?n(t).test(a)||(e.className+=" "+t):e.className=t}function i(e,t){e.className=e.className.replace(n(t)," ").trim()}var r={},o="(?:^|\\s)",l="(?:\\s|$)";e.exports={add:a,rm:i}},,,,,function(e,t){function n(e){if(c===setTimeout)return setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function a(e){if(u===clearTimeout)return clearTimeout(e);try{return u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}function i(){p&&f&&(p=!1,f.length?d=f.concat(d):h=-1,d.length&&r())}function r(){if(!p){var e=n(i);p=!0;for(var t=d.length;t;){for(f=d,d=[];++h<t;)f&&f[h].run();h=-1,t=d.length}f=null,p=!1,a(e)}}function o(e,t){this.fun=e,this.array=t}function l(){}var c,u,s=e.exports={};!function(){try{c=setTimeout}catch(e){c=function(){throw new Error("setTimeout is not defined")}}try{u=clearTimeout}catch(e){u=function(){throw new Error("clearTimeout is not defined")}}}();var f,d=[],p=!1,h=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];d.push(new o(e,t)),1!==d.length||p||n(r)},o.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=l,s.addListener=l,s.once=l,s.off=l,s.removeListener=l,s.removeAllListeners=l,s.emit=l,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},,function(e,t,n){(function(t){var n,a="function"==typeof t;n=a?function(e){t(e)}:function(e){setTimeout(e,0)},e.exports=n}).call(t,n(6).setImmediate)},,,,function(e,t,n){function a(e){location.href=x+"/open"+e}function i(e){e[0].ondragenter=function(t){return t.stopPropagation(),t.preventDefault(),t.dropEffect="copy",e.addClass("accept"),!1},e[0].ondragleave=function(t){return t.stopPropagation(),t.preventDefault(),e.removeClass("accept"),!1},e[0].ondragover=function(e){return e.stopPropagation(),e.preventDefault(),e.dropEffect="copy",!1},e[0].ondrop=function(t){t.stopPropagation(),t.preventDefault();var n=event.dataTransfer.files,a=new FormData;a.append("request_token",k);for(var i=0;i<n.length;i++)a.append("file"+i,n[i]),l(e,{name:n[i].name,path:e.data("path")+"/"+n[i].name,type:"uploading"});var r=new XMLHttpRequest;return r.open("POST",x+"/api/upload?path="+e.data("path")),r.send(a),r.onreadystatechange=function(){if(3===this.readyState||4===this.readyState){var t=e.data("path");e.data("path",null),g(e,t)}},!1}}function r(e,t){_[t.path]={link:e,data:t},e.hasClass("file-directory")||e.dblclick(function(){if(!q)return a(w(this).data("path")),!1}),C.onLongPress(e[0],function(n){return n.preventDefault(),n.stopPropagation(),e.hasClass("active")?p(t.path):h(t.path),q=!0,!1}),e.click(function(n){if(n.ctrlKey||q)e.hasClass("active")?p(t.path):h(t.path);else if(n.shiftKey){var a=N[N.length-1],i=K;if(e.hasClass("active")||h(t.path),K!==i&&(a=N[0]),_.hasOwnProperty(a)){var r=_[a].link;if(r.parent().is(e.parent())){var o=!1;e.parent().children().each(function(){var t=w(this);(t.is(e)||t.is(r))&&(o=!o),o&&!t.hasClass("active")&&h(t.data("path"))})}}}else f(t.path);return!1})}function o(e){var t=w('<a class="file">');return t.text(e.name),L.filter(function(t){return t===e.path}).length>0&&t.addClass("active"),e.read||t.addClass("locked"),t.attr("data-path",e.path),t.attr("href",x+"/files"+e.path),t.addClass("file-"+e.type),r(t,e),t}function l(e,t){var n=o(t);return e.children(".files-list").append(n),n}function c(e,t){_.hasOwnProperty(t.path)||o(t);var n,i=w('<div class="file-info">');switch(t.type.toLowerCase()){case"jpeg":case"jpg":case"png":case"ico":n=w('<img class="file-thumbnail">'),n.attr("src",x+"/api/download?path="+encodeURIComponent(t.path));break;default:n=w('<span class="file">'),n.addClass("file-"+t.type),t.read||n.addClass("locked")}var r=w('<span class="file-name">');r.text(t.name);var l=w('<span class="file-modified">');l.text(new Date(1e3*t.modified).toString());var c=w('<span class="file-access">');if(c.text(t.modeString+" "+t.owner+":"+t.group+" ("+(t.read?"r":"-")+(t.write?"w":"-")+")"),i.append(n).append(r).append(l).append(c),t.read){var u=w("<button>Open in editor</button>");u.click(function(){a(t.path)}).appendTo(i)}e.children(".files-list").replaceWith(i)}function u(){L.length<=1||(L.pop(),O=L[L.length-1],q=!1,N=L.length>1?[O]:[],K=L[L.length-1],m(),history.pushState({cwd:O},document.title,x+"/files"+O))}function s(){P.data("path",null),g(P,O)}function f(e){v(e),_.hasOwnProperty(e)&&_[e].link.addClass("active"),history.pushState({cwd:O},document.title,x+"/files"+O)}function d(){N.forEach(function(e){_[e].link.removeClass("active")}),N=[],q=!1,f(K)}function p(e){var t=N.indexOf(e);if(t>=0)if(N.splice(t,1),console.log(N),_[e].link.removeClass("active"),0===N.length)q=!1,P.next().children(".file-info").empty(),f(K);else{var n=P.next().children(".file-info");if(n.length>0){var a=n.children(".file-name");a.text(N.length+" files")}}}function h(e){var t=T.dirName(e);if(t!==K){if(N.length>1)return;K=t;for(var n=[],a=0;a<L.length;a++)if(L[a]===K&&a+1<L.length){n.push(L[a+1]);break}v(t),N=n,N.length>0&&_[N[0]].link.addClass("active")}else 1===N.length&&T.dirName(N[0])!==K&&(N=[]);N.push(e),console.log(N,K),_[e].link.addClass("active");var i=P.next().children(".file-info");if(i.length>0){i.empty();var r=w('<span class="file file-multiple">'),o=w('<span class="file-name">');o.text(N.length+" files"),i.append(r).append(o)}else if(P.next().length>0){P.next().empty();var i=w('<div class="file-info">');i.appendTo(P.next());var r=w('<span class="file file-multiple">'),o=w('<span class="file-name">');o.text(N.length+" files"),i.append(r).append(o)}}function v(e){var t=e.split("/"),e="";L=["/"];for(var n=0;n<t.length;n++)".."===t[n]?L.length>1&&(L.pop(),e=L[L.length-1]):""!==t[n]&&"."!==t[n]&&(e+="/"+t[n],L.push(e));O=L[L.length-1],q=!1,N=L.length>1?[e]:[],K=L[L.length-1],m()}function m(){console.log("stack",L,"cwd",O,"stackOffset",D);var e=E.children(),t=e.length;if(D=Math.max(0,L.length-t),E.find("a").removeClass("active"),L.length>=I)for(var n=0;n<t;n++){var a=e.eq(n);D+n<L.length?(g(a,L[D+n]),P=e.eq(n)):g(a,null)}else{P=e.eq(Math.min(t,L.length)-1);for(var n=t-1;n>=0;n--){var a=e.eq(n);D+n<L.length?g(a,L[D+n]):g(a,null)}}I=L.length,w(".header-path").text(O),document.title=O+" – Files"}function g(e,t){if(e.data("path")!==t||null===t){var n=e.children(".files-list");0===n.length&&(e.empty(),n=w('<div class="files-list">'),e.append(n)),n.empty(),e.data("path",null),e.removeClass("readonly"),e.next().data("path")===t?(e.data("path",t),e.next().children(".files-list").children().appendTo(n),e.next().hasClass("readonly")&&e.addClass("readonly")):e.prev().data("path")===t?(e.data("path",t),e.prev().children(".files-list").children().appendTo(n),e.prev().hasClass("readonly")&&e.addClass("readonly")):null!==t&&(e.addClass("loading"),w.ajax({url:x+"/api/list-files",data:{path:t},success:function(a){if(e.removeClass("loading"),n.empty(),e.removeClass("readonly"),e.data("path",t),a.write||e.addClass("readonly"),"directory"===a.type&&"undefined"!=typeof a.files)for(var i=0;i<a.files.length;i++){var r=a.files[i];l(e,r)}else c(e,a)}}))}_.hasOwnProperty(t)&&_[t].link.addClass("active")}function y(){var e=E.children().length,t=Math.max(1,Math.floor(E.width()/200));if(t>e)for(var n=t-e,a=0;a<n;a++){var r=w('<div class="files-panel">');r.append('<div class="files-list">'),r.appendTo(E),i(r)}else{if(!(t<e))return!1;for(var o=e-t,a=0;a<o;a++)E.children().last().remove()}return E.children().css("width",100/t+"%"),!0}var w=n(1),b=n(2),C=n(24),T=n(3);n(15);n(17);var x=w("body").data("path").replace(/\/$/,""),E=w(".files-columns"),k=E.data("token"),S=w(".files-shelf > .files-grid"),P=E.children().first(),O=P.data("path");P.data("path",null);var L=[],I=0,_={},N=[],K="/",D=0,q=!1,X=O;window.onpopstate=function(e){null!==e.state?v(e.state.cwd):X!==O&&v(X)},E.empty(),y(),v(O),w(window).resize(function(){y()&&m()}),w(document).keypress(function(e){e.shiftKey||e.ctrlKey||e.altKey||console.log(e)}),b.define("back",function(){history.back()}),b.define("foreward",function(){history.go(1)}),b.define("up",function(){u()}),b.define("home",function(){f("/")}),b.define("new-folder",function(){var e=prompt("Enter the new name:");if(null!==e){if(""===e)return void alert("Invalid name");var t;t="/"===O?O+e:O+"/"+e,w.ajax({url:x+"/api/make-dir",method:"post",data:{request_token:k,path:t},success:function(e){l(P,e),f(t)}})}}),b.define("new-file",function(){var e=prompt("Enter the new name:");if(null!==e){if(""===e)return void alert("Invalid name");var t;t="/"===O?O+e:O+"/"+e,w.ajax({url:x+"/api/make-file",method:"post",data:{request_token:k,path:t},success:function(e){l(P,e),f(t)},error:function(){C.shake(w(".frame"))}})}}),b.define("upload",function(){var e=w('<input type="file" />').appendTo(w("body")),t=P;e.hide(),e.click(),e.change(function(){var n=e[0].files,a=new FormData;a.append("request_token",k);for(var i=0;i<n.length;i++)a.append("file"+i,n[i]),l(t,{name:n[i].name,path:t.data("path")+"/"+n[i].name,type:"uploading"});var r=new XMLHttpRequest;return r.open("POST",x+"/api/upload?path="+t.data("path")),r.send(a),r.onreadystatechange=function(){if(3===this.readyState||4===this.readyState){var n=t.data("path");t.data("path",null),g(t,n),e.remove()}},!1})}),b.define("rename",function(){if(!(L.length<=1)){if(1!==N.length)return void alert("Cannot rename multiple files");var e=N[0],t=prompt("Enter the new name:",_[e].data.name);if(null!==t){""===t&&alert("Invalid name");var n=T.convert(t,T.dirName(e));w.ajax({url:x+"/api/move",method:"post",data:{request_token:k,path:e,destination:n},success:function(e){f(n),s()},error:function(){C.shake(w(".frame"))}})}}}),b.define("trash",function(){var e,t={request_token:k};1===N.length?(e=confirm("Permanently delete file: "+N[0]),t.path=N[0]):(e=confirm("Permanently delete "+N.length+" files?"),t.paths=N),e&&w.ajax({url:x+"/api/delete",method:"post",data:t,success:function(e){d(),s()}})}),b.define("cut",function(){if(1===N.length)_[N[0]].link.clone().removeClass("active").appendTo(S);else{var e=N,t=w('<a class="file file-multiple">');t.text(N.length+" files"),t.data("paths",e),t.appendTo(S)}d()}),b.define("copy",function(){if(1===N.length)_[N[0]].link.clone().removeClass("active").addClass("duplicate").appendTo(S);else{var e=N,t=w('<a class="file file-multiple duplicate">');t.text(N.length+" files"),t.data("paths",e),t.appendTo(S)}d()}),b.define("paste",function(){if(S.children().length>0){var e=S.children().last(),t=e.hasClass("duplicate"),n={request_token:k},a=[];if("undefined"!=typeof e.data("paths"))n.paths={},e.data("paths").forEach(function(e){n.paths[e]=T.convert(_[e].data.name,O),a.push(_[e])});else{n.path=e.data("path");var i=_[n.path];n.destination=T.convert(i.data.name,O),a.push(i)}w.ajax({url:x+(t?"/api/copy":"/api/move"),method:"post",data:n,success:function(n){e.remove(),t||a.forEach(function(e){e.link.remove()}),s()},error:function(){C.shake(w(".frame"))}})}}),b.bind("F2","rename"),b.bind("C-C","copy"),b.bind("C-X","cut"),b.bind("C-V","paste"),b.bind("Delete","trash")}],[51]);
//# sourceMappingURL=files.js.map
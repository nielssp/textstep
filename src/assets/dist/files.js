webpackJsonp([3],{2:function(t,e,a){function n(t,e){o('[data-action="'+t+'"]').click(function(t){return t.preventDefault(),t.stopPropagation(),e(),!1})}function i(t){"string"==typeof t?o('[data-action="'+t+'"]').attr("disabled",!1):t.forEach(i)}function r(t){"string"==typeof t?o('[data-action="'+t+'"]').attr("disabled",!0):t.forEach(r)}var o=a(1);e.define=n,e.enable=i,e.disable=r},34:function(t,e,a){function n(t){location.href=w+"/open"+t}function i(t){t[0].ondragenter=function(e){return e.stopPropagation(),e.preventDefault(),e.dropEffect="copy",t.addClass("accept"),!1},t[0].ondragleave=function(e){return e.stopPropagation(),e.preventDefault(),t.removeClass("accept"),!1},t[0].ondragover=function(t){return t.stopPropagation(),t.preventDefault(),t.dropEffect="copy",!1},t[0].ondrop=function(e){e.stopPropagation(),e.preventDefault();var a=event.dataTransfer.files,n=new FormData;n.append("request_token",C);for(var i=0;i<a.length;i++)n.append("file"+i,a[i]),l(t,{name:a[i].name,path:t.data("path")+"/"+a[i].name,type:"uploading"});var r=new XMLHttpRequest;return r.open("POST",w+"/api/upload?path="+t.data("path")),r.send(n),r.onreadystatechange=function(){if(3===this.readyState||4===this.readyState){var e=t.data("path");t.data("path",null),h(t,e)}},!1}}function r(t,e){t.hasClass("file-directory")||t.dblclick(function(){return n(g(this).data("path")),!1}),t.click(function(t){return t.shiftKey?(p(e.path),g(this).addClass("active")):(c(e.path),history.pushState({cwd:x},document.title,w+"/files"+x),g(this).parent().parent().find("a").removeClass("active"),g(this).addClass("active")),!1})}function o(t){var e=g('<a class="file">');return e.text(t.name),q.filter(function(e){return e===t.path}).length>0&&e.addClass("active"),t.read||e.addClass("locked"),e.attr("data-path",t.path),e.attr("href",w+"/files"+t.path),e.addClass("file-"+t.type),r(e,t),e}function l(t,e){var a=g("<li>"),n=o(e);return a.append(n),t.children("ul").append(a),n}function d(t,e){var a=g('<li class="file-info">'),i=g('<span class="file">');i.addClass("file-"+e.type),e.read||i.addClass("locked");var r=g('<span class="file-name">');r.text(e.name);var o=g('<span class="file-modified">');o.text(new Date(1e3*e.modified).toString());var l=g('<span class="file-access">');if(l.text(e.modeString+" "+e.owner+":"+e.group+" ("+(e.read?"r":"-")+(e.write?"w":"-")+")"),a.append(i).append(r).append(o).append(l),e.read){var d=g("<button>Open in editor</button>");d.click(function(){n(e.path)}).appendTo(a)}t.children("ul").append(a)}function s(){q.length<=1||(q.pop(),x=q[q.length-1],u(),history.pushState({cwd:x},document.title,w+"/files"+x))}function f(){b.data("path",null),h(b,x)}function p(t){D.push(t)}function c(t){D=[t];var e=t.split("/"),t="";q=["/"];for(var a=0;a<e.length;a++)".."===e[a]?q.length>1&&(q.pop(),t=q[q.length-1]):""!==e[a]&&"."!==e[a]&&(t+="/"+e[a],q.push(t));x=q[q.length-1],u()}function u(){console.log("stack",q,"cwd",x,"stackOffset",S);var t=k.children(),e=t.length;S=Math.max(0,q.length-e);for(var a=0;a<e;a++)if(S+a<q.length){var n=a;h(t.eq(n),q[S+n]),b=t.eq(n)}else h(t.eq(a),null);g(".header-path").text(x),document.title=x+" â€“ Files"}function h(t,e){if(t.data("path")!==e){var a=t.children("ul");a.empty(),t.data("path",null),t.removeClass("readonly"),null!==e&&g.ajax({url:w+"/api/list-files",data:{path:e},success:function(a){if(t.data("path",e),a.write||t.addClass("readonly"),"directory"===a.type&&"undefined"!=typeof a.files)for(var n=0;n<a.files.length;n++){var i=a.files[n];l(t,i)}else d(t,a)}})}}function v(){var t=k.children().length,e=Math.max(1,Math.floor(k.width()/200));if(e>t)for(var a=e-t,n=0;n<a;n++){var r=g('<div class="files-panel">');r.append("<ul>"),r.appendTo(k),i(r)}else{if(!(e<t))return!1;for(var o=t-e,n=0;n<o;n++)k.children().last().remove()}return k.children().css("width",100/e+"%"),!0}function m(){k.height(g(window).height()-150)}var g=a(1),y=a(2),w=g("body").data("path").replace(/\/$/,""),k=g(".files-columns"),C=k.data("token"),b=k.children().first(),x=b.data("path");b.data("path",null);var q=[],D=[],S=0,E=x;window.onpopstate=function(t){null!==t.state?c(t.state.cwd):E!==x&&c(E)},v(),c(x),m(),g(window).resize(function(){v()&&u(),m()}),g(document).keypress(function(t){!t.shiftKey&&!t.ctrlKey&&!t.altKey}),y.define("back",function(){history.back()}),y.define("foreward",function(){history.go(1)}),y.define("up",function(){s()}),y.define("home",function(){c("/"),history.pushState({cwd:x},document.title,w+"/files"+x),k.find("a").removeClass("active")}),y.define("new-folder",function(){var t=prompt("Enter the new name:");if(null!==t){if(""===t)return void alert("Invalid name");var e;e="/"===x?x+t:x+"/"+t,g.ajax({url:w+"/api/make-dir",method:"post",data:{request_token:C,path:e},success:function(t){l(b,t),c(e)}})}}),y.define("new-file",function(){var t=prompt("Enter the new name:");if(null!==t){if(""===t)return void alert("Invalid name");var e;e="/"===x?x+t:x+"/"+t,g.ajax({url:w+"/api/make-file",method:"post",data:{request_token:C,path:e},success:function(t){l(b,t),c(e)}})}}),y.define("trash",function(){confirm("Delete file: "+x)&&g.ajax({url:w+"/api/delete",method:"post",data:{request_token:C,path:x},success:function(t){s(),f()}})})}},[34]);
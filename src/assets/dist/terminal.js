webpackJsonp([3],{2:function(t,n,e){function o(t,n){for(var e=t.toLowerCase().split(/-|\+/),o={ctrlKey:"",altKey:"",shiftKey:""},t=e[e.length-1],a=0;a<e.length-1;a++)switch(e[a]){case"c":o.ctrlKey="c-";break;case"a":o.altKey="a-";break;case"s":o.shiftKey="s-"}t=o.ctrlKey+o.altKey+o.shiftKey+t,u[t]=n}function a(t,n){f[t]=n,l('[data-action="'+t+'"]').click(function(t){return t.preventDefault(),t.stopPropagation(),n(),!1})}function i(t){f[t]()}function r(t){"string"==typeof t?l('[data-action="'+t+'"]').attr("disabled",!1):t.forEach(r)}function c(t){"string"==typeof t?l('[data-action="'+t+'"]').attr("disabled",!0):t.forEach(c)}var l=e(1);n.define=a,n.enable=r,n.disable=c,n.activate=i,n.bind=o;var f={},u={};l(window).keydown(function(t){if(!t.defaultPrevented){var n="";return t.ctrlKey&&(n+="c-"),t.altKey&&(n+="a-"),t.shiftKey&&(n+="s-"),n+=t.key.toLowerCase(),console.log("pressed "+n),u.hasOwnProperty(n)?(i(u[n]),t.preventDefault(),t.stopPropagation(),!1):void 0}})},51:function(t,n,e){function o(t){t=t.trim(),t.startsWith("~")?t=g.home+t.substr(1):t.startsWith("/")||(t=m+"/"+t);for(var n=t.split("/"),e=[],o=0;o<n.length;o++)".."===n[o]?e.length>=1&&e.pop():""!==n[o]&&"."!==n[o]&&e.push(n[o]);return"/"+e.join("/")}function a(){p.val(d),p[0].scrollTop=p[0].scrollHeight}function i(t){d+=t,a()}function r(t){i(t+"\n")}function c(t){p.attr("readonly",!1).focus(),v=t}function l(t,n,e){n.request_token=w,u.ajax({url:k+"/api/"+t,method:"post",data:n,success:e,error:function(t){r(t.status+" "+t.statusText)},complete:f})}function f(){i(g.username+" "+m+"> "),y=-1,c(function(t){var n=t.trim().match(/^([^ ]+)(?: (.*))?/);if(null===n)r("Invalid command"),f();else{var e=n[1];if(K.hasOwnProperty(e))K[e]("undefined"==typeof n[2]?"":n[2]);else try{var o="undefined"==typeof n[2]?{}:JSON.parse(n[2]);l(e,o,function(t){r(JSON.stringify(t,null,"  "))})}catch(a){r(a),f()}}})}var u=e(1),s=e(2),p=u("#terminal"),d="",h=[],y=-1,v=null,g={},m="/",k=u("body").data("path").replace(/\/$/,""),w=p.data("token"),b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];s.define("close",function(){location.href=k+"/files"+m});var K={clear:function(t){d="",a(),f()},cd:function(t){var n=o(t);l("list-files?path="+n,{},function(t){"directory"===t.type?m=n:r("not a directory")})},pwd:function(t){r(m),f()},ls:function(t){l("list-files?path="+m,{},function(t){"undefined"!=typeof t.files&&t.files.forEach(function(t){var n=t.modeString;n+=" \t"+t.owner,n+=" \t"+t.group;var e=new Date(1e3*t.modified);n+=" \t"+e.getFullYear(),n+=" "+b[e.getMonth()],n+=" "+e.getDate(),n+=" \t"+t.name,"directory"===t.type&&(n+="/"),r(n)})})},touch:function(t){l("make-file",{path:o(t)},function(t){})},mkdir:function(t){l("make-dir",{path:o(t)},function(t){})},rm:function(t){l("delete",{path:o(t)},function(t){})},cp:function(t){t=t.split(" "),l("copy",{path:o(t[0]),destination:o(t[1])},function(t){})},mv:function(t){t=t.split(" "),l("move",{path:o(t[0]),destination:o(t[1])},function(t){})},cat:function(t){l("download?path="+o(t),{},function(t){r(t)})},exit:function(t){location.href=k+"/files"+o(t)},open:function(t){location.href=k+"/open"+o(t)},edit:function(t){location.href=k+"/edit"+o(t)},cedit:function(t){location.href=k+"/code-edit"+o(t)}};p.attr("readonly",!0),p.keydown(function(t){if("Enter"!==t.key||t.shiftKey){if("ArrowUp"==t.key)null!==v&&h.length>0&&(y<0?y=h.length-1:y>0&&y--,p.val(d+h[y])),t.preventDefault(),t.stopPropagation();else if("ArrowDown"==t.key)null!==v&&h.length>0&&y>=0&&(y<h.length-1?(y++,p.val(d+h[y])):(y=-1,p.val(d))),t.preventDefault(),t.stopPropagation();else if("ArrowLeft"==t.key||"Backspace"==t.key){var n=p[0].selectionStart,e=p[0].selectionEnd;n===e&&n<=d.length&&(t.preventDefault(),t.stopPropagation())}}else{if(null!==v){p.attr("readonly",!0).blur();var o=p.val().substr(d.length);h.push(o),d+=o+"\n",a();var i=v;v=null,i(o)}t.preventDefault(),t.stopPropagation()}}),p.click(function(){var t=p[0].selectionStart,n=p[0].selectionEnd;t===n&&t<d.length&&(p[0].selectionStart=p.val().length)}),l("who-am-i",{},function(t){g=t})}},[51]);
//# sourceMappingURL=terminal.js.map
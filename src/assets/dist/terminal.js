webpackJsonp([5],{2:function(t,e,n){function o(t,e){for(var n=t.toLowerCase().split(/-|\+/),o={ctrlKey:"",altKey:"",shiftKey:""},t=n[n.length-1],a=0;a<n.length-1;a++)switch(n[a]){case"c":o.ctrlKey="c-";break;case"a":o.altKey="a-";break;case"s":o.shiftKey="s-"}t=o.ctrlKey+o.altKey+o.shiftKey+t,l[t]=e}function a(t,e){f[t]=e,c('[data-action="'+t+'"]').click(function(t){return t.preventDefault(),t.stopPropagation(),e(),!1})}function i(t){f[t]()}function r(t){"string"==typeof t?c('[data-action="'+t+'"]').attr("disabled",!1):t.forEach(r)}function s(t){"string"==typeof t?c('[data-action="'+t+'"]').attr("disabled",!0):t.forEach(s)}var c=n(1);e.define=a,e.enable=r,e.disable=s,e.activate=i,e.bind=o;var f={},l={};c(window).keydown(function(t){if(!t.defaultPrevented){var e="";return t.ctrlKey&&(e+="c-"),t.altKey&&(e+="a-"),t.shiftKey&&(e+="s-"),e+=t.key.toLowerCase(),console.log("pressed "+e),l.hasOwnProperty(e)?(i(l[e]),!1):void 0}})},24:function(t,e,n){var o=n(1);e.shake=function(t,e){e="undefined"==typeof e?10:e;var n=2*e;return o(t).width(o(t).width()).animate({marginLeft:"+="+e},50).animate({marginLeft:"-="+n},50).animate({marginLeft:"+="+n},50).animate({marginLeft:"-="+e},50).queue(function(){o(t).css("width","").css("margin-left","").finish()})},e.onLongPress=function(t,e){var n=!1,o=function(t){n=!0},a=function(t){n=!1};t.addEventListener("touchstart",o),t.addEventListener("touchend",a),t.addEventListener("touchcancel",a),t.addEventListener("touchmove",a),t.addEventListener("contextmenu",function(t){if(n)return e(t)})},e.setProgress=function(t,e,n){var o=t.children[0],a=t.children[1];e=Math.floor(e),e>=100?t.className="progress success":t.className="progress active",o.style.width=e+"%",o.innerText=e+"%","undefined"!=typeof n&&(a.innerText=n)},e.handleError=function(t,n,a,i){"undefined"!=typeof n.responseJSON?alert(n.responseJSON.message):alert(n.responseText),e.shake(o(".frame")),console.log(t,n,a,i)}},54:function(t,e,n){function o(t){t=t.trim(),t.startsWith("~")?t=m.home+t.substr(1):t.startsWith("/")||(t=w+"/"+t);for(var e=t.split("/"),n=[],o=0;o<e.length;o++)".."===e[o]?n.length>=1&&n.pop():""!==e[o]&&"."!==e[o]&&n.push(e[o]);return"/"+n.join("/")}function a(){p.val(h),p[0].scrollTop=p[0].scrollHeight}function i(t){h+=t,a()}function r(t){i(t+"\n")}function s(t){p.attr("readonly",!1).focus(),g=t}function c(t,e,n){e.request_token=b,l.ajax({url:k+"/api/"+t,method:"post",data:e,success:n,error:function(e){d.shake(l(".frame")),r(404===e.status?e.status+" "+t+": command not found":"undefined"!=typeof e.responseJSON?e.status+"("+e.responseJSON.code+") "+e.responseJSON.message:e.status+" "+e.statusText+": "+e.responseText)},complete:f})}function f(){i(m.username+" "+w+"> "),y=-1,s(function(t){var e=t.trim().match(/^([^ ]+)(?: (.*))?/);if(null===e)r("Invalid command"),f();else{var n=e[1];if(L.hasOwnProperty(n))L[n]("undefined"==typeof e[2]?"":e[2]);else try{var o="undefined"==typeof e[2]?{}:JSON.parse(e[2]);c(n,o,function(t){r(JSON.stringify(t,null,"  "))})}catch(a){r(a),f()}}})}var l=n(1),u=n(2),d=n(24),p=l("#terminal"),h="",v=[],y=-1,g=null,m={},w="/",k=l("body").data("path").replace(/\/$/,""),b=p.data("token"),K=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];u.define("close",function(){location.href=k+"/files"+w});var L={clear:function(t){h="",a(),f()},cd:function(t){var e=o(t);c("list-files?path="+e,{},function(t){"directory"===t.type?w=e:r("not a directory")})},pwd:function(t){r(w),f()},ls:function(t){c("list-files?path="+w,{},function(t){"undefined"!=typeof t.files&&t.files.forEach(function(t){var e=t.modeString;e+=" \t"+t.owner,e+=" \t"+t.group;var n=new Date(1e3*t.modified);e+=" \t"+n.getFullYear(),e+=" "+K[n.getMonth()],e+=" "+n.getDate(),e+=" \t"+t.name,"directory"===t.type&&(e+="/"),r(e)})})},touch:function(t){c("make-file",{path:o(t)},function(t){})},mkdir:function(t){c("make-dir",{path:o(t)},function(t){})},rm:function(t){c("delete",{path:o(t)},function(t){})},cp:function(t){t=t.split(" "),c("copy",{path:o(t[0]),destination:o(t[1])},function(t){})},mv:function(t){t=t.split(" "),c("move",{path:o(t[0]),destination:o(t[1])},function(t){})},cat:function(t){c("download?path="+o(t),{},function(t){r(t)})},exit:function(t){location.href=k+"/files"+o(t)},open:function(t){location.href=k+"/open"+o(t)},edit:function(t){location.href=k+"/edit"+o(t)},cedit:function(t){location.href=k+"/code-edit"+o(t)}};p.attr("readonly",!0),p.keydown(function(t){if("Enter"!==t.key||t.shiftKey){if("ArrowUp"==t.key)null!==g&&v.length>0&&(y<0?y=v.length-1:y>0&&y--,p.val(h+v[y])),t.preventDefault(),t.stopPropagation();else if("ArrowDown"==t.key)null!==g&&v.length>0&&y>=0&&(y<v.length-1?(y++,p.val(h+v[y])):(y=-1,p.val(h))),t.preventDefault(),t.stopPropagation();else if("ArrowLeft"==t.key||"Backspace"==t.key){var e=p[0].selectionStart,n=p[0].selectionEnd;e===n&&e<=h.length&&(t.preventDefault(),t.stopPropagation())}}else{if(null!==g){p.attr("readonly",!0).blur();var o=p.val().substr(h.length);v.push(o),h+=o+"\n",a();var i=g;g=null,i(o)}t.preventDefault(),t.stopPropagation()}}),p.click(function(){var t=p[0].selectionStart,e=p[0].selectionEnd;t===e&&t<h.length&&(p[0].selectionStart=p.val().length)}),c("who-am-i",{},function(t){m=t})}},[54]);
//# sourceMappingURL=terminal.js.map
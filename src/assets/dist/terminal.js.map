{"version":3,"sources":["webpack:///dist/terminal.js","webpack:///./common/ui.js?8332****","webpack:///./terminal.js","webpack:////home/www/blogstep/~/js-cookie/src/js.cookie.js?cd36****"],"names":["webpackJsonp","3","module","exports","__webpack_require__","$","Cookies","ajaxSetup","headers","X-Csrf-Token","get","shake","el","amount","dbl","width","animate","marginLeft","queue","css","finish","onLongPress","callback","touching","start","e","end","addEventListener","setProgress","progress","status","bar","children","label","Math","floor","className","style","innerText","handleLogin","done","path","data","replace","find","prop","show","submit","this","ajax","url","method","username","val","password","remember","is","success","overflow","whiteSpace","hide","off","error","xhr","select","global","handleError","event","settings","thrownError","newToken","focus","responseJSON","alert","message","responseText","console","log","30","open","app","args","self","buffer","exec","user","cwd","resume","$terminal","convertPath","trim","startsWith","home","substr","names","split","stack","i","length","pop","push","join","flush","scrollTop","scrollHeight","write","content","writeLine","readLine","attr","readCallback","command","BLOGSTEP","post","fail","code","statusText","always","prompt","cmdHistoryPos","line","m","match","commands","hasOwnProperty","JSON","parse","stringify","cmdHistory","months","clear","cd","nwd","type","setTitle","setArgs","pwd","ls","files","forEach","file","modeString","owner","group","date","Date","modified","getFullYear","getMonth","getDate","name","touch","mkdir","rm","cp","destination","mv","cat","exit","close","edit","run","ps","tasks","getTasks","state","init","addMenu","addItem","onOpen","onResume","frame","click","selectionStart","selectionEnd","keydown","key","shiftKey","blur","4","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","factory","registeredInModuleLoader","undefined","call","OldCookies","window","api","noConflict","extend","result","arguments","attributes","converter","value","document","defaults","expires","setMilliseconds","getMilliseconds","toUTCString","test","encodeURIComponent","String","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","cookies","rdecode","parts","slice","json","charAt","read","set","getJSON","apply","remove","withConverter"],"mappings":"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","file":"dist/terminal.js","sourcesContent":["webpackJsonp([6],{\n\n/***/ 3:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar Cookies = __webpack_require__(4);\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width()).animate({ marginLeft: '+=' + amount }, 50).animate({ marginLeft: '-=' + dbl }, 50).animate({ marginLeft: '+=' + dbl }, 50).animate({ marginLeft: '-=' + amount }, 50).queue(function () {\n        $(el).css('width', '').css('margin-left', '').finish();\n    });\n};\n\nexports.onLongPress = function (el, callback) {\n    var touching = false;\n\n    var start = function start(e) {\n        touching = true;\n    };\n\n    var end = function end(e) {\n        touching = false;\n    };\n\n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function (el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function success() {\n                $('#login-frame').css({ overflow: 'hidden', whiteSpace: 'no-wrap' }).animate({ width: 0 }, function () {\n                    $(this).hide().css({ overflow: '', whiteSpace: '', width: '' });\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function error(xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n        if ($('#login-username').val() === '') {\n            $('#login-username').focus();\n        } else {\n            $('#login-password').focus();\n        }\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n/***/ }),\n\n/***/ 30:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar ui = __webpack_require__(3);\n\nvar self;\nvar $terminal;\n\nvar cwd = '/';\nvar buffer = '';\nvar cmdHistory = [];\nvar cmdHistoryPos = -1;\nvar readCallback = null;\n\nvar user = {};\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n\nvar commands = {\n    clear: function clear(args) {\n        buffer = '';\n        flush();\n        prompt();\n    },\n    cd: function cd(args) {\n        var nwd = convertPath(args);\n        exec('list-files?path=' + nwd, {}, function (data) {\n            if (data.type === 'directory') {\n                cwd = nwd;\n                self.setTitle(cwd + ' – Terminal');\n                self.setArgs({ path: cwd });\n            } else {\n                writeLine('not a directory');\n            }\n        });\n    },\n    pwd: function pwd(args) {\n        writeLine(cwd);\n        prompt();\n    },\n    ls: function ls(args) {\n        exec('list-files?path=' + cwd, {}, function (data) {\n            if (typeof data.files !== 'undefined') {\n                data.files.forEach(function (file) {\n                    var line = file.modeString;\n                    line += ' \\t' + file.owner;\n                    line += ' \\t' + file.group;\n                    var date = new Date(file.modified * 1000);\n                    line += ' \\t' + date.getFullYear();\n                    line += ' ' + months[date.getMonth()];\n                    line += ' ' + date.getDate();\n                    line += ' \\t' + file.name;\n                    if (file.type === 'directory') {\n                        line += '/';\n                    }\n                    writeLine(line);\n                });\n            }\n        });\n    },\n    touch: function touch(args) {\n        exec('make-file', { path: convertPath(args) }, function (data) {});\n    },\n    mkdir: function mkdir(args) {\n        exec('make-dir', { path: convertPath(args) }, function (data) {});\n    },\n    rm: function rm(args) {\n        exec('delete', { path: convertPath(args) }, function (data) {});\n    },\n    cp: function cp(args) {\n        args = args.split(' ');\n        exec('copy', { path: convertPath(args[0]), destination: convertPath(args[1]) }, function (data) {});\n    },\n    mv: function mv(args) {\n        args = args.split(' ');\n        exec('move', { path: convertPath(args[0]), destination: convertPath(args[1]) }, function (data) {});\n    },\n    cat: function cat(args) {\n        exec('download?path=' + convertPath(args), {}, function (data) {\n            writeLine(data);\n        });\n    },\n    exit: function exit(args) {\n        self.close();\n    },\n    open: function open(args) {\n        BLOGSTEP.open(convertPath(args));\n        prompt();\n    },\n    edit: function edit(args) {\n        BLOGSTEP.run('code-editor', { path: convertPath(args) });\n        prompt();\n    },\n    run: function run(args) {\n        args = args.split(' ');\n        BLOGSTEP.run(args[0], args.length > 1 ? { path: convertPath(args[1]) } : {});\n        prompt();\n    },\n    ps: function ps(args) {\n        var tasks = BLOGSTEP.getTasks();\n        for (var i = 0; i < tasks.length; i++) {\n            writeLine(tasks[i].name + ' (' + tasks[i].state + ')');\n        }\n        prompt();\n    }\n};\n\nfunction open(app, args) {\n    self = app;\n    buffer = '';\n    exec('who-am-i', {}, function (data) {\n        user = data;\n        if (typeof args.path === 'string') {\n            cwd = args.path;\n        }\n    });\n}\n\nfunction resume(app) {\n    $terminal.focus();\n}\n\nfunction convertPath(path) {\n    path = path.trim();\n    if (path.startsWith('~')) {\n        path = user.home + path.substr(1);\n    } else if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\nfunction flush() {\n    $terminal.val(buffer);\n    $terminal[0].scrollTop = $terminal[0].scrollHeight;\n}\n\nfunction write(content) {\n    buffer += content;\n    flush();\n}\n\nfunction writeLine(content) {\n    write(content + '\\n');\n}\n\nfunction readLine(callback) {\n    $terminal.attr('readonly', false).focus();\n    readCallback = callback;\n}\n\nfunction exec(command, data, success) {\n    BLOGSTEP.post(command, data).done(success).fail(function (xhr) {\n        if (xhr.status === 404) {\n            writeLine(xhr.status + ' ' + command + ': command not found');\n        } else if (typeof xhr.responseJSON !== 'undefined') {\n            writeLine(xhr.status + '(' + xhr.responseJSON.code + ') ' + xhr.responseJSON.message);\n        } else {\n            writeLine(xhr.status + ' ' + xhr.statusText + ': ' + xhr.responseText);\n        }\n    }).always(prompt);\n}\n\nfunction prompt() {\n    write(user.username + ' ' + cwd + '> ');\n    cmdHistoryPos = -1;\n    readLine(function (line) {\n        var m = line.trim().match(/^([^ ]+)(?: (.*))?/);\n        if (m === null) {\n            writeLine('Invalid command');\n            prompt();\n        } else {\n            var command = m[1];\n            if (commands.hasOwnProperty(command)) {\n                commands[command](typeof m[2] === 'undefined' ? '' : m[2]);\n            } else {\n                try {\n                    var data = typeof m[2] === 'undefined' ? {} : JSON.parse(m[2]);\n                    exec(command, data, function (data) {\n                        writeLine(JSON.stringify(data, null, '  '));\n                    });\n                } catch (e) {\n                    writeLine(e);\n                    prompt();\n                }\n            }\n        }\n    });\n}\n\nBLOGSTEP.init('terminal', function (app) {\n    var menu = app.addMenu('Terminal');\n    menu.addItem('Close', 'close');\n\n    app.onOpen = open;\n\n    app.onResume = resume;\n\n    $terminal = app.frame.find('textarea');\n\n    $terminal.attr('readonly', true);\n\n    $terminal.click(function () {\n        var start = $terminal[0].selectionStart;\n        var end = $terminal[0].selectionEnd;\n        if (start === end) {\n            if (start < buffer.length) {\n                $terminal[0].selectionStart = $terminal.val().length;\n            }\n        }\n    });\n    $terminal.keydown(function (e) {\n        if (e.key === 'Enter' && !e.shiftKey) {\n            if (readCallback !== null) {\n                $terminal.attr('readonly', true).blur();\n                var line = $terminal.val().substr(buffer.length);\n                cmdHistory.push(line);\n                buffer += line + '\\n';\n                flush();\n                var callback = readCallback;\n                readCallback = null;\n                callback(line);\n            }\n            return false;\n        } else if (e.key === 'ArrowUp') {\n            if (readCallback !== null) {\n                if (cmdHistory.length > 0) {\n                    if (cmdHistoryPos < 0) {\n                        cmdHistoryPos = cmdHistory.length - 1;\n                    } else if (cmdHistoryPos > 0) {\n                        cmdHistoryPos--;\n                    }\n                    $terminal.val(buffer + cmdHistory[cmdHistoryPos]);\n                }\n            }\n            return false;\n        } else if (e.key === 'ArrowDown') {\n            if (readCallback !== null) {\n                if (cmdHistory.length > 0 && cmdHistoryPos >= 0) {\n                    if (cmdHistoryPos < cmdHistory.length - 1) {\n                        cmdHistoryPos++;\n                        $terminal.val(buffer + cmdHistory[cmdHistoryPos]);\n                    } else {\n                        cmdHistoryPos = -1;\n                        $terminal.val(buffer);\n                    }\n                }\n            }\n            return false;\n        } else if (e.key === 'ArrowLeft' || e.key === 'Backspace') {\n            var start = $terminal[0].selectionStart;\n            var end = $terminal[0].selectionEnd;\n            if (start === end) {\n                if (start <= buffer.length) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    });\n});\n\n/***/ }),\n\n/***/ 4:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (true) {\n\t\t!(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (true) {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n/***/ })\n\n},[30]);\n\n\n// WEBPACK FOOTER //\n// dist/terminal.js","/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = require('jquery');\nvar Cookies = require('js-cookie');\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width())\n            .animate({marginLeft: '+=' + amount}, 50)\n            .animate({marginLeft: '-=' + dbl}, 50)\n            .animate({marginLeft: '+=' + dbl}, 50)\n            .animate({marginLeft: '-=' + amount}, 50)\n            .queue(function () {\n                $(el).css('width', '')\n                        .css('margin-left', '')\n                        .finish();\n            });\n};\n\nexports.onLongPress = function(el, callback) {\n    var touching = false;\n    \n    var start = function (e) {\n        touching = true;\n    };\n    \n    var end = function (e) {\n        touching = false;\n    };\n    \n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function(el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function () {\n                $('#login-frame').css({overflow: 'hidden', whiteSpace: 'no-wrap'}).animate({width: 0}, function () {\n                    $(this).hide().css({overflow: '', whiteSpace: '', width: ''});\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function (xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n\tif ($('#login-username').val() === '') {\n\t    $('#login-username').focus();\n\t} else {\n\t    $('#login-password').focus();\n\t}\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./common/ui.js","/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = require('jquery');\nvar ui = require('./common/ui');\n\nvar self;\nvar $terminal;\n\nvar cwd = '/';\nvar buffer = '';\nvar cmdHistory = [];\nvar cmdHistoryPos = -1;\nvar readCallback = null;\n\nvar user = {};\n\nvar months = [\n    'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',\n    'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'\n];\n\nvar commands = {\n    clear: function (args) {\n        buffer = '';\n        flush();\n        prompt();\n    },\n    cd: function (args) {\n        var nwd = convertPath(args);\n        exec('list-files?path=' + nwd, {}, function (data) {\n            if (data.type === 'directory') {\n                cwd = nwd;\n\t\tself.setTitle(cwd + ' – Terminal');\n\t\tself.setArgs({ path: cwd });\n            } else {\n                writeLine('not a directory');\n            }\n        });\n    },\n    pwd: function (args) {\n        writeLine(cwd);\n        prompt();\n    },\n    ls: function (args) {\n        exec('list-files?path=' + cwd, {}, function (data) {\n            if (typeof data.files !== 'undefined') {\n                data.files.forEach(function (file) {\n                    var line = file.modeString;\n                    line += ' \\t' + file.owner;\n                    line += ' \\t' + file.group;\n                    var date = new Date(file.modified * 1000);\n                    line += ' \\t' + date.getFullYear();\n                    line += ' ' + months[date.getMonth()];\n                    line += ' ' + date.getDate();\n                    line += ' \\t' + file.name;\n                    if (file.type === 'directory') {\n                        line += '/';\n                    }\n                    writeLine(line);\n                });\n            }\n        });\n    },\n    touch: function (args) {\n        exec('make-file', {path: convertPath(args)}, function (data) {\n        });\n    },\n    mkdir: function (args) {\n        exec('make-dir', {path: convertPath(args)}, function (data) {\n        });\n    },\n    rm: function (args) {\n        exec('delete', {path: convertPath(args)}, function (data) {\n        });\n    },\n    cp: function (args) {\n        args = args.split(' ');\n        exec('copy', {path: convertPath(args[0]), destination: convertPath(args[1])}, function (data) {\n        });\n    },\n    mv: function (args) {\n        args = args.split(' ');\n        exec('move', {path: convertPath(args[0]), destination: convertPath(args[1])}, function (data) {\n        });\n    },\n    cat: function (args) {\n        exec('download?path=' + convertPath(args), {}, function (data) {\n            writeLine(data);\n        });\n    },\n    exit: function (args) {\n\tself.close();\n    },\n    open: function (args) {\n\tBLOGSTEP.open(convertPath(args));\n\tprompt();\n    },\n    edit: function (args) {\n\tBLOGSTEP.run('code-editor', {path: convertPath(args)});\n\tprompt();\n    },\n    run: function (args) {\n        args = args.split(' ');\n\tBLOGSTEP.run(args[0], args.length > 1 ? { path: convertPath(args[1]) } : {});\n\tprompt();\n    },\n    ps: function (args) {\n        var tasks = BLOGSTEP.getTasks();\n        for (var i = 0; i < tasks.length; i++) {\n            writeLine(tasks[i].name + ' (' + tasks[i].state + ')');\n        }\n        prompt();\n    }\n};\n\nfunction open(app, args)\n{\n    self = app;\n    buffer = '';\n    exec('who-am-i', {}, function (data) {\n\tuser = data;\n\tif (typeof args.path === 'string') {\n\t    cwd = args.path;\n\t}\n    });\n}\n\nfunction resume(app)\n{\n    $terminal.focus();\n}\n\nfunction convertPath(path)\n{\n    path = path.trim();\n    if (path.startsWith('~')) {\n        path = user.home + path.substr(1);\n    } else if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\nfunction flush()\n{\n    $terminal.val(buffer);\n    $terminal[0].scrollTop = $terminal[0].scrollHeight;\n}\n\nfunction write(content)\n{\n    buffer += content;\n    flush();\n}\n\nfunction writeLine(content)\n{\n    write(content + '\\n');\n}\n\nfunction readLine(callback)\n{\n    $terminal.attr('readonly', false).focus();\n    readCallback = callback;\n}\n\nfunction exec(command, data, success)\n{\n    BLOGSTEP.post(command, data).done(success).fail(function (xhr) {\n\tif (xhr.status === 404) {\n\t    writeLine(xhr.status + ' ' + command + ': command not found');\n\t} else if (typeof xhr.responseJSON !== 'undefined') {\n\t    writeLine(xhr.status + '(' + xhr.responseJSON.code + ') ' + xhr.responseJSON.message);\n\t} else {\n\t    writeLine(xhr.status + ' ' + xhr.statusText + ': ' + xhr.responseText);\n\t}\n    }).always(prompt);\n}\n\nfunction prompt()\n{\n    write(user.username + ' ' + cwd + '> ');\n    cmdHistoryPos = -1;\n    readLine(function (line) {\n        var m = line.trim().match(/^([^ ]+)(?: (.*))?/);\n        if (m === null) {\n            writeLine('Invalid command');\n            prompt();\n        } else {\n            var command = m[1];\n            if (commands.hasOwnProperty(command)) {\n                commands[command]((typeof m[2] === 'undefined')? '' : m[2]);\n            } else {\n                try {\n                    var data = (typeof m[2] === 'undefined') ? {} : JSON.parse(m[2]);\n                    exec(command, data, function (data) {\n                        writeLine(JSON.stringify(data, null, '  '));\n                    });\n                } catch (e) {\n                    writeLine(e);\n                    prompt();\n                }\n            }\n        }\n    });\n}\n\nBLOGSTEP.init('terminal', function (app) {\n    var menu = app.addMenu('Terminal');\n    menu.addItem('Close', 'close');\n    \n    app.onOpen = open;\n    \n    app.onResume = resume;\n    \n    $terminal = app.frame.find('textarea');\n    \n    $terminal.attr('readonly', true);\n\n    $terminal.click(function () {\n\tvar start = $terminal[0].selectionStart;\n\tvar end = $terminal[0].selectionEnd;\n\tif (start === end) {\n\t    if (start < buffer.length) {\n\t\t$terminal[0].selectionStart = $terminal.val().length;\n\t    }\n\t}\n    });\n    $terminal.keydown(function (e) {\n\tif (e.key === 'Enter' && !e.shiftKey) {\n\t    if (readCallback !== null) {\n\t\t$terminal.attr('readonly', true).blur();\n\t\tvar line = $terminal.val().substr(buffer.length);\n\t\tcmdHistory.push(line);\n\t\tbuffer += line + '\\n';\n\t\tflush();\n\t\tvar callback = readCallback;\n\t\treadCallback = null;\n\t\tcallback(line);\n\t    }\n\t    return false;\n\t} else if (e.key === 'ArrowUp') {\n\t    if (readCallback !== null) {\n\t\tif (cmdHistory.length > 0) {\n\t\t    if (cmdHistoryPos < 0) {\n\t\t\tcmdHistoryPos = cmdHistory.length - 1;\n\t\t    } else if (cmdHistoryPos > 0) {\n\t\t\tcmdHistoryPos--;\n\t\t    }\n\t\t    $terminal.val(buffer + cmdHistory[cmdHistoryPos]);\n\t\t}\n\t    }\n\t    return false;\n\t} else if (e.key === 'ArrowDown') {\n\t    if (readCallback !== null) {\n\t\tif (cmdHistory.length > 0 && cmdHistoryPos >= 0) {\n\t\t    if (cmdHistoryPos < cmdHistory.length - 1) {\n\t\t\tcmdHistoryPos++;\n\t\t\t$terminal.val(buffer + cmdHistory[cmdHistoryPos]);\n\t\t    } else {\n\t\t\tcmdHistoryPos = -1;\n\t\t\t$terminal.val(buffer);\n\t\t    }\n\t\t}\n\t    }\n\t    return false;\n\t} else if (e.key === 'ArrowLeft' || e.key === 'Backspace') {\n\t    var start = $terminal[0].selectionStart;\n\t    var end = $terminal[0].selectionEnd;\n\t    if (start === end) {\n\t\tif (start <= buffer.length) {\n\t\t    return false;\n\t\t}\n\t    }\n\t}\n\treturn true;\n    });\n\n});\n\n\n// WEBPACK FOOTER //\n// ./terminal.js","/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/www/blogstep/~/js-cookie/src/js.cookie.js\n// module id = 4\n// module chunks = 0 1 2 4 5 6"],"sourceRoot":""}
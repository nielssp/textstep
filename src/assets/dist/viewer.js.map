{"version":3,"sources":["webpack:///dist/viewer.js","webpack:///./common/paths.js?9de7**","webpack:////home/www/blogstep/~/viewerjs/dist/viewer.js","webpack:///./viewer.js"],"names":["webpackJsonp","19","module","exports","2","__webpack_require__","dirName","path","replace","fileName","convert","cwd","trim","startsWith","names","split","stack","i","length","pop","push","join","22","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","global","factory","document","window","Error","this","noGlobal","typeOf","obj","toString","call","slice","toLowerCase","isString","str","isNumber","num","isNaN","isUndefined","isObject","isPlainObject","constructor","prototype","hasOwnProperty","e","isFunction","fn","isArray","arr","Array","toArray","offset","from","inArray","value","index","indexOf","each","n","REGEXP_TRIM","callback","extend","args","arguments","Object","assign","apply","shift","arg","prop","proxy","context","concat","setStyle","element","styles","style","property","REGEXP_SUFFIX","test","getStyle","getComputedStyle","currentStyle","hasClass","classList","contains","className","addClass","elem","add","removeClass","remove","toggleClass","added","hyphenate","REGEXP_HYPHENATE","getData","name","dataset","getAttribute","setData","data","setAttribute","removeData","removeAttribute","addListener","type","handler","once","types","REGEXP_SPACES","originalHandler","removeListener","addEventListener","attachEvent","removeEventListener","detachEvent","dispatchEvent","event","Event","CustomEvent","bubbles","cancelable","detail","createEvent","initEvent","initCustomEvent","fireEvent","preventDefault","returnValue","getEvent","eventDoc","doc","body","target","srcElement","pageX","clientX","ownerDocument","documentElement","scrollLeft","clientLeft","pageY","clientY","scrollTop","clientTop","getOffset","box","getBoundingClientRect","left","scrollX","top","scrollY","getByTag","tagName","getElementsByTagName","getByClass","getElementsByClassName","querySelectorAll","appendChild","el","removeChild","parentNode","empty","firstChild","setText","text","textContent","innerText","forceReflow","offsetWidth","getImageName","url","getImageSize","image","newImage","naturalWidth","naturalHeight","createElement","onload","width","height","src","getTransform","transforms","rotate","scaleX","scaleY","getResponsiveClass","option","CLASS_HIDE_XS_DOWN","CLASS_HIDE_SM_DOWN","CLASS_HIDE_MD_DOWN","getPointer","pointer","endOnly","end","endX","endY","startX","startY","getMaxZoomRatio","pointers","pointers2","ratios","pointerId","pointer2","x1","Math","abs","y1","x2","y2","z1","sqrt","z2","ratio","sort","a","b","getPointersCenter","count","Viewer","options","_this","DEFAULTS","isImg","isBuilt","isShown","isViewed","isFulled","isPlayed","wheeling","playing","fading","tooltiping","transitioning","action","timeout","init","PointerEvent","CLASS_IN","NAMESPACE","CLASS_TRANSITION","EVENT_MOUSEDOWN","EVENT_MOUSEMOVE","EVENT_MOUSEUP","SUPPORT_TRANSITION","transition","min","max","round","objectProto","images","ready","scrollbarWidth","innerWidth","clientWidth","inline","view","complete","_start","start","build","template","parent","viewer","button","toolbar","navbar","title","innerHTML","TEMPLATE","canvas","footer","tooltipBox","player","list","querySelector","zoomable","scalable","rotatable","zIndex","zIndexInline","position","insertBefore","nextSibling","render","bind","unbuild","viewed","_click","click","_wheel","wheel","_mousedown","mousedown","_mousemove","mousemove","_mouseup","mouseup","_keydown","keydown","_resize","resize","unbind","initContainer","initViewer","initList","renderViewer","containerData","innerHeight","viewerData","parentData","minWidth","offsetHeight","minHeight","items","alt","loadImage","renderList","outerWidth","marginLeft","resetList","initImage","footerHeight","viewerWidth","viewerHeight","oldImageData","imageData","initialImageData","aspectRatio","renderImage","transform","marginTop","WebkitTransform","msTransform","resetImage","show","stop","exit","full","hide","zoom","toggle","reset","prev","play","next","load","clearTimeout","cssText","movable","originalImage","parentWidth","parentHeight","filled","Number","zoomRatio","delta","setTimeout","deltaY","wheelDelta","key","keyCode","which","charCode","keyboard","ctrlKey","shiftKey","changedTouches","touch","identifier","keys","pointerType","isSwitchable","change","open","shown","hidden","zoomTo","item","img","move","offsetX","offsetY","moveTo","x","y","changed","hasTooltip","_originalEvent","_zoomable","newWidth","newHeight","center","minZoomRatio","maxZoomRatio","tooltip","degree","rotateTo","scale","total","fullscreen","requestFullscreen","interval","exitFullscreen","close","update","indexes","destroy","paddingRight","isVisible","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","p","_Viewer","noConflict","setDefaults","undefined","32","$","paths","BLOGSTEP","app","$viewer","frame","find","first","addMenu","addItem","onOpen","setTitle","get","done","files","match","$img","attr","PATH","append","children","stopPropagation","$image","onClose"],"mappings":"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","file":"dist/viewer.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ 19:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 2:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path) {\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path) {\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd) {\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n/***/ }),\n\n/***/ 22:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n * Viewer.js v0.5.1\n * https://github.com/fengyuanchen/viewerjs\n *\n * Copyright (c) 2015-2017 Fengyuan Chen\n * Released under the MIT license\n *\n * Date: 2017-01-02T13:01:55.700Z\n */\n\n(function (global, factory) {\n  if (typeof module === 'object' && typeof module.exports === 'object') {\n    module.exports = global.document ? factory(global, true) : function (window) {\n      if (!window.document) {\n        throw new Error('Viewer requires a window with a document');\n      }\n\n      return factory(window);\n    };\n  } else {\n    factory(global);\n  }\n})(typeof window !== 'undefined' ? window : this, function (window, noGlobal) {\n\n  'use strict';\n\n  var document = window.document;\n  var Event = window.Event;\n  var PointerEvent = window.PointerEvent;\n\n  // Constants\n  var NAMESPACE = 'viewer';\n\n  // Classes\n  var CLASS_FIXED = NAMESPACE + '-fixed';\n  var CLASS_OPEN = NAMESPACE + '-open';\n  var CLASS_SHOW = NAMESPACE + '-show';\n  var CLASS_HIDE = NAMESPACE + '-hide';\n  var CLASS_HIDE_XS_DOWN = 'viewer-hide-xs-down';\n  var CLASS_HIDE_SM_DOWN = 'viewer-hide-sm-down';\n  var CLASS_HIDE_MD_DOWN = 'viewer-hide-md-down';\n  var CLASS_FADE = NAMESPACE + '-fade';\n  var CLASS_IN = NAMESPACE + '-in';\n  var CLASS_MOVE = NAMESPACE + '-move';\n  var CLASS_ACTIVE = NAMESPACE + '-active';\n  var CLASS_INVISIBLE = NAMESPACE + '-invisible';\n  var CLASS_TRANSITION = NAMESPACE + '-transition';\n  var CLASS_FULLSCREEN = NAMESPACE + '-fullscreen';\n  var CLASS_FULLSCREEN_EXIT = NAMESPACE + '-fullscreen-exit';\n  var CLASS_CLOSE = NAMESPACE + '-close';\n\n  // Events\n  var EVENT_MOUSEDOWN = PointerEvent ? 'pointerdown' : 'touchstart mousedown';\n  var EVENT_MOUSEMOVE = PointerEvent ? 'pointermove' : 'mousemove touchmove';\n  var EVENT_MOUSEUP = PointerEvent ? 'pointerup pointercancel' : 'touchend touchcancel mouseup';\n  var EVENT_WHEEL = 'wheel mousewheel DOMMouseScroll';\n  var EVENT_TRANSITIONEND = 'transitionend';\n  var EVENT_LOAD = 'load';\n  var EVENT_KEYDOWN = 'keydown';\n  var EVENT_CLICK = 'click';\n  var EVENT_RESIZE = 'resize';\n  var EVENT_READY = 'ready';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_HIDE = 'hide';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n\n  // RegExps\n  var REGEXP_SUFFIX = /^(width|height|left|top|marginLeft|marginTop)$/;\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  var REGEXP_TRIM = /^\\s+(.*)\\s+$/;\n  var REGEXP_SPACES = /\\s+/;\n\n  // Supports\n  var SUPPORT_TRANSITION = typeof document.createElement(NAMESPACE).style.transition !== 'undefined';\n\n  // Maths\n  var min = Math.min;\n  var max = Math.max;\n  var abs = Math.abs;\n  var sqrt = Math.sqrt;\n  var round = Math.round;\n\n  // Utilities\n  var objectProto = Object.prototype;\n  var toString = objectProto.toString;\n  var hasOwnProperty = objectProto.hasOwnProperty;\n  var slice = Array.prototype.slice;\n\n  function typeOf(obj) {\n    return toString.call(obj).slice(8, -1).toLowerCase();\n  }\n\n  function isString(str) {\n    return typeof str === 'string';\n  }\n\n  function isNumber(num) {\n    return typeof num === 'number' && !isNaN(num);\n  }\n\n  function isUndefined(obj) {\n    return typeof obj === 'undefined';\n  }\n\n  function isObject(obj) {\n    return typeof obj === 'object' && obj !== null;\n  }\n\n  function isPlainObject(obj) {\n    var constructor;\n    var prototype;\n\n    if (!isObject(obj)) {\n      return false;\n    }\n\n    try {\n      constructor = obj.constructor;\n      prototype = constructor.prototype;\n\n      return constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function isFunction(fn) {\n    return typeOf(fn) === 'function';\n  }\n\n  function isArray(arr) {\n    return Array.isArray ? Array.isArray(arr) : typeOf(arr) === 'array';\n  }\n\n  function toArray(obj, offset) {\n    offset = offset >= 0 ? offset : 0;\n\n    if (Array.from) {\n      return Array.from(obj).slice(offset);\n    }\n\n    return slice.call(obj, offset);\n  }\n\n  function inArray(value, arr) {\n    var index = -1;\n\n    if (arr.indexOf) {\n      return arr.indexOf(value);\n    } else {\n      each(arr, function (n, i) {\n        if (n === value) {\n          index = i;\n          return false;\n        }\n      });\n    }\n\n    return index;\n  }\n\n  function trim(str) {\n    if (isString(str)) {\n      str = str.trim ? str.trim() : str.replace(REGEXP_TRIM, '1');\n    }\n\n    return str;\n  }\n\n  function each(obj, callback) {\n    var length;\n    var i;\n\n    if (obj && isFunction(callback)) {\n      if (isArray(obj) || isNumber(obj.length)/* array-like */) {\n        for (i = 0, length = obj.length; i < length; i++) {\n          if (callback.call(obj, obj[i], i, obj) === false) {\n            break;\n          }\n        }\n      } else if (isObject(obj)) {\n        for (i in obj) {\n          if (obj.hasOwnProperty(i)) {\n            if (callback.call(obj, obj[i], i, obj) === false) {\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    return obj;\n  }\n\n  function extend(obj) {\n    var args;\n\n    if (arguments.length > 1) {\n      args = toArray(arguments);\n\n      if (Object.assign) {\n        return Object.assign.apply(Object, args);\n      }\n\n      args.shift();\n\n      each(args, function (arg) {\n        each(arg, function (prop, i) {\n          obj[i] = prop;\n        });\n      });\n    }\n\n    return obj;\n  }\n\n  function proxy(fn, context) {\n    var args = toArray(arguments, 2);\n\n    return function () {\n      return fn.apply(context, args.concat(toArray(arguments)));\n    };\n  }\n\n  function setStyle(element, styles) {\n    var style = element.style;\n\n    each(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n\n  function getStyle(element) {\n    return window.getComputedStyle ?\n      window.getComputedStyle(element, null) :\n      element.currentStyle;\n  }\n\n  function hasClass(element, value) {\n    return element.classList ?\n      element.classList.contains(value) :\n      element.className.indexOf(value) > -1;\n  }\n\n  function addClass(element, value) {\n    var className;\n\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      return each(element, function (elem) {\n        addClass(elem, value);\n      });\n    }\n\n    if (element.classList) {\n      return element.classList.add(value);\n    }\n\n    className = trim(element.className);\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = className + ' ' + value;\n    }\n  }\n\n  function removeClass(element, value) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      return each(element, function (elem) {\n        removeClass(elem, value);\n      });\n    }\n\n    if (element.classList) {\n      return element.classList.remove(value);\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n\n  function toggleClass(element, value, added) {\n    if (isNumber(element.length)) {\n      return each(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n    }\n\n    // IE10-11 doesn't support the second parameter of `classList.toggle`\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n\n  function hyphenate(str) {\n    return str.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    } else if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute('data-' + hyphenate(name));\n  }\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute('data-' + hyphenate(name), data);\n    }\n  }\n\n  function removeData(element, name) {\n    if (isObject(element[name])) {\n      delete element[name];\n    } else if (element.dataset) {\n      // Safari not allows to delete dataset property\n      try {\n        delete element.dataset[name];\n      } catch (e) {\n        element.dataset[name] = null;\n      }\n    } else {\n      element.removeAttribute('data-' + hyphenate(name));\n    }\n  }\n\n  function addListener(element, type, handler, once) {\n    var types = trim(type).split(REGEXP_SPACES);\n    var originalHandler = handler;\n\n    if (types.length > 1) {\n      return each(types, function (type) {\n        addListener(element, type, handler);\n      });\n    }\n\n    if (once) {\n      handler = function () {\n        removeListener(element, type, handler);\n\n        return originalHandler.apply(element, arguments);\n      };\n    }\n\n    if (element.addEventListener) {\n      element.addEventListener(type, handler, false);\n    } else if (element.attachEvent) {\n      element.attachEvent('on' + type, handler);\n    }\n  }\n\n  function removeListener(element, type, handler) {\n    var types = trim(type).split(REGEXP_SPACES);\n\n    if (types.length > 1) {\n      return each(types, function (type) {\n        removeListener(element, type, handler);\n      });\n    }\n\n    if (element.removeEventListener) {\n      element.removeEventListener(type, handler, false);\n    } else if (element.detachEvent) {\n      element.detachEvent('on' + type, handler);\n    }\n  }\n\n  function dispatchEvent(element, type, data) {\n    var event;\n\n    if (element.dispatchEvent) {\n\n      // Event and CustomEvent on IE9-11 are global objects, not constructors\n      if (isFunction(Event) && isFunction(CustomEvent)) {\n        if (isUndefined(data)) {\n          event = new Event(type, {\n            bubbles: true,\n            cancelable: true\n          });\n        } else {\n          event = new CustomEvent(type, {\n            detail: data,\n            bubbles: true,\n            cancelable: true\n          });\n        }\n      } else {\n        // IE9-11\n        if (isUndefined(data)) {\n          event = document.createEvent('Event');\n          event.initEvent(type, true, true);\n        } else {\n          event = document.createEvent('CustomEvent');\n          event.initCustomEvent(type, true, true, data);\n        }\n      }\n\n      // IE9+\n      return element.dispatchEvent(event);\n    } else if (element.fireEvent) {\n\n      // IE6-10 (native events only)\n      return element.fireEvent('on' + type);\n    }\n  }\n\n  function preventDefault(e) {\n    if (e.preventDefault) {\n      e.preventDefault();\n    } else {\n      e.returnValue = false;\n    }\n  }\n\n  function getEvent(event) {\n    var e = event || window.event;\n    var eventDoc;\n    var doc;\n    var body;\n\n    // Fix target property (IE8)\n    if (!e.target) {\n      e.target = e.srcElement || document;\n    }\n\n    if (!isNumber(e.pageX) && isNumber(e.clientX)) {\n      eventDoc = event.target.ownerDocument || document;\n      doc = eventDoc.documentElement;\n      body = eventDoc.body;\n\n      e.pageX = e.clientX + (\n        ((doc && doc.scrollLeft) || (body && body.scrollLeft) || 0) -\n        ((doc && doc.clientLeft) || (body && body.clientLeft) || 0)\n      );\n      e.pageY = e.clientY + (\n        ((doc && doc.scrollTop) || (body && body.scrollTop) || 0) -\n        ((doc && doc.clientTop) || (body && body.clientTop) || 0)\n      );\n    }\n\n    return e;\n  }\n\n  function getOffset(element) {\n    var doc = document.documentElement;\n    var box = element.getBoundingClientRect();\n\n    return {\n      left: box.left + (window.scrollX || doc && doc.scrollLeft || 0) - (doc && doc.clientLeft || 0),\n      top: box.top + (window.scrollY || doc && doc.scrollTop || 0) - (doc && doc.clientTop || 0)\n    };\n  }\n\n  function getByTag(element, tagName) {\n    return element.getElementsByTagName(tagName);\n  }\n\n  function getByClass(element, className) {\n    return element.getElementsByClassName ?\n      element.getElementsByClassName(className) :\n      element.querySelectorAll('.' + className);\n  }\n\n  function appendChild(element, elem) {\n    if (elem.length) {\n      return each(elem, function (el) {\n        appendChild(element, el);\n      });\n    }\n\n    element.appendChild(elem);\n  }\n\n  function removeChild(element) {\n    if (element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  }\n\n  function empty(element) {\n    while (element.firstChild) {\n      element.removeChild(element.firstChild);\n    }\n  }\n\n  function setText(element, text) {\n    if (!isUndefined(element.textContent)) {\n      element.textContent = text;\n    } else {\n      element.innerText = text;\n    }\n  }\n\n  // Force reflow to enable CSS3 transition\n  function forceReflow(element) {\n    return element.offsetWidth;\n  }\n\n  // e.g.: http://domain.com/path/to/picture.jpg?size=1280×960 -> picture.jpg\n  function getImageName(url) {\n    return isString(url) ? url.replace(/^.*\\//, '').replace(/[\\?&#].*$/, '') : '';\n  }\n\n  function getImageSize(image, callback) {\n    var newImage;\n\n    // Modern browsers\n    if (image.naturalWidth) {\n      return callback(image.naturalWidth, image.naturalHeight);\n    }\n\n    // IE8: Don't use `new Image()` here\n    newImage = document.createElement('img');\n\n    newImage.onload = function () {\n      callback(this.width, this.height);\n    };\n\n    newImage.src = image.src;\n  }\n\n  function getTransform(data) {\n    var transforms = [];\n    var rotate = data.rotate;\n    var scaleX = data.scaleX;\n    var scaleY = data.scaleY;\n\n    // Rotate should come first before scale\n    if (isNumber(rotate)) {\n      transforms.push('rotate(' + rotate + 'deg)');\n    }\n\n    if (isNumber(scaleX)) {\n      transforms.push('scaleX(' + scaleX + ')');\n    }\n\n    if (isNumber(scaleY)) {\n      transforms.push('scaleY(' + scaleY + ')');\n    }\n\n    return transforms.length ? transforms.join(' ') : 'none';\n  }\n\n  function getResponsiveClass(option) {\n    switch (option) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n    }\n  }\n\n  function getPointer(pointer, endOnly) {\n    var end = {\n      endX: pointer.pageX,\n      endY: pointer.pageY\n    };\n\n    if (endOnly) {\n      return end;\n    }\n\n    return extend({\n      startX: pointer.pageX,\n      startY: pointer.pageY\n    }, end);\n  }\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = extend({}, pointers);\n    var ratios = [];\n\n    each(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n\n      each(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt((x1 * x1) + (y1 * y1));\n        var z2 = Math.sqrt((x2 * x2) + (y2 * y2));\n        var ratio = (z2 - z1) / z1;\n\n        ratios.push(ratio);\n      });\n    });\n\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n\n    return ratios[0];\n  }\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n\n    each(pointers, function (pointer) {\n      pageX += pointer.startX;\n      pageY += pointer.startY;\n      count += 1;\n    });\n\n    pageX /= count;\n    pageY /= count;\n\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  function Viewer(element, options) {\n    var _this = this;\n\n    _this.element = element;\n    _this.options = extend({}, Viewer.DEFAULTS, isPlainObject(options) && options);\n    _this.isImg = false;\n    _this.isBuilt = false;\n    _this.isShown = false;\n    _this.isViewed = false;\n    _this.isFulled = false;\n    _this.isPlayed = false;\n    _this.wheeling = false;\n    _this.playing = false;\n    _this.fading = false;\n    _this.tooltiping = false;\n    _this.transitioning = false;\n    _this.action = false;\n    _this.target = false;\n    _this.timeout = false;\n    _this.index = 0;\n    _this.length = 0;\n    _this.pointers = {};\n    _this.init();\n  }\n\n  Viewer.prototype = {\n    constructor: Viewer,\n\n    init: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var isImg = element.tagName.toLowerCase() === 'img';\n      var images = isImg ? [element] : getByTag(element, 'img');\n      var length = images.length;\n      var ready = proxy(_this.ready, _this);\n\n      if (getData(element, NAMESPACE)) {\n        return;\n      }\n\n      setData(element, NAMESPACE, _this);\n\n      if (!length) {\n        return;\n      }\n\n      if (isFunction(options.ready)) {\n        addListener(element, EVENT_READY, options.ready, true);\n      }\n\n      // Override `transition` option if it is not supported\n      if (!SUPPORT_TRANSITION) {\n        options.transition = false;\n      }\n\n      _this.isImg = isImg;\n      _this.length = length;\n      _this.count = 0;\n      _this.images = images;\n      _this.body = document.body;\n      _this.scrollbarWidth = window.innerWidth - document.body.clientWidth;\n\n      if (options.inline) {\n        addListener(element, EVENT_READY, function () {\n          _this.view();\n        }, true);\n\n        each(images, function (image) {\n          if (image.complete) {\n            ready();\n          } else {\n            addListener(image, EVENT_LOAD, ready, true);\n          }\n        });\n      } else {\n        addListener(element, EVENT_CLICK, (_this._start = proxy(_this.start, _this)));\n      }\n    },\n\n    ready: function () {\n      var _this = this;\n\n      _this.count++;\n\n      if (_this.count === _this.length) {\n        _this.build();\n      }\n    },\n\n    build: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var template;\n      var parent;\n      var viewer;\n      var button;\n      var toolbar;\n      var navbar;\n      var title;\n      var rotate;\n\n      if (_this.isBuilt) {\n        return;\n      }\n\n      template = document.createElement('div');\n      template.innerHTML = Viewer.TEMPLATE;\n\n      _this.parent = parent = element.parentNode;\n      _this.viewer = viewer = getByClass(template, 'viewer-container')[0];\n      _this.canvas = getByClass(viewer, 'viewer-canvas')[0];\n      _this.footer = getByClass(viewer, 'viewer-footer')[0];\n      _this.title = title = getByClass(viewer, 'viewer-title')[0];\n      _this.toolbar = toolbar = getByClass(viewer, 'viewer-toolbar')[0];\n      _this.navbar = navbar = getByClass(viewer, 'viewer-navbar')[0];\n      _this.button = button = getByClass(viewer, 'viewer-button')[0];\n      _this.tooltipBox = getByClass(viewer, 'viewer-tooltip')[0];\n      _this.player = getByClass(viewer, 'viewer-player')[0];\n      _this.list = getByClass(viewer, 'viewer-list')[0];\n\n      addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(options.title));\n      addClass(toolbar, !options.toolbar ? CLASS_HIDE : getResponsiveClass(options.toolbar));\n      addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n      toggleClass(button, CLASS_HIDE, !options.button);\n\n      toggleClass(toolbar.querySelector('.viewer-one-to-one'), CLASS_INVISIBLE, !options.zoomable);\n      toggleClass(toolbar.querySelectorAll('li[class*=\"zoom\"]'), CLASS_INVISIBLE, !options.zoomable);\n      toggleClass(toolbar.querySelectorAll('li[class*=\"flip\"]'), CLASS_INVISIBLE, !options.scalable);\n\n      if (!options.rotatable) {\n        rotate = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n        addClass(rotate, CLASS_INVISIBLE);\n        appendChild(toolbar, rotate);\n      }\n\n      if (options.inline) {\n        addClass(button, CLASS_FULLSCREEN);\n        setStyle(viewer, {\n          zIndex: options.zIndexInline\n        });\n\n        if (getStyle(parent).position === 'static') {\n          setStyle(parent, {\n            position: 'relative'\n          });\n        }\n      } else {\n        addClass(button, CLASS_CLOSE);\n        addClass(viewer, CLASS_FIXED);\n        addClass(viewer, CLASS_FADE);\n        addClass(viewer, CLASS_HIDE);\n\n        setStyle(viewer, {\n          zIndex: options.zIndex\n        });\n      }\n\n      // Inserts the viewer after to the current element\n      parent.insertBefore(viewer, element.nextSibling);\n\n      if (options.inline) {\n        _this.render();\n        _this.bind();\n        _this.isShown = true;\n      }\n\n      _this.isBuilt = true;\n\n      dispatchEvent(element, EVENT_READY);\n    },\n\n    unbuild: function () {\n      var _this = this;\n\n      if (!_this.isBuilt) {\n        return;\n      }\n\n      _this.isBuilt = false;\n      removeChild(_this.viewer);\n    },\n\n    bind: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer = _this.viewer;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view);\n      }\n\n      if (isFunction(options.viewed)) {\n        addListener(element, EVENT_VIEWED, options.viewed);\n      }\n\n      addListener(viewer, EVENT_CLICK, (_this._click = proxy(_this.click, _this)));\n      addListener(viewer, EVENT_WHEEL, (_this._wheel = proxy(_this.wheel, _this)));\n      addListener(_this.canvas, EVENT_MOUSEDOWN, (_this._mousedown = proxy(_this.mousedown, _this)));\n      addListener(document, EVENT_MOUSEMOVE, (_this._mousemove = proxy(_this.mousemove, _this)));\n      addListener(document, EVENT_MOUSEUP, (_this._mouseup = proxy(_this.mouseup, _this)));\n      addListener(document, EVENT_KEYDOWN, (_this._keydown = proxy(_this.keydown, _this)));\n      addListener(window, EVENT_RESIZE, (_this._resize = proxy(_this.resize, _this)));\n    },\n\n    unbind: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer = _this.viewer;\n\n      if (isFunction(options.view)) {\n        removeListener(element, EVENT_VIEW, options.view);\n      }\n\n      if (isFunction(options.viewed)) {\n        removeListener(element, EVENT_VIEWED, options.viewed);\n      }\n\n      removeListener(viewer, EVENT_CLICK, _this._click);\n      removeListener(viewer, EVENT_WHEEL, _this._wheel);\n      removeListener(_this.canvas, EVENT_MOUSEDOWN, _this._mousedown);\n      removeListener(document, EVENT_MOUSEMOVE, _this._mousemove);\n      removeListener(document, EVENT_MOUSEUP, _this._mouseup);\n      removeListener(document, EVENT_KEYDOWN, _this._keydown);\n      removeListener(window, EVENT_RESIZE, _this._resize);\n    },\n\n    render: function () {\n      var _this = this;\n\n      _this.initContainer();\n      _this.initViewer();\n      _this.initList();\n      _this.renderViewer();\n    },\n\n    initContainer: function () {\n      var _this = this;\n\n      _this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n\n    initViewer: function () {\n      var _this = this;\n      var options = _this.options;\n      var parent = _this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        _this.parentData = viewerData = {\n          width: max(parent.offsetWidth, options.minWidth),\n          height: max(parent.offsetHeight, options.minHeight)\n        };\n      }\n\n      if (_this.isFulled || !viewerData) {\n        viewerData = _this.containerData;\n      }\n\n      _this.viewerData = extend({}, viewerData);\n    },\n\n    renderViewer: function () {\n      var _this = this;\n\n      if (_this.options.inline && !_this.isFulled) {\n        setStyle(_this.viewer, _this.viewerData);\n      }\n    },\n\n    initList: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var list = _this.list;\n      var items = [];\n\n      each(_this.images, function (image, i) {\n        var src = image.src;\n        var alt = image.alt || getImageName(src);\n        var url = options.url;\n\n        if (!src) {\n          return;\n        }\n\n        if (isString(url)) {\n          url = image.getAttribute(url);\n        } else if (isFunction(url)) {\n          url = url.call(image, image);\n        }\n\n        items.push(\n          '<li>' +\n            '<img' +\n              ' src=\"' + src + '\"' +\n              ' data-action=\"view\"' +\n              ' data-index=\"' +  i + '\"' +\n              ' data-original-url=\"' +  (url || src) + '\"' +\n              ' alt=\"' +  alt + '\"' +\n            '>' +\n          '</li>'\n        );\n      });\n\n      list.innerHTML = items.join('');\n\n      each(getByTag(list, 'img'), function (image) {\n        setData(image, 'filled', true);\n        addListener(image, EVENT_LOAD, proxy(_this.loadImage, _this), true);\n      });\n\n      _this.items = getByTag(list, 'li');\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, true);\n      }\n    },\n\n    renderList: function (index) {\n      var _this = this;\n      var i = index || _this.index;\n      var width = _this.items[i].offsetWidth || 30;\n      var outerWidth = width + 1; // 1 pixel of `margin-left` width\n\n      // Place the active item in the center of the screen\n      setStyle(_this.list, {\n        width: outerWidth * _this.length,\n        marginLeft: (_this.viewerData.width - width) / 2 - outerWidth * i\n      });\n    },\n\n    resetList: function () {\n      var _this = this;\n\n      empty(_this.list);\n      removeClass(_this.list, CLASS_TRANSITION);\n      setStyle({\n        marginLeft: 0\n      });\n    },\n\n    initImage: function (callback) {\n      var _this = this;\n      var options = _this.options;\n      var image = _this.image;\n      var viewerData = _this.viewerData;\n      var footerHeight = _this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = _this.imageData || {};\n\n      getImageSize(image, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = viewerWidth;\n        var height = viewerHeight;\n        var initialImageData;\n        var imageData;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        width = min(width * 0.9, naturalWidth);\n        height = min(height * 0.9, naturalHeight);\n\n        imageData = {\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight,\n          aspectRatio: aspectRatio,\n          ratio: width / naturalWidth,\n          width: width,\n          height: height,\n          left: (viewerWidth - width) / 2,\n          top: (viewerHeight - height) / 2\n        };\n\n        initialImageData = extend({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this.imageData = imageData;\n        _this.initialImageData = initialImageData;\n\n        if (isFunction(callback)) {\n          callback();\n        }\n      });\n    },\n\n    renderImage: function (callback) {\n      var _this = this;\n      var image = _this.image;\n      var imageData = _this.imageData;\n      var transform = getTransform(imageData);\n\n      setStyle(image, {\n        width: imageData.width,\n        height: imageData.height,\n        marginLeft: imageData.left,\n        marginTop: imageData.top,\n        WebkitTransform: transform,\n        msTransform: transform,\n        transform: transform\n      });\n\n      if (isFunction(callback)) {\n        if (_this.transitioning) {\n          addListener(image, EVENT_TRANSITIONEND, callback, true);\n        } else {\n          callback();\n        }\n      }\n    },\n\n    resetImage: function () {\n      var _this = this;\n\n      // this.image only defined after viewed\n      if (_this.image) {\n        removeChild(_this.image);\n        _this.image = null;\n      }\n    },\n\n    start: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var target = e.target;\n\n      if (target.tagName.toLowerCase() === 'img') {\n        _this.target = target;\n        _this.show();\n      }\n    },\n\n    click: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var target = e.target;\n      var action = getData(target, 'action');\n      var imageData = _this.imageData;\n\n      switch (action) {\n        case 'mix':\n          if (_this.isPlayed) {\n            _this.stop();\n          } else {\n            if (_this.options.inline) {\n              if (_this.isFulled) {\n                _this.exit();\n              } else {\n                _this.full();\n              }\n            } else {\n              _this.hide();\n            }\n          }\n\n          break;\n\n        case 'view':\n          _this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          _this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          _this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          _this.toggle();\n          break;\n\n        case 'reset':\n          _this.reset();\n          break;\n\n        case 'prev':\n          _this.prev();\n          break;\n\n        case 'play':\n          _this.play();\n          break;\n\n        case 'next':\n          _this.next();\n          break;\n\n        case 'rotate-left':\n          _this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          _this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          _this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          _this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (_this.isPlayed) {\n            _this.stop();\n          }\n      }\n    },\n\n    load: function () {\n      var _this = this;\n      var options = _this.options;\n      var image = _this.image;\n      var index = _this.index;\n      var viewerData = _this.viewerData;\n\n      if (_this.timeout) {\n        clearTimeout(_this.timeout);\n        _this.timeout = false;\n      }\n\n      removeClass(image, CLASS_INVISIBLE);\n\n      image.style.cssText = (\n        'width:0;' +\n        'height:0;' +\n        'margin-left:' + viewerData.width / 2 + 'px;' +\n        'margin-top:' + viewerData.height / 2 + 'px;' +\n        'max-width:none!important;' +\n        'visibility:visible;'\n      );\n\n      _this.initImage(function () {\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n        toggleClass(image, CLASS_MOVE, options.movable);\n\n        _this.renderImage(function () {\n          _this.isViewed = true;\n          dispatchEvent(_this.element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          });\n        });\n      });\n    },\n\n    loadImage: function (event) {\n      var e = getEvent(event);\n      var image = e.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n\n      getImageSize(image, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else {\n          if (filled) {\n            height = parentWidth / aspectRatio;\n          } else {\n            width = parentHeight * aspectRatio;\n          }\n        }\n\n        setStyle(image, {\n          width: width,\n          height: height,\n          marginLeft: (parentWidth - width) / 2,\n          marginTop: (parentHeight - height) / 2\n        });\n      });\n    },\n\n    resize: function () {\n      var _this = this;\n\n      _this.initContainer();\n      _this.initViewer();\n      _this.renderViewer();\n      _this.renderList();\n\n      if (_this.isViewed) {\n        _this.initImage(function () {\n          _this.renderImage();\n        });\n      }\n\n      if (_this.isPlayed) {\n        each(getByTag(_this.player, 'img'), function (image) {\n          addListener(image, EVENT_LOAD, proxy(_this.loadImage, _this), true);\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n\n    wheel: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var ratio = Number(_this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (!_this.isViewed) {\n        return;\n      }\n\n      preventDefault(e);\n\n      // Limit wheel speed to prevent zoom too fast\n      if (_this.wheeling) {\n        return;\n      }\n\n      _this.wheeling = true;\n\n      setTimeout(function () {\n        _this.wheeling = false;\n      }, 50);\n\n      if (e.deltaY) {\n        delta = e.deltaY > 0 ? 1 : -1;\n      } else if (e.wheelDelta) {\n        delta = -e.wheelDelta / 120;\n      } else if (e.detail) {\n        delta = e.detail > 0 ? 1 : -1;\n      }\n\n      _this.zoom(-delta * ratio, true, e);\n    },\n\n    keydown: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var options = _this.options;\n      var key = e.keyCode || e.which || e.charCode;\n\n      if (!_this.isFulled || !options.keyboard) {\n        return;\n      }\n\n      switch (key) {\n\n        // (Key: Esc)\n        case 27:\n          if (_this.isPlayed) {\n            _this.stop();\n          } else {\n            if (options.inline) {\n              if (_this.isFulled) {\n                _this.exit();\n              }\n            } else {\n              _this.hide();\n            }\n          }\n\n          break;\n\n        // (Key: Space)\n        case 32:\n          if (_this.isPlayed) {\n            _this.stop();\n          }\n\n          break;\n\n        // View previous (Key: ←)\n        case 37:\n          _this.prev();\n          break;\n\n        // Zoom in (Key: ↑)\n        case 38:\n\n          // Prevent scroll on Firefox\n          preventDefault(e);\n\n          _this.zoom(options.zoomRatio, true);\n          break;\n\n        // View next (Key: →)\n        case 39:\n          _this.next();\n          break;\n\n        // Zoom out (Key: ↓)\n        case 40:\n\n          // Prevent scroll on Firefox\n          preventDefault(e);\n\n          _this.zoom(-options.zoomRatio, true);\n          break;\n\n        // Zoom out to initial size (Key: Ctrl + 0)\n        case 48:\n          // Go to next\n\n        // Zoom in to natural size (Key: Ctrl + 1)\n        case 49:\n          if (e.ctrlKey || e.shiftKey) {\n            preventDefault(e);\n            _this.toggle();\n          }\n\n          break;\n\n        // No default\n      }\n    },\n\n    mousedown: function (event) {\n      var _this = this;\n      var options = _this.options;\n      var pointers = _this.pointers;\n      var e = getEvent(event);\n      var action = options.movable ? 'move' : false;\n\n      if (!_this.isViewed) {\n        return;\n      }\n\n      if (e.changedTouches) {\n        each(e.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[e.pointerId || 0] = getPointer(e);\n      }\n\n      if (Object.keys(pointers).length > 1) {\n        action = 'zoom';\n      } else if ((e.pointerType === 'touch' || e.type === 'touchmove') && _this.isSwitchable()) {\n        action = 'switch';\n      }\n\n      _this.action = action;\n    },\n\n    mousemove: function (event) {\n      var _this = this;\n      var options = _this.options;\n      var pointers = _this.pointers;\n      var e = getEvent(event);\n      var action = _this.action;\n      var image = _this.image;\n\n      if (!_this.isViewed || !action) {\n        return;\n      }\n\n      preventDefault(e);\n\n      if (e.changedTouches) {\n        each(e.changedTouches, function (touch) {\n          extend(pointers[touch.identifier], getPointer(touch), true);\n        });\n      } else {\n        extend(pointers[e.pointerId || 0], getPointer(e, true));\n      }\n\n      if (action === 'move' && options.transition && hasClass(image, CLASS_TRANSITION)) {\n        removeClass(image, CLASS_TRANSITION);\n      }\n\n      _this.change(e);\n    },\n\n    mouseup: function (event) {\n      var _this = this;\n      var pointers = _this.pointers;\n      var e = getEvent(event);\n      var action = _this.action;\n\n      if (!action) {\n        return;\n      }\n\n      if (e.changedTouches) {\n        each(e.changedTouches, function (touch) {\n          delete pointers[touch.identifier];\n        });\n      } else {\n        delete pointers[e.pointerId || 0];\n      }\n\n      if (!Object.keys(pointers).length) {\n        if (action === 'move' && _this.options.transition) {\n          addClass(_this.image, CLASS_TRANSITION);\n        }\n\n        _this.action = false;\n      }\n    },\n\n    // Show the viewer (only available in modal mode)\n    show: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer;\n\n      if (options.inline || _this.transitioning) {\n        return _this;\n      }\n\n      if (!_this.isBuilt) {\n        _this.build();\n      }\n\n      viewer = _this.viewer;\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, true);\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false) {\n        return _this;\n      }\n\n      _this.open();\n      removeClass(viewer, CLASS_HIDE);\n\n      addListener(element, EVENT_SHOWN, function () {\n        _this.view(_this.target ? inArray(_this.target, toArray(_this.images)) : _this.index);\n        _this.target = false;\n      }, true);\n\n      if (options.transition) {\n        _this.transitioning = true;\n        addClass(viewer, CLASS_TRANSITION);\n        forceReflow(viewer);\n        addListener(viewer, EVENT_TRANSITIONEND, proxy(_this.shown, _this), true);\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        _this.shown();\n      }\n\n      return _this;\n    },\n\n    // Hide the viewer (only available in modal mode)\n    hide: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer = _this.viewer;\n\n      if (options.inline || _this.transitioning || !_this.isShown) {\n        return _this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, true);\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return _this;\n      }\n\n      if (_this.isViewed && options.transition) {\n        _this.transitioning = true;\n        addListener(_this.image, EVENT_TRANSITIONEND, function () {\n          addListener(viewer, EVENT_TRANSITIONEND, proxy(_this.hidden, _this), true);\n          removeClass(viewer, CLASS_IN);\n        }, true);\n        _this.zoomTo(0, false, false, true);\n      } else {\n        removeClass(viewer, CLASS_IN);\n        _this.hidden();\n      }\n\n      return _this;\n    },\n\n    /**\n     * View one of the images with image's index\n     *\n     * @param {Number} index\n     */\n    view: function (index) {\n      var _this = this;\n      var element = _this.element;\n      var title = _this.title;\n      var canvas = _this.canvas;\n      var image;\n      var item;\n      var img;\n      var url;\n      var alt;\n\n      index = Number(index) || 0;\n\n      if (!_this.isShown || _this.isPlayed || index < 0 || index >= _this.length ||\n        _this.isViewed && index === _this.index) {\n        return _this;\n      }\n\n      item = _this.items[index];\n      img = getByTag(item, 'img')[0];\n      url = getData(img, 'originalUrl');\n      alt = img.getAttribute('alt');\n\n      image = document.createElement('img');\n      image.src = url;\n      image.alt = alt;\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: _this.images[index],\n        index: index,\n        image: image\n      }) === false) {\n        return _this;\n      }\n\n      _this.image = image;\n\n      if (_this.isViewed) {\n        removeClass(_this.items[_this.index], CLASS_ACTIVE);\n      }\n\n      addClass(item, CLASS_ACTIVE);\n\n      _this.isViewed = false;\n      _this.index = index;\n      _this.imageData = null;\n\n      addClass(image, CLASS_INVISIBLE);\n      empty(canvas);\n      appendChild(canvas, image);\n\n      // Center current item\n      _this.renderList();\n\n      // Clear title\n      empty(title);\n\n      // Generate title after viewed\n      addListener(element, EVENT_VIEWED, function () {\n        var imageData = _this.imageData;\n        var width = imageData.naturalWidth;\n        var height = imageData.naturalHeight;\n\n        setText(title, alt + ' (' + width + ' × ' + height + ')');\n      }, true);\n\n      if (image.complete) {\n        _this.load();\n      } else {\n        addListener(image, EVENT_LOAD, proxy(_this.load, _this), true);\n\n        if (_this.timeout) {\n          clearTimeout(_this.timeout);\n        }\n\n        // Make the image visible if it fails to load within 1s\n        _this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this.timeout = false;\n        }, 1000);\n      }\n\n      return _this;\n    },\n\n    // View the previous image\n    prev: function () {\n      var _this = this;\n\n      _this.view(max(_this.index - 1, 0));\n\n      return _this;\n    },\n\n    // View the next image\n    next: function () {\n      var _this = this;\n\n      _this.view(min(_this.index + 1, _this.length - 1));\n\n      return _this;\n    },\n\n    /**\n     * Move the image with relative offsets\n     *\n     * @param {Number} offsetX\n     * @param {Number} offsetY (optional)\n     */\n    move: function (offsetX, offsetY) {\n      var _this = this;\n      var imageData = _this.imageData;\n\n      _this.moveTo(\n        isUndefined(offsetX) ? offsetX : imageData.left + Number(offsetX),\n        isUndefined(offsetY) ? offsetY : imageData.top + Number(offsetY)\n      );\n\n      return _this;\n    },\n\n    /**\n     * Move the image to an absolute point\n     *\n     * @param {Number} x\n     * @param {Number} y (optional)\n     */\n    moveTo: function (x, y) {\n      var _this = this;\n      var imageData = _this.imageData;\n      var changed = false;\n\n      // If \"y\" is not present, its default value is \"x\"\n      if (isUndefined(y)) {\n        y = x;\n      }\n\n      x = Number(x);\n      y = Number(y);\n\n      if (_this.isViewed && !_this.isPlayed && _this.options.movable) {\n        if (isNumber(x)) {\n          imageData.left = x;\n          changed = true;\n        }\n\n        if (isNumber(y)) {\n          imageData.top = y;\n          changed = true;\n        }\n\n        if (changed) {\n          _this.renderImage();\n        }\n      }\n\n      return _this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio\n     *\n     * @param {Number} ratio\n     * @param {Boolean} hasTooltip (optional)\n     * @param {Event} _originalEvent (private)\n     */\n    zoom: function (ratio, hasTooltip, _originalEvent) {\n      var _this = this;\n      var imageData = _this.imageData;\n\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio =  1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      _this.zoomTo(imageData.width * ratio / imageData.naturalWidth, hasTooltip, _originalEvent);\n\n      return _this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio\n     *\n     * @param {Number} ratio\n     * @param {Boolean} hasTooltip (optional)\n     * @param {Event} _originalEvent (private)\n     * @param {Boolean} _zoomable (private)\n     */\n    zoomTo: function (ratio, hasTooltip, _originalEvent, _zoomable) {\n      var _this = this;\n      var options = _this.options;\n      var pointers = _this.pointers;\n      var minZoomRatio = 0.01;\n      var maxZoomRatio = 100;\n      var imageData = _this.imageData;\n      var newWidth;\n      var newHeight;\n      var offset;\n      var center;\n\n      ratio = max(0, ratio);\n\n      if (isNumber(ratio) && _this.isViewed && !_this.isPlayed && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          minZoomRatio = max(minZoomRatio, options.minZoomRatio);\n          maxZoomRatio = min(maxZoomRatio, options.maxZoomRatio);\n          ratio = min(max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (ratio > 0.95 && ratio < 1.05) {\n          ratio = 1;\n        }\n\n        newWidth = imageData.naturalWidth * ratio;\n        newHeight = imageData.naturalHeight * ratio;\n\n        if (_originalEvent) {\n          offset = getOffset(_this.viewer);\n          center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          };\n\n          // Zoom from the triggering point of the event\n          imageData.left -= (newWidth - imageData.width) * (\n            ((center.pageX - offset.left) - imageData.left) / imageData.width\n          );\n          imageData.top -= (newHeight - imageData.height) * (\n            ((center.pageY - offset.top) - imageData.top) / imageData.height\n          );\n        } else {\n\n          // Zoom from the center of the image\n          imageData.left -= (newWidth - imageData.width) / 2;\n          imageData.top -= (newHeight - imageData.height) / 2;\n        }\n\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.ratio = ratio;\n        _this.renderImage();\n\n        if (hasTooltip) {\n          _this.tooltip();\n        }\n      }\n\n      return _this;\n    },\n\n    /**\n     * Rotate the image with a relative degree\n     *\n     * @param {Number} degree\n     */\n    rotate: function (degree) {\n      var _this = this;\n\n      _this.rotateTo((_this.imageData.rotate || 0) + Number(degree));\n\n      return _this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree\n     * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#rotate()\n     *\n     * @param {Number} degree\n     */\n    rotateTo: function (degree) {\n      var _this = this;\n      var imageData = _this.imageData;\n\n      degree = Number(degree);\n\n      if (isNumber(degree) && _this.isViewed && !_this.isPlayed && _this.options.rotatable) {\n        imageData.rotate = degree;\n        _this.renderImage();\n      }\n\n      return _this;\n    },\n\n    /**\n     * Scale the image\n     * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#scale()\n     *\n     * @param {Number} scaleX\n     * @param {Number} scaleY (optional)\n     */\n    scale: function (scaleX, scaleY) {\n      var _this = this;\n      var imageData = _this.imageData;\n      var changed = false;\n\n      // If \"scaleY\" is not present, its default value is \"scaleX\"\n      if (isUndefined(scaleY)) {\n        scaleY = scaleX;\n      }\n\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (_this.isViewed && !_this.isPlayed && _this.options.scalable) {\n        if (isNumber(scaleX)) {\n          imageData.scaleX = scaleX;\n          changed = true;\n        }\n\n        if (isNumber(scaleY)) {\n          imageData.scaleY = scaleY;\n          changed = true;\n        }\n\n        if (changed) {\n          _this.renderImage();\n        }\n      }\n\n      return _this;\n    },\n\n    /**\n     * Scale the abscissa of the image\n     *\n     * @param {Number} scaleX\n     */\n    scaleX: function (scaleX) {\n      var _this = this;\n\n      _this.scale(scaleX, _this.imageData.scaleY);\n\n      return _this;\n    },\n\n    /**\n     * Scale the ordinate of the image\n     *\n     * @param {Number} scaleY\n     */\n    scaleY: function (scaleY) {\n      var _this = this;\n\n      _this.scale(_this.imageData.scaleX, scaleY);\n\n      return _this;\n    },\n\n    // Play the images\n    play: function () {\n      var _this = this;\n      var options = _this.options;\n      var player = _this.player;\n      var load = proxy(_this.loadImage, _this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      var playing;\n\n      if (!_this.isShown || _this.isPlayed) {\n        return _this;\n      }\n\n      if (options.fullscreen) {\n        _this.requestFullscreen();\n      }\n\n      _this.isPlayed = true;\n      addClass(player, CLASS_SHOW);\n\n      each(_this.items, function (item, i) {\n        var img = getByTag(item, 'img')[0];\n        var image = document.createElement('img');\n\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        total++;\n\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, load, true);\n        appendChild(player, image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        playing = function () {\n          _this.playing = setTimeout(function () {\n            removeClass(list[index], CLASS_IN);\n            index++;\n            index = index < total ? index : 0;\n            addClass(list[index], CLASS_IN);\n\n            playing();\n          }, options.interval);\n        };\n\n        if (total > 1) {\n          playing();\n        }\n      }\n\n      return _this;\n    },\n\n    // Stop play\n    stop: function () {\n      var _this = this;\n      var player = _this.player;\n\n      if (!_this.isPlayed) {\n        return _this;\n      }\n\n      if (_this.options.fullscreen) {\n        _this.exitFullscreen();\n      }\n\n      _this.isPlayed = false;\n      clearTimeout(_this.playing);\n      removeClass(player, CLASS_SHOW);\n      empty(player);\n\n      return _this;\n    },\n\n    // Enter modal mode (only available in inline mode)\n    full: function () {\n      var _this = this;\n      var options = _this.options;\n      var viewer = _this.viewer;\n      var image = _this.image;\n      var list = _this.list;\n\n      if (!_this.isShown || _this.isPlayed || _this.isFulled || !options.inline) {\n        return _this;\n      }\n\n      _this.isFulled = true;\n      _this.open();\n      addClass(_this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(image, CLASS_TRANSITION);\n        removeClass(list, CLASS_TRANSITION);\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('style', '');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n\n      _this.initContainer();\n      _this.viewerData = extend({}, _this.containerData);\n      _this.renderList();\n      _this.initImage(function () {\n        _this.renderImage(function () {\n          if (options.transition) {\n            setTimeout(function () {\n              addClass(image, CLASS_TRANSITION);\n              addClass(list, CLASS_TRANSITION);\n            }, 0);\n          }\n        });\n      });\n\n      return _this;\n    },\n\n    // Exit modal mode (only available in inline mode)\n    exit: function () {\n      var _this = this;\n      var options = _this.options;\n      var viewer = _this.viewer;\n      var image = _this.image;\n      var list = _this.list;\n\n      if (!_this.isFulled) {\n        return _this;\n      }\n\n      _this.isFulled = false;\n      _this.close();\n      removeClass(_this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(image, CLASS_TRANSITION);\n        removeClass(list, CLASS_TRANSITION);\n      }\n\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n\n      _this.viewerData = extend({}, _this.parentData);\n      _this.renderViewer();\n      _this.renderList();\n      _this.initImage(function () {\n        _this.renderImage(function () {\n          if (options.transition) {\n            setTimeout(function () {\n              addClass(image, CLASS_TRANSITION);\n              addClass(list, CLASS_TRANSITION);\n            }, 0);\n          }\n        });\n      });\n\n      return _this;\n    },\n\n    // Show the current ratio of the image with percentage\n    tooltip: function () {\n      var _this = this;\n      var options = _this.options;\n      var tooltipBox = _this.tooltipBox;\n      var imageData = _this.imageData;\n\n      if (!_this.isViewed || _this.isPlayed || !options.tooltip) {\n        return _this;\n      }\n\n      setText(tooltipBox, round(imageData.ratio * 100) + '%');\n\n      if (!_this.tooltiping) {\n        if (options.transition) {\n          if (_this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITIONEND);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION);\n          forceReflow(tooltipBox);\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n        }\n      } else {\n        clearTimeout(_this.tooltiping);\n      }\n\n      _this.tooltiping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITIONEND, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            _this.fading = false;\n          }, true);\n\n          removeClass(tooltipBox, CLASS_IN);\n          _this.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n        }\n\n        _this.tooltiping = false;\n      }, 1000);\n\n      return _this;\n    },\n\n    // Toggle the image size between its natural size and initial size\n    toggle: function () {\n      var _this = this;\n\n      if (_this.imageData.ratio === 1) {\n        _this.zoomTo(_this.initialImageData.ratio, true);\n      } else {\n        _this.zoomTo(1, true);\n      }\n\n      return _this;\n    },\n\n    // Reset the image to its initial state\n    reset: function () {\n      var _this = this;\n\n      if (_this.isViewed && !_this.isPlayed) {\n        _this.imageData = extend({}, _this.initialImageData);\n        _this.renderImage();\n      }\n\n      return _this;\n    },\n\n    // Update viewer when images changed\n    update: function () {\n      var _this = this;\n      var indexes = [];\n      var index;\n\n      // Destroy viewer if the target image was deleted\n      if (_this.isImg && !_this.element.parentNode) {\n        return _this.destroy();\n      }\n\n      _this.length = _this.images.length;\n\n      if (_this.isBuilt) {\n        each(_this.items, function (item, i) {\n          var img = getByTag(item, 'img')[0];\n          var image = _this.images[i];\n\n          if (image) {\n            if (image.src !== img.src) {\n              indexes.push(i);\n            }\n          } else {\n            indexes.push(i);\n          }\n        });\n\n        setStyle(_this.list, {\n          width: 'auto'\n        });\n\n        _this.initList();\n\n        if (_this.isShown) {\n          if (_this.length) {\n            if (_this.isViewed) {\n              index = inArray(_this.index, indexes);\n\n              if (index >= 0) {\n                _this.isViewed = false;\n                _this.view(max(_this.index - (index + 1), 0));\n              } else {\n                addClass(_this.items[_this.index], CLASS_ACTIVE);\n              }\n            }\n          } else {\n            _this.image = null;\n            _this.isViewed = false;\n            _this.index = 0;\n            _this.imageData = null;\n            empty(_this.canvas);\n            empty(_this.title);\n          }\n        }\n      }\n\n      return _this;\n    },\n\n    // Destroy the viewer\n    destroy: function () {\n      var _this = this;\n      var element = _this.element;\n\n      if (_this.options.inline) {\n        _this.unbind();\n      } else {\n        if (_this.isShown) {\n          _this.unbind();\n        }\n\n        removeListener(element, EVENT_CLICK, _this._start);\n      }\n\n      _this.unbuild();\n      removeData(element, NAMESPACE);\n\n      return _this;\n    },\n\n    open: function () {\n      var body = this.body;\n\n      addClass(body, CLASS_OPEN);\n      body.style.paddingRight = this.scrollbarWidth + 'px';\n    },\n\n    close: function () {\n      var body = this.body;\n\n      removeClass(body, CLASS_OPEN);\n      body.style.paddingRight = 0;\n    },\n\n    shown: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n\n      _this.transitioning = false;\n      _this.isFulled = true;\n      _this.isShown = true;\n      _this.isVisible = true;\n      _this.render();\n      _this.bind();\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, true);\n      }\n\n      dispatchEvent(element, EVENT_SHOWN);\n    },\n\n    hidden: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n\n      _this.transitioning = false;\n      _this.isViewed = false;\n      _this.isFulled = false;\n      _this.isShown = false;\n      _this.isVisible = false;\n      _this.unbind();\n      _this.close();\n      addClass(_this.viewer, CLASS_HIDE);\n      _this.resetList();\n      _this.resetImage();\n\n      if (isFunction(options.hidden)) {\n        addListener(element, EVENT_HIDDEN, options.hidden, true);\n      }\n\n      dispatchEvent(element, EVENT_HIDDEN);\n    },\n\n    requestFullscreen: function () {\n      var _this = this;\n      var documentElement = document.documentElement;\n\n      if (_this.isFulled && !document.fullscreenElement && !document.mozFullScreenElement &&\n        !document.webkitFullscreenElement && !document.msFullscreenElement) {\n\n        if (documentElement.requestFullscreen) {\n          documentElement.requestFullscreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        }\n      }\n    },\n\n    exitFullscreen: function () {\n      var _this = this;\n\n      if (_this.isFulled) {\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    },\n\n    change: function (e) {\n      var _this = this;\n      var pointers = _this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]];\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (_this.action) {\n\n        // Move the current image\n        case 'move':\n          _this.move(offsetX, offsetY);\n          break;\n\n        // Zoom the current image\n        case 'zoom':\n          _this.zoom(getMaxZoomRatio(pointers), false, e);\n          break;\n\n        case 'switch':\n          _this.action = 'switched';\n\n          if (abs(offsetX) > abs(offsetY)) {\n            if (offsetX > 1) {\n              _this.prev();\n            } else if (offsetX < -1) {\n              _this.next();\n            }\n          }\n\n          break;\n\n        // No default\n      }\n\n      // Override\n      each(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n\n    isSwitchable: function () {\n      var _this = this;\n      var imageData = _this.imageData;\n      var viewerData = _this.viewerData;\n\n      return _this.length > 1 && imageData.left >= 0 && imageData.top >= 0 &&\n        imageData.width <= viewerData.width &&\n        imageData.height <= viewerData.height;\n    }\n  };\n\n  Viewer.DEFAULTS = {\n\n    // Enable inline mode\n    inline: false,\n\n    // Show the button on the top-right of the viewer\n    button: true,\n\n    // Show the navbar\n    navbar: true,\n\n    // Show the title\n    title: true,\n\n    // Show the toolbar\n    toolbar: true,\n\n    // Show the tooltip with image ratio (percentage) when zoom in or zoom out\n    tooltip: true,\n\n    // Enable to move the image\n    movable: true,\n\n    // Enable to zoom the image\n    zoomable: true,\n\n    // Enable to rotate the image\n    rotatable: true,\n\n    // Enable to scale the image\n    scalable: true,\n\n    // Enable CSS3 Transition for some special elements\n    transition: true,\n\n    // Enable to request fullscreen when play\n    fullscreen: true,\n\n    // Enable keyboard support\n    keyboard: true,\n\n    // Define interval of each image when playing\n    interval: 5000,\n\n    // Min width of the viewer in inline mode\n    minWidth: 200,\n\n    // Min height of the viewer in inline mode\n    minHeight: 100,\n\n    // Define the ratio when zoom the image by wheeling mouse\n    zoomRatio: 0.1,\n\n    // Define the min ratio of the image when zoom out\n    minZoomRatio: 0.01,\n\n    // Define the max ratio of the image when zoom in\n    maxZoomRatio: 100,\n\n    // Define the CSS `z-index` value of viewer in modal mode.\n    zIndex: 2015,\n\n    // Define the CSS `z-index` value of viewer in inline mode.\n    zIndexInline: 0,\n\n    // Define where to get the original image URL for viewing\n    // Type: String (an image attribute) or Function (should return an image URL)\n    url: 'src',\n\n    // Event shortcuts\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null\n  };\n\n  Viewer.TEMPLATE = (\n    '<div class=\"viewer-container\">' +\n      '<div class=\"viewer-canvas\"></div>' +\n      '<div class=\"viewer-footer\">' +\n        '<div class=\"viewer-title\"></div>' +\n        '<ul class=\"viewer-toolbar\">' +\n          '<li class=\"viewer-zoom-in\" data-action=\"zoom-in\"></li>' +\n          '<li class=\"viewer-zoom-out\" data-action=\"zoom-out\"></li>' +\n          '<li class=\"viewer-one-to-one\" data-action=\"one-to-one\"></li>' +\n          '<li class=\"viewer-reset\" data-action=\"reset\"></li>' +\n          '<li class=\"viewer-prev\" data-action=\"prev\"></li>' +\n          '<li class=\"viewer-play\" data-action=\"play\"></li>' +\n          '<li class=\"viewer-next\" data-action=\"next\"></li>' +\n          '<li class=\"viewer-rotate-left\" data-action=\"rotate-left\"></li>' +\n          '<li class=\"viewer-rotate-right\" data-action=\"rotate-right\"></li>' +\n          '<li class=\"viewer-flip-horizontal\" data-action=\"flip-horizontal\"></li>' +\n          '<li class=\"viewer-flip-vertical\" data-action=\"flip-vertical\"></li>' +\n        '</ul>' +\n        '<div class=\"viewer-navbar\">' +\n          '<ul class=\"viewer-list\"></ul>' +\n        '</div>' +\n      '</div>' +\n      '<div class=\"viewer-tooltip\"></div>' +\n      '<div class=\"viewer-button\" data-action=\"mix\"></div>' +\n      '<div class=\"viewer-player\"></div>' +\n    '</div>'\n  );\n\n  var _Viewer = window.Viewer;\n\n  Viewer.noConflict = function () {\n    window.Viewer = _Viewer;\n    return Viewer;\n  };\n\n  Viewer.setDefaults = function (options) {\n    extend(Viewer.DEFAULTS, options);\n  };\n\n  if (true) {\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function () {\n      return Viewer;\n    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  }\n\n  if (!noGlobal) {\n    window.Viewer = Viewer;\n  }\n\n  return Viewer;\n\n});\n\n\n/***/ }),\n\n/***/ 32:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*\n * BlogSTEP \n * Copyright (c) 2017 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar paths = __webpack_require__(2);\n\n__webpack_require__(19);\n\nvar Viewer = __webpack_require__(22);\n\nBLOGSTEP.init('viewer', function (app) {\n\tvar $viewer = app.frame.find('#viewer');\n\tvar viewer = null;\n\tvar first = true;\n\n\tvar menu = app.addMenu('Viewer');\n\tmenu.addItem('Close', 'close');\n\n\tapp.onOpen = function (app, args) {\n\t\tapp.setTitle(args.path + ' – Viewer');\n\t\tfirst = true;\n\t\tBLOGSTEP.get('list-files', { path: paths.dirName(args.path) }).done(function (data) {\n\t\t\tfor (var i = 0; i < data.files.length; i++) {\n\t\t\t\tif (data.files[i].name.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n\t\t\t\t\tvar $img = $('<img/>');\n\t\t\t\t\t$img.attr('src', BLOGSTEP.PATH + '/api/download?path=' + data.files[i].path);\n\t\t\t\t\t$img.attr('alt', data.files[i].name);\n\t\t\t\t\t$img.data('path', data.files[i].path);\n\t\t\t\t\tif (data.files[i].path === args.path) {\n\t\t\t\t\t\t$img.addClass('active');\n\t\t\t\t\t}\n\t\t\t\t\t$viewer.append($img);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tviewer = new Viewer($viewer[0], {\n\t\t\t\tinline: true,\n\t\t\t\tviewed: function viewed(e) {\n\t\t\t\t\tif (first) {\n\t\t\t\t\t\tviewer.view($viewer.children('.active').index());\n\t\t\t\t\t\tfirst = false;\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t$viewer.find('img.active').removeClass('active');\n\t\t\t\t\tvar $image = $(e.detail.originalImage);\n\t\t\t\t\t$image.addClass('active');\n\t\t\t\t\tapp.setTitle($image.data('path') + ' – Viewer');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n\n\tapp.onClose = function (app) {\n\t\tviewer.destroy();\n\t\t$viewer.empty();\n\t};\n});\n\n/***/ })\n\n},[32]);\n\n\n// WEBPACK FOOTER //\n// dist/viewer.js","/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path)\n{\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path)\n{\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd)\n{\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n\n// WEBPACK FOOTER //\n// ./common/paths.js","/*!\n * Viewer.js v0.5.1\n * https://github.com/fengyuanchen/viewerjs\n *\n * Copyright (c) 2015-2017 Fengyuan Chen\n * Released under the MIT license\n *\n * Date: 2017-01-02T13:01:55.700Z\n */\n\n(function (global, factory) {\n  if (typeof module === 'object' && typeof module.exports === 'object') {\n    module.exports = global.document ? factory(global, true) : function (window) {\n      if (!window.document) {\n        throw new Error('Viewer requires a window with a document');\n      }\n\n      return factory(window);\n    };\n  } else {\n    factory(global);\n  }\n})(typeof window !== 'undefined' ? window : this, function (window, noGlobal) {\n\n  'use strict';\n\n  var document = window.document;\n  var Event = window.Event;\n  var PointerEvent = window.PointerEvent;\n\n  // Constants\n  var NAMESPACE = 'viewer';\n\n  // Classes\n  var CLASS_FIXED = NAMESPACE + '-fixed';\n  var CLASS_OPEN = NAMESPACE + '-open';\n  var CLASS_SHOW = NAMESPACE + '-show';\n  var CLASS_HIDE = NAMESPACE + '-hide';\n  var CLASS_HIDE_XS_DOWN = 'viewer-hide-xs-down';\n  var CLASS_HIDE_SM_DOWN = 'viewer-hide-sm-down';\n  var CLASS_HIDE_MD_DOWN = 'viewer-hide-md-down';\n  var CLASS_FADE = NAMESPACE + '-fade';\n  var CLASS_IN = NAMESPACE + '-in';\n  var CLASS_MOVE = NAMESPACE + '-move';\n  var CLASS_ACTIVE = NAMESPACE + '-active';\n  var CLASS_INVISIBLE = NAMESPACE + '-invisible';\n  var CLASS_TRANSITION = NAMESPACE + '-transition';\n  var CLASS_FULLSCREEN = NAMESPACE + '-fullscreen';\n  var CLASS_FULLSCREEN_EXIT = NAMESPACE + '-fullscreen-exit';\n  var CLASS_CLOSE = NAMESPACE + '-close';\n\n  // Events\n  var EVENT_MOUSEDOWN = PointerEvent ? 'pointerdown' : 'touchstart mousedown';\n  var EVENT_MOUSEMOVE = PointerEvent ? 'pointermove' : 'mousemove touchmove';\n  var EVENT_MOUSEUP = PointerEvent ? 'pointerup pointercancel' : 'touchend touchcancel mouseup';\n  var EVENT_WHEEL = 'wheel mousewheel DOMMouseScroll';\n  var EVENT_TRANSITIONEND = 'transitionend';\n  var EVENT_LOAD = 'load';\n  var EVENT_KEYDOWN = 'keydown';\n  var EVENT_CLICK = 'click';\n  var EVENT_RESIZE = 'resize';\n  var EVENT_READY = 'ready';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_HIDE = 'hide';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n\n  // RegExps\n  var REGEXP_SUFFIX = /^(width|height|left|top|marginLeft|marginTop)$/;\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  var REGEXP_TRIM = /^\\s+(.*)\\s+$/;\n  var REGEXP_SPACES = /\\s+/;\n\n  // Supports\n  var SUPPORT_TRANSITION = typeof document.createElement(NAMESPACE).style.transition !== 'undefined';\n\n  // Maths\n  var min = Math.min;\n  var max = Math.max;\n  var abs = Math.abs;\n  var sqrt = Math.sqrt;\n  var round = Math.round;\n\n  // Utilities\n  var objectProto = Object.prototype;\n  var toString = objectProto.toString;\n  var hasOwnProperty = objectProto.hasOwnProperty;\n  var slice = Array.prototype.slice;\n\n  function typeOf(obj) {\n    return toString.call(obj).slice(8, -1).toLowerCase();\n  }\n\n  function isString(str) {\n    return typeof str === 'string';\n  }\n\n  function isNumber(num) {\n    return typeof num === 'number' && !isNaN(num);\n  }\n\n  function isUndefined(obj) {\n    return typeof obj === 'undefined';\n  }\n\n  function isObject(obj) {\n    return typeof obj === 'object' && obj !== null;\n  }\n\n  function isPlainObject(obj) {\n    var constructor;\n    var prototype;\n\n    if (!isObject(obj)) {\n      return false;\n    }\n\n    try {\n      constructor = obj.constructor;\n      prototype = constructor.prototype;\n\n      return constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function isFunction(fn) {\n    return typeOf(fn) === 'function';\n  }\n\n  function isArray(arr) {\n    return Array.isArray ? Array.isArray(arr) : typeOf(arr) === 'array';\n  }\n\n  function toArray(obj, offset) {\n    offset = offset >= 0 ? offset : 0;\n\n    if (Array.from) {\n      return Array.from(obj).slice(offset);\n    }\n\n    return slice.call(obj, offset);\n  }\n\n  function inArray(value, arr) {\n    var index = -1;\n\n    if (arr.indexOf) {\n      return arr.indexOf(value);\n    } else {\n      each(arr, function (n, i) {\n        if (n === value) {\n          index = i;\n          return false;\n        }\n      });\n    }\n\n    return index;\n  }\n\n  function trim(str) {\n    if (isString(str)) {\n      str = str.trim ? str.trim() : str.replace(REGEXP_TRIM, '1');\n    }\n\n    return str;\n  }\n\n  function each(obj, callback) {\n    var length;\n    var i;\n\n    if (obj && isFunction(callback)) {\n      if (isArray(obj) || isNumber(obj.length)/* array-like */) {\n        for (i = 0, length = obj.length; i < length; i++) {\n          if (callback.call(obj, obj[i], i, obj) === false) {\n            break;\n          }\n        }\n      } else if (isObject(obj)) {\n        for (i in obj) {\n          if (obj.hasOwnProperty(i)) {\n            if (callback.call(obj, obj[i], i, obj) === false) {\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    return obj;\n  }\n\n  function extend(obj) {\n    var args;\n\n    if (arguments.length > 1) {\n      args = toArray(arguments);\n\n      if (Object.assign) {\n        return Object.assign.apply(Object, args);\n      }\n\n      args.shift();\n\n      each(args, function (arg) {\n        each(arg, function (prop, i) {\n          obj[i] = prop;\n        });\n      });\n    }\n\n    return obj;\n  }\n\n  function proxy(fn, context) {\n    var args = toArray(arguments, 2);\n\n    return function () {\n      return fn.apply(context, args.concat(toArray(arguments)));\n    };\n  }\n\n  function setStyle(element, styles) {\n    var style = element.style;\n\n    each(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n\n  function getStyle(element) {\n    return window.getComputedStyle ?\n      window.getComputedStyle(element, null) :\n      element.currentStyle;\n  }\n\n  function hasClass(element, value) {\n    return element.classList ?\n      element.classList.contains(value) :\n      element.className.indexOf(value) > -1;\n  }\n\n  function addClass(element, value) {\n    var className;\n\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      return each(element, function (elem) {\n        addClass(elem, value);\n      });\n    }\n\n    if (element.classList) {\n      return element.classList.add(value);\n    }\n\n    className = trim(element.className);\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = className + ' ' + value;\n    }\n  }\n\n  function removeClass(element, value) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      return each(element, function (elem) {\n        removeClass(elem, value);\n      });\n    }\n\n    if (element.classList) {\n      return element.classList.remove(value);\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n\n  function toggleClass(element, value, added) {\n    if (isNumber(element.length)) {\n      return each(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n    }\n\n    // IE10-11 doesn't support the second parameter of `classList.toggle`\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n\n  function hyphenate(str) {\n    return str.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    } else if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute('data-' + hyphenate(name));\n  }\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute('data-' + hyphenate(name), data);\n    }\n  }\n\n  function removeData(element, name) {\n    if (isObject(element[name])) {\n      delete element[name];\n    } else if (element.dataset) {\n      // Safari not allows to delete dataset property\n      try {\n        delete element.dataset[name];\n      } catch (e) {\n        element.dataset[name] = null;\n      }\n    } else {\n      element.removeAttribute('data-' + hyphenate(name));\n    }\n  }\n\n  function addListener(element, type, handler, once) {\n    var types = trim(type).split(REGEXP_SPACES);\n    var originalHandler = handler;\n\n    if (types.length > 1) {\n      return each(types, function (type) {\n        addListener(element, type, handler);\n      });\n    }\n\n    if (once) {\n      handler = function () {\n        removeListener(element, type, handler);\n\n        return originalHandler.apply(element, arguments);\n      };\n    }\n\n    if (element.addEventListener) {\n      element.addEventListener(type, handler, false);\n    } else if (element.attachEvent) {\n      element.attachEvent('on' + type, handler);\n    }\n  }\n\n  function removeListener(element, type, handler) {\n    var types = trim(type).split(REGEXP_SPACES);\n\n    if (types.length > 1) {\n      return each(types, function (type) {\n        removeListener(element, type, handler);\n      });\n    }\n\n    if (element.removeEventListener) {\n      element.removeEventListener(type, handler, false);\n    } else if (element.detachEvent) {\n      element.detachEvent('on' + type, handler);\n    }\n  }\n\n  function dispatchEvent(element, type, data) {\n    var event;\n\n    if (element.dispatchEvent) {\n\n      // Event and CustomEvent on IE9-11 are global objects, not constructors\n      if (isFunction(Event) && isFunction(CustomEvent)) {\n        if (isUndefined(data)) {\n          event = new Event(type, {\n            bubbles: true,\n            cancelable: true\n          });\n        } else {\n          event = new CustomEvent(type, {\n            detail: data,\n            bubbles: true,\n            cancelable: true\n          });\n        }\n      } else {\n        // IE9-11\n        if (isUndefined(data)) {\n          event = document.createEvent('Event');\n          event.initEvent(type, true, true);\n        } else {\n          event = document.createEvent('CustomEvent');\n          event.initCustomEvent(type, true, true, data);\n        }\n      }\n\n      // IE9+\n      return element.dispatchEvent(event);\n    } else if (element.fireEvent) {\n\n      // IE6-10 (native events only)\n      return element.fireEvent('on' + type);\n    }\n  }\n\n  function preventDefault(e) {\n    if (e.preventDefault) {\n      e.preventDefault();\n    } else {\n      e.returnValue = false;\n    }\n  }\n\n  function getEvent(event) {\n    var e = event || window.event;\n    var eventDoc;\n    var doc;\n    var body;\n\n    // Fix target property (IE8)\n    if (!e.target) {\n      e.target = e.srcElement || document;\n    }\n\n    if (!isNumber(e.pageX) && isNumber(e.clientX)) {\n      eventDoc = event.target.ownerDocument || document;\n      doc = eventDoc.documentElement;\n      body = eventDoc.body;\n\n      e.pageX = e.clientX + (\n        ((doc && doc.scrollLeft) || (body && body.scrollLeft) || 0) -\n        ((doc && doc.clientLeft) || (body && body.clientLeft) || 0)\n      );\n      e.pageY = e.clientY + (\n        ((doc && doc.scrollTop) || (body && body.scrollTop) || 0) -\n        ((doc && doc.clientTop) || (body && body.clientTop) || 0)\n      );\n    }\n\n    return e;\n  }\n\n  function getOffset(element) {\n    var doc = document.documentElement;\n    var box = element.getBoundingClientRect();\n\n    return {\n      left: box.left + (window.scrollX || doc && doc.scrollLeft || 0) - (doc && doc.clientLeft || 0),\n      top: box.top + (window.scrollY || doc && doc.scrollTop || 0) - (doc && doc.clientTop || 0)\n    };\n  }\n\n  function getByTag(element, tagName) {\n    return element.getElementsByTagName(tagName);\n  }\n\n  function getByClass(element, className) {\n    return element.getElementsByClassName ?\n      element.getElementsByClassName(className) :\n      element.querySelectorAll('.' + className);\n  }\n\n  function appendChild(element, elem) {\n    if (elem.length) {\n      return each(elem, function (el) {\n        appendChild(element, el);\n      });\n    }\n\n    element.appendChild(elem);\n  }\n\n  function removeChild(element) {\n    if (element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  }\n\n  function empty(element) {\n    while (element.firstChild) {\n      element.removeChild(element.firstChild);\n    }\n  }\n\n  function setText(element, text) {\n    if (!isUndefined(element.textContent)) {\n      element.textContent = text;\n    } else {\n      element.innerText = text;\n    }\n  }\n\n  // Force reflow to enable CSS3 transition\n  function forceReflow(element) {\n    return element.offsetWidth;\n  }\n\n  // e.g.: http://domain.com/path/to/picture.jpg?size=1280×960 -> picture.jpg\n  function getImageName(url) {\n    return isString(url) ? url.replace(/^.*\\//, '').replace(/[\\?&#].*$/, '') : '';\n  }\n\n  function getImageSize(image, callback) {\n    var newImage;\n\n    // Modern browsers\n    if (image.naturalWidth) {\n      return callback(image.naturalWidth, image.naturalHeight);\n    }\n\n    // IE8: Don't use `new Image()` here\n    newImage = document.createElement('img');\n\n    newImage.onload = function () {\n      callback(this.width, this.height);\n    };\n\n    newImage.src = image.src;\n  }\n\n  function getTransform(data) {\n    var transforms = [];\n    var rotate = data.rotate;\n    var scaleX = data.scaleX;\n    var scaleY = data.scaleY;\n\n    // Rotate should come first before scale\n    if (isNumber(rotate)) {\n      transforms.push('rotate(' + rotate + 'deg)');\n    }\n\n    if (isNumber(scaleX)) {\n      transforms.push('scaleX(' + scaleX + ')');\n    }\n\n    if (isNumber(scaleY)) {\n      transforms.push('scaleY(' + scaleY + ')');\n    }\n\n    return transforms.length ? transforms.join(' ') : 'none';\n  }\n\n  function getResponsiveClass(option) {\n    switch (option) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n    }\n  }\n\n  function getPointer(pointer, endOnly) {\n    var end = {\n      endX: pointer.pageX,\n      endY: pointer.pageY\n    };\n\n    if (endOnly) {\n      return end;\n    }\n\n    return extend({\n      startX: pointer.pageX,\n      startY: pointer.pageY\n    }, end);\n  }\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = extend({}, pointers);\n    var ratios = [];\n\n    each(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n\n      each(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt((x1 * x1) + (y1 * y1));\n        var z2 = Math.sqrt((x2 * x2) + (y2 * y2));\n        var ratio = (z2 - z1) / z1;\n\n        ratios.push(ratio);\n      });\n    });\n\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n\n    return ratios[0];\n  }\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n\n    each(pointers, function (pointer) {\n      pageX += pointer.startX;\n      pageY += pointer.startY;\n      count += 1;\n    });\n\n    pageX /= count;\n    pageY /= count;\n\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  function Viewer(element, options) {\n    var _this = this;\n\n    _this.element = element;\n    _this.options = extend({}, Viewer.DEFAULTS, isPlainObject(options) && options);\n    _this.isImg = false;\n    _this.isBuilt = false;\n    _this.isShown = false;\n    _this.isViewed = false;\n    _this.isFulled = false;\n    _this.isPlayed = false;\n    _this.wheeling = false;\n    _this.playing = false;\n    _this.fading = false;\n    _this.tooltiping = false;\n    _this.transitioning = false;\n    _this.action = false;\n    _this.target = false;\n    _this.timeout = false;\n    _this.index = 0;\n    _this.length = 0;\n    _this.pointers = {};\n    _this.init();\n  }\n\n  Viewer.prototype = {\n    constructor: Viewer,\n\n    init: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var isImg = element.tagName.toLowerCase() === 'img';\n      var images = isImg ? [element] : getByTag(element, 'img');\n      var length = images.length;\n      var ready = proxy(_this.ready, _this);\n\n      if (getData(element, NAMESPACE)) {\n        return;\n      }\n\n      setData(element, NAMESPACE, _this);\n\n      if (!length) {\n        return;\n      }\n\n      if (isFunction(options.ready)) {\n        addListener(element, EVENT_READY, options.ready, true);\n      }\n\n      // Override `transition` option if it is not supported\n      if (!SUPPORT_TRANSITION) {\n        options.transition = false;\n      }\n\n      _this.isImg = isImg;\n      _this.length = length;\n      _this.count = 0;\n      _this.images = images;\n      _this.body = document.body;\n      _this.scrollbarWidth = window.innerWidth - document.body.clientWidth;\n\n      if (options.inline) {\n        addListener(element, EVENT_READY, function () {\n          _this.view();\n        }, true);\n\n        each(images, function (image) {\n          if (image.complete) {\n            ready();\n          } else {\n            addListener(image, EVENT_LOAD, ready, true);\n          }\n        });\n      } else {\n        addListener(element, EVENT_CLICK, (_this._start = proxy(_this.start, _this)));\n      }\n    },\n\n    ready: function () {\n      var _this = this;\n\n      _this.count++;\n\n      if (_this.count === _this.length) {\n        _this.build();\n      }\n    },\n\n    build: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var template;\n      var parent;\n      var viewer;\n      var button;\n      var toolbar;\n      var navbar;\n      var title;\n      var rotate;\n\n      if (_this.isBuilt) {\n        return;\n      }\n\n      template = document.createElement('div');\n      template.innerHTML = Viewer.TEMPLATE;\n\n      _this.parent = parent = element.parentNode;\n      _this.viewer = viewer = getByClass(template, 'viewer-container')[0];\n      _this.canvas = getByClass(viewer, 'viewer-canvas')[0];\n      _this.footer = getByClass(viewer, 'viewer-footer')[0];\n      _this.title = title = getByClass(viewer, 'viewer-title')[0];\n      _this.toolbar = toolbar = getByClass(viewer, 'viewer-toolbar')[0];\n      _this.navbar = navbar = getByClass(viewer, 'viewer-navbar')[0];\n      _this.button = button = getByClass(viewer, 'viewer-button')[0];\n      _this.tooltipBox = getByClass(viewer, 'viewer-tooltip')[0];\n      _this.player = getByClass(viewer, 'viewer-player')[0];\n      _this.list = getByClass(viewer, 'viewer-list')[0];\n\n      addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(options.title));\n      addClass(toolbar, !options.toolbar ? CLASS_HIDE : getResponsiveClass(options.toolbar));\n      addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n      toggleClass(button, CLASS_HIDE, !options.button);\n\n      toggleClass(toolbar.querySelector('.viewer-one-to-one'), CLASS_INVISIBLE, !options.zoomable);\n      toggleClass(toolbar.querySelectorAll('li[class*=\"zoom\"]'), CLASS_INVISIBLE, !options.zoomable);\n      toggleClass(toolbar.querySelectorAll('li[class*=\"flip\"]'), CLASS_INVISIBLE, !options.scalable);\n\n      if (!options.rotatable) {\n        rotate = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n        addClass(rotate, CLASS_INVISIBLE);\n        appendChild(toolbar, rotate);\n      }\n\n      if (options.inline) {\n        addClass(button, CLASS_FULLSCREEN);\n        setStyle(viewer, {\n          zIndex: options.zIndexInline\n        });\n\n        if (getStyle(parent).position === 'static') {\n          setStyle(parent, {\n            position: 'relative'\n          });\n        }\n      } else {\n        addClass(button, CLASS_CLOSE);\n        addClass(viewer, CLASS_FIXED);\n        addClass(viewer, CLASS_FADE);\n        addClass(viewer, CLASS_HIDE);\n\n        setStyle(viewer, {\n          zIndex: options.zIndex\n        });\n      }\n\n      // Inserts the viewer after to the current element\n      parent.insertBefore(viewer, element.nextSibling);\n\n      if (options.inline) {\n        _this.render();\n        _this.bind();\n        _this.isShown = true;\n      }\n\n      _this.isBuilt = true;\n\n      dispatchEvent(element, EVENT_READY);\n    },\n\n    unbuild: function () {\n      var _this = this;\n\n      if (!_this.isBuilt) {\n        return;\n      }\n\n      _this.isBuilt = false;\n      removeChild(_this.viewer);\n    },\n\n    bind: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer = _this.viewer;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view);\n      }\n\n      if (isFunction(options.viewed)) {\n        addListener(element, EVENT_VIEWED, options.viewed);\n      }\n\n      addListener(viewer, EVENT_CLICK, (_this._click = proxy(_this.click, _this)));\n      addListener(viewer, EVENT_WHEEL, (_this._wheel = proxy(_this.wheel, _this)));\n      addListener(_this.canvas, EVENT_MOUSEDOWN, (_this._mousedown = proxy(_this.mousedown, _this)));\n      addListener(document, EVENT_MOUSEMOVE, (_this._mousemove = proxy(_this.mousemove, _this)));\n      addListener(document, EVENT_MOUSEUP, (_this._mouseup = proxy(_this.mouseup, _this)));\n      addListener(document, EVENT_KEYDOWN, (_this._keydown = proxy(_this.keydown, _this)));\n      addListener(window, EVENT_RESIZE, (_this._resize = proxy(_this.resize, _this)));\n    },\n\n    unbind: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer = _this.viewer;\n\n      if (isFunction(options.view)) {\n        removeListener(element, EVENT_VIEW, options.view);\n      }\n\n      if (isFunction(options.viewed)) {\n        removeListener(element, EVENT_VIEWED, options.viewed);\n      }\n\n      removeListener(viewer, EVENT_CLICK, _this._click);\n      removeListener(viewer, EVENT_WHEEL, _this._wheel);\n      removeListener(_this.canvas, EVENT_MOUSEDOWN, _this._mousedown);\n      removeListener(document, EVENT_MOUSEMOVE, _this._mousemove);\n      removeListener(document, EVENT_MOUSEUP, _this._mouseup);\n      removeListener(document, EVENT_KEYDOWN, _this._keydown);\n      removeListener(window, EVENT_RESIZE, _this._resize);\n    },\n\n    render: function () {\n      var _this = this;\n\n      _this.initContainer();\n      _this.initViewer();\n      _this.initList();\n      _this.renderViewer();\n    },\n\n    initContainer: function () {\n      var _this = this;\n\n      _this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n\n    initViewer: function () {\n      var _this = this;\n      var options = _this.options;\n      var parent = _this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        _this.parentData = viewerData = {\n          width: max(parent.offsetWidth, options.minWidth),\n          height: max(parent.offsetHeight, options.minHeight)\n        };\n      }\n\n      if (_this.isFulled || !viewerData) {\n        viewerData = _this.containerData;\n      }\n\n      _this.viewerData = extend({}, viewerData);\n    },\n\n    renderViewer: function () {\n      var _this = this;\n\n      if (_this.options.inline && !_this.isFulled) {\n        setStyle(_this.viewer, _this.viewerData);\n      }\n    },\n\n    initList: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var list = _this.list;\n      var items = [];\n\n      each(_this.images, function (image, i) {\n        var src = image.src;\n        var alt = image.alt || getImageName(src);\n        var url = options.url;\n\n        if (!src) {\n          return;\n        }\n\n        if (isString(url)) {\n          url = image.getAttribute(url);\n        } else if (isFunction(url)) {\n          url = url.call(image, image);\n        }\n\n        items.push(\n          '<li>' +\n            '<img' +\n              ' src=\"' + src + '\"' +\n              ' data-action=\"view\"' +\n              ' data-index=\"' +  i + '\"' +\n              ' data-original-url=\"' +  (url || src) + '\"' +\n              ' alt=\"' +  alt + '\"' +\n            '>' +\n          '</li>'\n        );\n      });\n\n      list.innerHTML = items.join('');\n\n      each(getByTag(list, 'img'), function (image) {\n        setData(image, 'filled', true);\n        addListener(image, EVENT_LOAD, proxy(_this.loadImage, _this), true);\n      });\n\n      _this.items = getByTag(list, 'li');\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, true);\n      }\n    },\n\n    renderList: function (index) {\n      var _this = this;\n      var i = index || _this.index;\n      var width = _this.items[i].offsetWidth || 30;\n      var outerWidth = width + 1; // 1 pixel of `margin-left` width\n\n      // Place the active item in the center of the screen\n      setStyle(_this.list, {\n        width: outerWidth * _this.length,\n        marginLeft: (_this.viewerData.width - width) / 2 - outerWidth * i\n      });\n    },\n\n    resetList: function () {\n      var _this = this;\n\n      empty(_this.list);\n      removeClass(_this.list, CLASS_TRANSITION);\n      setStyle({\n        marginLeft: 0\n      });\n    },\n\n    initImage: function (callback) {\n      var _this = this;\n      var options = _this.options;\n      var image = _this.image;\n      var viewerData = _this.viewerData;\n      var footerHeight = _this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = _this.imageData || {};\n\n      getImageSize(image, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = viewerWidth;\n        var height = viewerHeight;\n        var initialImageData;\n        var imageData;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        width = min(width * 0.9, naturalWidth);\n        height = min(height * 0.9, naturalHeight);\n\n        imageData = {\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight,\n          aspectRatio: aspectRatio,\n          ratio: width / naturalWidth,\n          width: width,\n          height: height,\n          left: (viewerWidth - width) / 2,\n          top: (viewerHeight - height) / 2\n        };\n\n        initialImageData = extend({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this.imageData = imageData;\n        _this.initialImageData = initialImageData;\n\n        if (isFunction(callback)) {\n          callback();\n        }\n      });\n    },\n\n    renderImage: function (callback) {\n      var _this = this;\n      var image = _this.image;\n      var imageData = _this.imageData;\n      var transform = getTransform(imageData);\n\n      setStyle(image, {\n        width: imageData.width,\n        height: imageData.height,\n        marginLeft: imageData.left,\n        marginTop: imageData.top,\n        WebkitTransform: transform,\n        msTransform: transform,\n        transform: transform\n      });\n\n      if (isFunction(callback)) {\n        if (_this.transitioning) {\n          addListener(image, EVENT_TRANSITIONEND, callback, true);\n        } else {\n          callback();\n        }\n      }\n    },\n\n    resetImage: function () {\n      var _this = this;\n\n      // this.image only defined after viewed\n      if (_this.image) {\n        removeChild(_this.image);\n        _this.image = null;\n      }\n    },\n\n    start: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var target = e.target;\n\n      if (target.tagName.toLowerCase() === 'img') {\n        _this.target = target;\n        _this.show();\n      }\n    },\n\n    click: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var target = e.target;\n      var action = getData(target, 'action');\n      var imageData = _this.imageData;\n\n      switch (action) {\n        case 'mix':\n          if (_this.isPlayed) {\n            _this.stop();\n          } else {\n            if (_this.options.inline) {\n              if (_this.isFulled) {\n                _this.exit();\n              } else {\n                _this.full();\n              }\n            } else {\n              _this.hide();\n            }\n          }\n\n          break;\n\n        case 'view':\n          _this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          _this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          _this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          _this.toggle();\n          break;\n\n        case 'reset':\n          _this.reset();\n          break;\n\n        case 'prev':\n          _this.prev();\n          break;\n\n        case 'play':\n          _this.play();\n          break;\n\n        case 'next':\n          _this.next();\n          break;\n\n        case 'rotate-left':\n          _this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          _this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          _this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          _this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (_this.isPlayed) {\n            _this.stop();\n          }\n      }\n    },\n\n    load: function () {\n      var _this = this;\n      var options = _this.options;\n      var image = _this.image;\n      var index = _this.index;\n      var viewerData = _this.viewerData;\n\n      if (_this.timeout) {\n        clearTimeout(_this.timeout);\n        _this.timeout = false;\n      }\n\n      removeClass(image, CLASS_INVISIBLE);\n\n      image.style.cssText = (\n        'width:0;' +\n        'height:0;' +\n        'margin-left:' + viewerData.width / 2 + 'px;' +\n        'margin-top:' + viewerData.height / 2 + 'px;' +\n        'max-width:none!important;' +\n        'visibility:visible;'\n      );\n\n      _this.initImage(function () {\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n        toggleClass(image, CLASS_MOVE, options.movable);\n\n        _this.renderImage(function () {\n          _this.isViewed = true;\n          dispatchEvent(_this.element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          });\n        });\n      });\n    },\n\n    loadImage: function (event) {\n      var e = getEvent(event);\n      var image = e.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n\n      getImageSize(image, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else {\n          if (filled) {\n            height = parentWidth / aspectRatio;\n          } else {\n            width = parentHeight * aspectRatio;\n          }\n        }\n\n        setStyle(image, {\n          width: width,\n          height: height,\n          marginLeft: (parentWidth - width) / 2,\n          marginTop: (parentHeight - height) / 2\n        });\n      });\n    },\n\n    resize: function () {\n      var _this = this;\n\n      _this.initContainer();\n      _this.initViewer();\n      _this.renderViewer();\n      _this.renderList();\n\n      if (_this.isViewed) {\n        _this.initImage(function () {\n          _this.renderImage();\n        });\n      }\n\n      if (_this.isPlayed) {\n        each(getByTag(_this.player, 'img'), function (image) {\n          addListener(image, EVENT_LOAD, proxy(_this.loadImage, _this), true);\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n\n    wheel: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var ratio = Number(_this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (!_this.isViewed) {\n        return;\n      }\n\n      preventDefault(e);\n\n      // Limit wheel speed to prevent zoom too fast\n      if (_this.wheeling) {\n        return;\n      }\n\n      _this.wheeling = true;\n\n      setTimeout(function () {\n        _this.wheeling = false;\n      }, 50);\n\n      if (e.deltaY) {\n        delta = e.deltaY > 0 ? 1 : -1;\n      } else if (e.wheelDelta) {\n        delta = -e.wheelDelta / 120;\n      } else if (e.detail) {\n        delta = e.detail > 0 ? 1 : -1;\n      }\n\n      _this.zoom(-delta * ratio, true, e);\n    },\n\n    keydown: function (event) {\n      var _this = this;\n      var e = getEvent(event);\n      var options = _this.options;\n      var key = e.keyCode || e.which || e.charCode;\n\n      if (!_this.isFulled || !options.keyboard) {\n        return;\n      }\n\n      switch (key) {\n\n        // (Key: Esc)\n        case 27:\n          if (_this.isPlayed) {\n            _this.stop();\n          } else {\n            if (options.inline) {\n              if (_this.isFulled) {\n                _this.exit();\n              }\n            } else {\n              _this.hide();\n            }\n          }\n\n          break;\n\n        // (Key: Space)\n        case 32:\n          if (_this.isPlayed) {\n            _this.stop();\n          }\n\n          break;\n\n        // View previous (Key: ←)\n        case 37:\n          _this.prev();\n          break;\n\n        // Zoom in (Key: ↑)\n        case 38:\n\n          // Prevent scroll on Firefox\n          preventDefault(e);\n\n          _this.zoom(options.zoomRatio, true);\n          break;\n\n        // View next (Key: →)\n        case 39:\n          _this.next();\n          break;\n\n        // Zoom out (Key: ↓)\n        case 40:\n\n          // Prevent scroll on Firefox\n          preventDefault(e);\n\n          _this.zoom(-options.zoomRatio, true);\n          break;\n\n        // Zoom out to initial size (Key: Ctrl + 0)\n        case 48:\n          // Go to next\n\n        // Zoom in to natural size (Key: Ctrl + 1)\n        case 49:\n          if (e.ctrlKey || e.shiftKey) {\n            preventDefault(e);\n            _this.toggle();\n          }\n\n          break;\n\n        // No default\n      }\n    },\n\n    mousedown: function (event) {\n      var _this = this;\n      var options = _this.options;\n      var pointers = _this.pointers;\n      var e = getEvent(event);\n      var action = options.movable ? 'move' : false;\n\n      if (!_this.isViewed) {\n        return;\n      }\n\n      if (e.changedTouches) {\n        each(e.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[e.pointerId || 0] = getPointer(e);\n      }\n\n      if (Object.keys(pointers).length > 1) {\n        action = 'zoom';\n      } else if ((e.pointerType === 'touch' || e.type === 'touchmove') && _this.isSwitchable()) {\n        action = 'switch';\n      }\n\n      _this.action = action;\n    },\n\n    mousemove: function (event) {\n      var _this = this;\n      var options = _this.options;\n      var pointers = _this.pointers;\n      var e = getEvent(event);\n      var action = _this.action;\n      var image = _this.image;\n\n      if (!_this.isViewed || !action) {\n        return;\n      }\n\n      preventDefault(e);\n\n      if (e.changedTouches) {\n        each(e.changedTouches, function (touch) {\n          extend(pointers[touch.identifier], getPointer(touch), true);\n        });\n      } else {\n        extend(pointers[e.pointerId || 0], getPointer(e, true));\n      }\n\n      if (action === 'move' && options.transition && hasClass(image, CLASS_TRANSITION)) {\n        removeClass(image, CLASS_TRANSITION);\n      }\n\n      _this.change(e);\n    },\n\n    mouseup: function (event) {\n      var _this = this;\n      var pointers = _this.pointers;\n      var e = getEvent(event);\n      var action = _this.action;\n\n      if (!action) {\n        return;\n      }\n\n      if (e.changedTouches) {\n        each(e.changedTouches, function (touch) {\n          delete pointers[touch.identifier];\n        });\n      } else {\n        delete pointers[e.pointerId || 0];\n      }\n\n      if (!Object.keys(pointers).length) {\n        if (action === 'move' && _this.options.transition) {\n          addClass(_this.image, CLASS_TRANSITION);\n        }\n\n        _this.action = false;\n      }\n    },\n\n    // Show the viewer (only available in modal mode)\n    show: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer;\n\n      if (options.inline || _this.transitioning) {\n        return _this;\n      }\n\n      if (!_this.isBuilt) {\n        _this.build();\n      }\n\n      viewer = _this.viewer;\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, true);\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false) {\n        return _this;\n      }\n\n      _this.open();\n      removeClass(viewer, CLASS_HIDE);\n\n      addListener(element, EVENT_SHOWN, function () {\n        _this.view(_this.target ? inArray(_this.target, toArray(_this.images)) : _this.index);\n        _this.target = false;\n      }, true);\n\n      if (options.transition) {\n        _this.transitioning = true;\n        addClass(viewer, CLASS_TRANSITION);\n        forceReflow(viewer);\n        addListener(viewer, EVENT_TRANSITIONEND, proxy(_this.shown, _this), true);\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        _this.shown();\n      }\n\n      return _this;\n    },\n\n    // Hide the viewer (only available in modal mode)\n    hide: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n      var viewer = _this.viewer;\n\n      if (options.inline || _this.transitioning || !_this.isShown) {\n        return _this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, true);\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return _this;\n      }\n\n      if (_this.isViewed && options.transition) {\n        _this.transitioning = true;\n        addListener(_this.image, EVENT_TRANSITIONEND, function () {\n          addListener(viewer, EVENT_TRANSITIONEND, proxy(_this.hidden, _this), true);\n          removeClass(viewer, CLASS_IN);\n        }, true);\n        _this.zoomTo(0, false, false, true);\n      } else {\n        removeClass(viewer, CLASS_IN);\n        _this.hidden();\n      }\n\n      return _this;\n    },\n\n    /**\n     * View one of the images with image's index\n     *\n     * @param {Number} index\n     */\n    view: function (index) {\n      var _this = this;\n      var element = _this.element;\n      var title = _this.title;\n      var canvas = _this.canvas;\n      var image;\n      var item;\n      var img;\n      var url;\n      var alt;\n\n      index = Number(index) || 0;\n\n      if (!_this.isShown || _this.isPlayed || index < 0 || index >= _this.length ||\n        _this.isViewed && index === _this.index) {\n        return _this;\n      }\n\n      item = _this.items[index];\n      img = getByTag(item, 'img')[0];\n      url = getData(img, 'originalUrl');\n      alt = img.getAttribute('alt');\n\n      image = document.createElement('img');\n      image.src = url;\n      image.alt = alt;\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: _this.images[index],\n        index: index,\n        image: image\n      }) === false) {\n        return _this;\n      }\n\n      _this.image = image;\n\n      if (_this.isViewed) {\n        removeClass(_this.items[_this.index], CLASS_ACTIVE);\n      }\n\n      addClass(item, CLASS_ACTIVE);\n\n      _this.isViewed = false;\n      _this.index = index;\n      _this.imageData = null;\n\n      addClass(image, CLASS_INVISIBLE);\n      empty(canvas);\n      appendChild(canvas, image);\n\n      // Center current item\n      _this.renderList();\n\n      // Clear title\n      empty(title);\n\n      // Generate title after viewed\n      addListener(element, EVENT_VIEWED, function () {\n        var imageData = _this.imageData;\n        var width = imageData.naturalWidth;\n        var height = imageData.naturalHeight;\n\n        setText(title, alt + ' (' + width + ' × ' + height + ')');\n      }, true);\n\n      if (image.complete) {\n        _this.load();\n      } else {\n        addListener(image, EVENT_LOAD, proxy(_this.load, _this), true);\n\n        if (_this.timeout) {\n          clearTimeout(_this.timeout);\n        }\n\n        // Make the image visible if it fails to load within 1s\n        _this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this.timeout = false;\n        }, 1000);\n      }\n\n      return _this;\n    },\n\n    // View the previous image\n    prev: function () {\n      var _this = this;\n\n      _this.view(max(_this.index - 1, 0));\n\n      return _this;\n    },\n\n    // View the next image\n    next: function () {\n      var _this = this;\n\n      _this.view(min(_this.index + 1, _this.length - 1));\n\n      return _this;\n    },\n\n    /**\n     * Move the image with relative offsets\n     *\n     * @param {Number} offsetX\n     * @param {Number} offsetY (optional)\n     */\n    move: function (offsetX, offsetY) {\n      var _this = this;\n      var imageData = _this.imageData;\n\n      _this.moveTo(\n        isUndefined(offsetX) ? offsetX : imageData.left + Number(offsetX),\n        isUndefined(offsetY) ? offsetY : imageData.top + Number(offsetY)\n      );\n\n      return _this;\n    },\n\n    /**\n     * Move the image to an absolute point\n     *\n     * @param {Number} x\n     * @param {Number} y (optional)\n     */\n    moveTo: function (x, y) {\n      var _this = this;\n      var imageData = _this.imageData;\n      var changed = false;\n\n      // If \"y\" is not present, its default value is \"x\"\n      if (isUndefined(y)) {\n        y = x;\n      }\n\n      x = Number(x);\n      y = Number(y);\n\n      if (_this.isViewed && !_this.isPlayed && _this.options.movable) {\n        if (isNumber(x)) {\n          imageData.left = x;\n          changed = true;\n        }\n\n        if (isNumber(y)) {\n          imageData.top = y;\n          changed = true;\n        }\n\n        if (changed) {\n          _this.renderImage();\n        }\n      }\n\n      return _this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio\n     *\n     * @param {Number} ratio\n     * @param {Boolean} hasTooltip (optional)\n     * @param {Event} _originalEvent (private)\n     */\n    zoom: function (ratio, hasTooltip, _originalEvent) {\n      var _this = this;\n      var imageData = _this.imageData;\n\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio =  1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      _this.zoomTo(imageData.width * ratio / imageData.naturalWidth, hasTooltip, _originalEvent);\n\n      return _this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio\n     *\n     * @param {Number} ratio\n     * @param {Boolean} hasTooltip (optional)\n     * @param {Event} _originalEvent (private)\n     * @param {Boolean} _zoomable (private)\n     */\n    zoomTo: function (ratio, hasTooltip, _originalEvent, _zoomable) {\n      var _this = this;\n      var options = _this.options;\n      var pointers = _this.pointers;\n      var minZoomRatio = 0.01;\n      var maxZoomRatio = 100;\n      var imageData = _this.imageData;\n      var newWidth;\n      var newHeight;\n      var offset;\n      var center;\n\n      ratio = max(0, ratio);\n\n      if (isNumber(ratio) && _this.isViewed && !_this.isPlayed && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          minZoomRatio = max(minZoomRatio, options.minZoomRatio);\n          maxZoomRatio = min(maxZoomRatio, options.maxZoomRatio);\n          ratio = min(max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (ratio > 0.95 && ratio < 1.05) {\n          ratio = 1;\n        }\n\n        newWidth = imageData.naturalWidth * ratio;\n        newHeight = imageData.naturalHeight * ratio;\n\n        if (_originalEvent) {\n          offset = getOffset(_this.viewer);\n          center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          };\n\n          // Zoom from the triggering point of the event\n          imageData.left -= (newWidth - imageData.width) * (\n            ((center.pageX - offset.left) - imageData.left) / imageData.width\n          );\n          imageData.top -= (newHeight - imageData.height) * (\n            ((center.pageY - offset.top) - imageData.top) / imageData.height\n          );\n        } else {\n\n          // Zoom from the center of the image\n          imageData.left -= (newWidth - imageData.width) / 2;\n          imageData.top -= (newHeight - imageData.height) / 2;\n        }\n\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.ratio = ratio;\n        _this.renderImage();\n\n        if (hasTooltip) {\n          _this.tooltip();\n        }\n      }\n\n      return _this;\n    },\n\n    /**\n     * Rotate the image with a relative degree\n     *\n     * @param {Number} degree\n     */\n    rotate: function (degree) {\n      var _this = this;\n\n      _this.rotateTo((_this.imageData.rotate || 0) + Number(degree));\n\n      return _this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree\n     * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#rotate()\n     *\n     * @param {Number} degree\n     */\n    rotateTo: function (degree) {\n      var _this = this;\n      var imageData = _this.imageData;\n\n      degree = Number(degree);\n\n      if (isNumber(degree) && _this.isViewed && !_this.isPlayed && _this.options.rotatable) {\n        imageData.rotate = degree;\n        _this.renderImage();\n      }\n\n      return _this;\n    },\n\n    /**\n     * Scale the image\n     * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#scale()\n     *\n     * @param {Number} scaleX\n     * @param {Number} scaleY (optional)\n     */\n    scale: function (scaleX, scaleY) {\n      var _this = this;\n      var imageData = _this.imageData;\n      var changed = false;\n\n      // If \"scaleY\" is not present, its default value is \"scaleX\"\n      if (isUndefined(scaleY)) {\n        scaleY = scaleX;\n      }\n\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (_this.isViewed && !_this.isPlayed && _this.options.scalable) {\n        if (isNumber(scaleX)) {\n          imageData.scaleX = scaleX;\n          changed = true;\n        }\n\n        if (isNumber(scaleY)) {\n          imageData.scaleY = scaleY;\n          changed = true;\n        }\n\n        if (changed) {\n          _this.renderImage();\n        }\n      }\n\n      return _this;\n    },\n\n    /**\n     * Scale the abscissa of the image\n     *\n     * @param {Number} scaleX\n     */\n    scaleX: function (scaleX) {\n      var _this = this;\n\n      _this.scale(scaleX, _this.imageData.scaleY);\n\n      return _this;\n    },\n\n    /**\n     * Scale the ordinate of the image\n     *\n     * @param {Number} scaleY\n     */\n    scaleY: function (scaleY) {\n      var _this = this;\n\n      _this.scale(_this.imageData.scaleX, scaleY);\n\n      return _this;\n    },\n\n    // Play the images\n    play: function () {\n      var _this = this;\n      var options = _this.options;\n      var player = _this.player;\n      var load = proxy(_this.loadImage, _this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      var playing;\n\n      if (!_this.isShown || _this.isPlayed) {\n        return _this;\n      }\n\n      if (options.fullscreen) {\n        _this.requestFullscreen();\n      }\n\n      _this.isPlayed = true;\n      addClass(player, CLASS_SHOW);\n\n      each(_this.items, function (item, i) {\n        var img = getByTag(item, 'img')[0];\n        var image = document.createElement('img');\n\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        total++;\n\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, load, true);\n        appendChild(player, image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        playing = function () {\n          _this.playing = setTimeout(function () {\n            removeClass(list[index], CLASS_IN);\n            index++;\n            index = index < total ? index : 0;\n            addClass(list[index], CLASS_IN);\n\n            playing();\n          }, options.interval);\n        };\n\n        if (total > 1) {\n          playing();\n        }\n      }\n\n      return _this;\n    },\n\n    // Stop play\n    stop: function () {\n      var _this = this;\n      var player = _this.player;\n\n      if (!_this.isPlayed) {\n        return _this;\n      }\n\n      if (_this.options.fullscreen) {\n        _this.exitFullscreen();\n      }\n\n      _this.isPlayed = false;\n      clearTimeout(_this.playing);\n      removeClass(player, CLASS_SHOW);\n      empty(player);\n\n      return _this;\n    },\n\n    // Enter modal mode (only available in inline mode)\n    full: function () {\n      var _this = this;\n      var options = _this.options;\n      var viewer = _this.viewer;\n      var image = _this.image;\n      var list = _this.list;\n\n      if (!_this.isShown || _this.isPlayed || _this.isFulled || !options.inline) {\n        return _this;\n      }\n\n      _this.isFulled = true;\n      _this.open();\n      addClass(_this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(image, CLASS_TRANSITION);\n        removeClass(list, CLASS_TRANSITION);\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('style', '');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n\n      _this.initContainer();\n      _this.viewerData = extend({}, _this.containerData);\n      _this.renderList();\n      _this.initImage(function () {\n        _this.renderImage(function () {\n          if (options.transition) {\n            setTimeout(function () {\n              addClass(image, CLASS_TRANSITION);\n              addClass(list, CLASS_TRANSITION);\n            }, 0);\n          }\n        });\n      });\n\n      return _this;\n    },\n\n    // Exit modal mode (only available in inline mode)\n    exit: function () {\n      var _this = this;\n      var options = _this.options;\n      var viewer = _this.viewer;\n      var image = _this.image;\n      var list = _this.list;\n\n      if (!_this.isFulled) {\n        return _this;\n      }\n\n      _this.isFulled = false;\n      _this.close();\n      removeClass(_this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(image, CLASS_TRANSITION);\n        removeClass(list, CLASS_TRANSITION);\n      }\n\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n\n      _this.viewerData = extend({}, _this.parentData);\n      _this.renderViewer();\n      _this.renderList();\n      _this.initImage(function () {\n        _this.renderImage(function () {\n          if (options.transition) {\n            setTimeout(function () {\n              addClass(image, CLASS_TRANSITION);\n              addClass(list, CLASS_TRANSITION);\n            }, 0);\n          }\n        });\n      });\n\n      return _this;\n    },\n\n    // Show the current ratio of the image with percentage\n    tooltip: function () {\n      var _this = this;\n      var options = _this.options;\n      var tooltipBox = _this.tooltipBox;\n      var imageData = _this.imageData;\n\n      if (!_this.isViewed || _this.isPlayed || !options.tooltip) {\n        return _this;\n      }\n\n      setText(tooltipBox, round(imageData.ratio * 100) + '%');\n\n      if (!_this.tooltiping) {\n        if (options.transition) {\n          if (_this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITIONEND);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION);\n          forceReflow(tooltipBox);\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n        }\n      } else {\n        clearTimeout(_this.tooltiping);\n      }\n\n      _this.tooltiping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITIONEND, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            _this.fading = false;\n          }, true);\n\n          removeClass(tooltipBox, CLASS_IN);\n          _this.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n        }\n\n        _this.tooltiping = false;\n      }, 1000);\n\n      return _this;\n    },\n\n    // Toggle the image size between its natural size and initial size\n    toggle: function () {\n      var _this = this;\n\n      if (_this.imageData.ratio === 1) {\n        _this.zoomTo(_this.initialImageData.ratio, true);\n      } else {\n        _this.zoomTo(1, true);\n      }\n\n      return _this;\n    },\n\n    // Reset the image to its initial state\n    reset: function () {\n      var _this = this;\n\n      if (_this.isViewed && !_this.isPlayed) {\n        _this.imageData = extend({}, _this.initialImageData);\n        _this.renderImage();\n      }\n\n      return _this;\n    },\n\n    // Update viewer when images changed\n    update: function () {\n      var _this = this;\n      var indexes = [];\n      var index;\n\n      // Destroy viewer if the target image was deleted\n      if (_this.isImg && !_this.element.parentNode) {\n        return _this.destroy();\n      }\n\n      _this.length = _this.images.length;\n\n      if (_this.isBuilt) {\n        each(_this.items, function (item, i) {\n          var img = getByTag(item, 'img')[0];\n          var image = _this.images[i];\n\n          if (image) {\n            if (image.src !== img.src) {\n              indexes.push(i);\n            }\n          } else {\n            indexes.push(i);\n          }\n        });\n\n        setStyle(_this.list, {\n          width: 'auto'\n        });\n\n        _this.initList();\n\n        if (_this.isShown) {\n          if (_this.length) {\n            if (_this.isViewed) {\n              index = inArray(_this.index, indexes);\n\n              if (index >= 0) {\n                _this.isViewed = false;\n                _this.view(max(_this.index - (index + 1), 0));\n              } else {\n                addClass(_this.items[_this.index], CLASS_ACTIVE);\n              }\n            }\n          } else {\n            _this.image = null;\n            _this.isViewed = false;\n            _this.index = 0;\n            _this.imageData = null;\n            empty(_this.canvas);\n            empty(_this.title);\n          }\n        }\n      }\n\n      return _this;\n    },\n\n    // Destroy the viewer\n    destroy: function () {\n      var _this = this;\n      var element = _this.element;\n\n      if (_this.options.inline) {\n        _this.unbind();\n      } else {\n        if (_this.isShown) {\n          _this.unbind();\n        }\n\n        removeListener(element, EVENT_CLICK, _this._start);\n      }\n\n      _this.unbuild();\n      removeData(element, NAMESPACE);\n\n      return _this;\n    },\n\n    open: function () {\n      var body = this.body;\n\n      addClass(body, CLASS_OPEN);\n      body.style.paddingRight = this.scrollbarWidth + 'px';\n    },\n\n    close: function () {\n      var body = this.body;\n\n      removeClass(body, CLASS_OPEN);\n      body.style.paddingRight = 0;\n    },\n\n    shown: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n\n      _this.transitioning = false;\n      _this.isFulled = true;\n      _this.isShown = true;\n      _this.isVisible = true;\n      _this.render();\n      _this.bind();\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, true);\n      }\n\n      dispatchEvent(element, EVENT_SHOWN);\n    },\n\n    hidden: function () {\n      var _this = this;\n      var options = _this.options;\n      var element = _this.element;\n\n      _this.transitioning = false;\n      _this.isViewed = false;\n      _this.isFulled = false;\n      _this.isShown = false;\n      _this.isVisible = false;\n      _this.unbind();\n      _this.close();\n      addClass(_this.viewer, CLASS_HIDE);\n      _this.resetList();\n      _this.resetImage();\n\n      if (isFunction(options.hidden)) {\n        addListener(element, EVENT_HIDDEN, options.hidden, true);\n      }\n\n      dispatchEvent(element, EVENT_HIDDEN);\n    },\n\n    requestFullscreen: function () {\n      var _this = this;\n      var documentElement = document.documentElement;\n\n      if (_this.isFulled && !document.fullscreenElement && !document.mozFullScreenElement &&\n        !document.webkitFullscreenElement && !document.msFullscreenElement) {\n\n        if (documentElement.requestFullscreen) {\n          documentElement.requestFullscreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        }\n      }\n    },\n\n    exitFullscreen: function () {\n      var _this = this;\n\n      if (_this.isFulled) {\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    },\n\n    change: function (e) {\n      var _this = this;\n      var pointers = _this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]];\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (_this.action) {\n\n        // Move the current image\n        case 'move':\n          _this.move(offsetX, offsetY);\n          break;\n\n        // Zoom the current image\n        case 'zoom':\n          _this.zoom(getMaxZoomRatio(pointers), false, e);\n          break;\n\n        case 'switch':\n          _this.action = 'switched';\n\n          if (abs(offsetX) > abs(offsetY)) {\n            if (offsetX > 1) {\n              _this.prev();\n            } else if (offsetX < -1) {\n              _this.next();\n            }\n          }\n\n          break;\n\n        // No default\n      }\n\n      // Override\n      each(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n\n    isSwitchable: function () {\n      var _this = this;\n      var imageData = _this.imageData;\n      var viewerData = _this.viewerData;\n\n      return _this.length > 1 && imageData.left >= 0 && imageData.top >= 0 &&\n        imageData.width <= viewerData.width &&\n        imageData.height <= viewerData.height;\n    }\n  };\n\n  Viewer.DEFAULTS = {\n\n    // Enable inline mode\n    inline: false,\n\n    // Show the button on the top-right of the viewer\n    button: true,\n\n    // Show the navbar\n    navbar: true,\n\n    // Show the title\n    title: true,\n\n    // Show the toolbar\n    toolbar: true,\n\n    // Show the tooltip with image ratio (percentage) when zoom in or zoom out\n    tooltip: true,\n\n    // Enable to move the image\n    movable: true,\n\n    // Enable to zoom the image\n    zoomable: true,\n\n    // Enable to rotate the image\n    rotatable: true,\n\n    // Enable to scale the image\n    scalable: true,\n\n    // Enable CSS3 Transition for some special elements\n    transition: true,\n\n    // Enable to request fullscreen when play\n    fullscreen: true,\n\n    // Enable keyboard support\n    keyboard: true,\n\n    // Define interval of each image when playing\n    interval: 5000,\n\n    // Min width of the viewer in inline mode\n    minWidth: 200,\n\n    // Min height of the viewer in inline mode\n    minHeight: 100,\n\n    // Define the ratio when zoom the image by wheeling mouse\n    zoomRatio: 0.1,\n\n    // Define the min ratio of the image when zoom out\n    minZoomRatio: 0.01,\n\n    // Define the max ratio of the image when zoom in\n    maxZoomRatio: 100,\n\n    // Define the CSS `z-index` value of viewer in modal mode.\n    zIndex: 2015,\n\n    // Define the CSS `z-index` value of viewer in inline mode.\n    zIndexInline: 0,\n\n    // Define where to get the original image URL for viewing\n    // Type: String (an image attribute) or Function (should return an image URL)\n    url: 'src',\n\n    // Event shortcuts\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null\n  };\n\n  Viewer.TEMPLATE = (\n    '<div class=\"viewer-container\">' +\n      '<div class=\"viewer-canvas\"></div>' +\n      '<div class=\"viewer-footer\">' +\n        '<div class=\"viewer-title\"></div>' +\n        '<ul class=\"viewer-toolbar\">' +\n          '<li class=\"viewer-zoom-in\" data-action=\"zoom-in\"></li>' +\n          '<li class=\"viewer-zoom-out\" data-action=\"zoom-out\"></li>' +\n          '<li class=\"viewer-one-to-one\" data-action=\"one-to-one\"></li>' +\n          '<li class=\"viewer-reset\" data-action=\"reset\"></li>' +\n          '<li class=\"viewer-prev\" data-action=\"prev\"></li>' +\n          '<li class=\"viewer-play\" data-action=\"play\"></li>' +\n          '<li class=\"viewer-next\" data-action=\"next\"></li>' +\n          '<li class=\"viewer-rotate-left\" data-action=\"rotate-left\"></li>' +\n          '<li class=\"viewer-rotate-right\" data-action=\"rotate-right\"></li>' +\n          '<li class=\"viewer-flip-horizontal\" data-action=\"flip-horizontal\"></li>' +\n          '<li class=\"viewer-flip-vertical\" data-action=\"flip-vertical\"></li>' +\n        '</ul>' +\n        '<div class=\"viewer-navbar\">' +\n          '<ul class=\"viewer-list\"></ul>' +\n        '</div>' +\n      '</div>' +\n      '<div class=\"viewer-tooltip\"></div>' +\n      '<div class=\"viewer-button\" data-action=\"mix\"></div>' +\n      '<div class=\"viewer-player\"></div>' +\n    '</div>'\n  );\n\n  var _Viewer = window.Viewer;\n\n  Viewer.noConflict = function () {\n    window.Viewer = _Viewer;\n    return Viewer;\n  };\n\n  Viewer.setDefaults = function (options) {\n    extend(Viewer.DEFAULTS, options);\n  };\n\n  if (typeof define === 'function' && define.amd) {\n    define('viewer', [], function () {\n      return Viewer;\n    });\n  }\n\n  if (!noGlobal) {\n    window.Viewer = Viewer;\n  }\n\n  return Viewer;\n\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/www/blogstep/~/viewerjs/dist/viewer.js\n// module id = 22\n// module chunks = 3","/*\n * BlogSTEP \n * Copyright (c) 2017 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = require('jquery');\nvar paths = require('./common/paths');\n\nrequire('viewerjs/dist/viewer.min.css');\n\nvar Viewer = require('viewerjs');\n\nBLOGSTEP.init('viewer', function (app) {\n    var $viewer = app.frame.find('#viewer');\n    var viewer = null;\n    var first = true;\n    \n    var menu = app.addMenu('Viewer');\n    menu.addItem('Close', 'close');\n    \n    app.onOpen = function (app, args) {\n\tapp.setTitle(args.path + ' – Viewer');\n\tfirst = true;\n\tBLOGSTEP.get('list-files', { path: paths.dirName(args.path) }).done(function (data) {\n\t    for (var i = 0; i < data.files.length; i++) {\n\t\tif (data.files[i].name.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n\t\t    var $img = $('<img/>');\n\t\t    $img.attr('src', BLOGSTEP.PATH + '/api/download?path=' + data.files[i].path);\n\t\t    $img.attr('alt', data.files[i].name);\n\t\t    $img.data('path', data.files[i].path);\n\t\t    if (data.files[i].path === args.path) {\n\t\t\t$img.addClass('active');\n\t\t    }\n\t\t    $viewer.append($img);\n\t\t}\n\t    }\n\t    \n\t    viewer = new Viewer($viewer[0], {\n\t\tinline: true,\n\t\tviewed: function (e) {\n\t\t    if (first) {\n\t\t\tviewer.view($viewer.children('.active').index());\n\t\t\tfirst = false;\n\t\t\te.stopPropagation();\n\t\t\treturn false;\n\t\t    }\n\t\t    $viewer.find('img.active').removeClass('active');\n\t\t    var $image = $(e.detail.originalImage);\n\t\t    $image.addClass('active');\n\t\t    app.setTitle($image.data('path') + ' – Viewer');\n\t\t}\n\t    });\n\t});\n    };\n    \n    app.onClose = function (app) {\n\tviewer.destroy();\n\t$viewer.empty();\n    };\n});\n\n\n// WEBPACK FOOTER //\n// ./viewer.js"],"sourceRoot":""}
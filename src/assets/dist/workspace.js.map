{"version":3,"sources":["webpack:///dist/workspace.js","webpack:///./common/paths.js?9de7***","webpack:///./common/ui.js?8332**","webpack:///./workspace.js","webpack:////home/www/blogstep/~/js-cookie/src/js.cookie.js?cd36**"],"names":["webpackJsonp","2","module","exports","__webpack_require__","dirName","path","replace","fileName","convert","cwd","trim","startsWith","names","split","stack","i","length","pop","push","join","3","$","Cookies","ajaxSetup","headers","X-Csrf-Token","get","shake","el","amount","dbl","width","animate","marginLeft","queue","css","finish","onLongPress","callback","touching","start","e","end","addEventListener","setProgress","progress","status","bar","children","label","Math","floor","className","style","innerText","handleLogin","done","data","find","prop","show","submit","this","ajax","url","method","username","val","password","remember","is","success","overflow","whiteSpace","hide","off","error","xhr","select","global","handleError","event","settings","thrownError","newToken","focus","responseJSON","alert","message","responseText","console","log","33","Menu","app","title","frame","header","itemList","text","Dialog","parent","deferred","overlay","appendTo","head","body","App","name","state","args","dockFrame","actions","actionGroups","keyMap","menus","toolFrames","onInit","onSuspend","onResume","onOpen","onReopen","onFocus","onKeydown","onUnfocus","onClose","onResize","isUnsaved","load","dfr","Deferred","apps","hasOwnProperty","resolve","then","reject","BLOGSTEP","$doc","html","$styles","$scripts","each","$dockFrame","first","attr","PATH","click","restore","append","getScript","fail","promise","post","ui","paths","window","tasks","running","skipHistory","previousTitle","prototype","addItem","action","button","activate","item","key","setTitle","open","close","result","detach","dialog","footer","okButton","keydown","confirm","choices","arguments","undefined","defaultChoice","defaultButton","prompt","value","content","input","setSelectionRange","addMenu","menu","defaultPrevented","isDialogOpen","ctrlKey","altKey","shiftKey","metaKey","toUpperCase","preventDefault","bindKey","parts","toLowerCase","defineAction","groups","stopPropagation","forEach","group","apply","enableGroup","enableAction","disableGroup","disableAction","document","setArgs","isEmptyObject","param","history","pushState","init","prepend","addClass","kill","removeClass","resume","reopen","suspend","index","indexOf","splice","getTasks","Object","values","run","match","type","getToken","addToken","setRequestHeader","responseType","dataType","jqXhr","textStatus","errorThrown","Array","slice","call","rejectWith","ready","location","reload","on","toggleClass","hasClass","selector","resize","onpopstate","onbeforeunload","4","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","factory","registeredInModuleLoader","OldCookies","api","noConflict","extend","attributes","converter","defaults","expires","Date","setMilliseconds","getMilliseconds","toUTCString","JSON","stringify","test","write","encodeURIComponent","String","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","cookies","rdecode","json","charAt","read","parse","set","getJSON","remove","withConverter"],"mappings":"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","file":"dist/workspace.js","sourcesContent":["webpackJsonp([4],{\n\n/***/ 2:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path) {\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path) {\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd) {\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n/***/ }),\n\n/***/ 3:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar Cookies = __webpack_require__(4);\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width()).animate({ marginLeft: '+=' + amount }, 50).animate({ marginLeft: '-=' + dbl }, 50).animate({ marginLeft: '+=' + dbl }, 50).animate({ marginLeft: '-=' + amount }, 50).queue(function () {\n        $(el).css('width', '').css('margin-left', '').finish();\n    });\n};\n\nexports.onLongPress = function (el, callback) {\n    var touching = false;\n\n    var start = function start(e) {\n        touching = true;\n    };\n\n    var end = function end(e) {\n        touching = false;\n    };\n\n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function (el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function success() {\n                $('#login-frame').css({ overflow: 'hidden', whiteSpace: 'no-wrap' }).animate({ width: 0 }, function () {\n                    $(this).hide().css({ overflow: '', whiteSpace: '', width: '' });\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function error(xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n        if ($('#login-username').val() === '') {\n            $('#login-username').focus();\n        } else {\n            $('#login-password').focus();\n        }\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n/***/ }),\n\n/***/ 33:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar Cookies = __webpack_require__(4);\nvar ui = __webpack_require__(3);\nvar paths = __webpack_require__(2);\n\nwindow.BLOGSTEP = {};\n\nwindow.BLOGSTEP.ui = ui;\nwindow.BLOGSTEP.paths = paths;\n\nvar apps = {};\n\nvar tasks = [];\nvar running = null;\nvar skipHistory = false;\nvar previousTitle = null;\n\nfunction Menu(app, title) {\n    this.app = app;\n    this.title = title;\n    this.frame = $('<div><header></header><nav><ul></ul></div>');\n    this.header = this.frame.find('header');\n    this.itemList = this.frame.find('ul');\n    this.header.text(title);\n}\n\nMenu.prototype.addItem = function (label, action) {\n    var button = $('<button/>');\n    button.text(label);\n    if (typeof action === 'string') {\n        button.attr('data-action', action);\n    }\n    var app = this.app;\n    button.click(function () {\n        app.activate(action);\n    });\n    var item = $('<li>');\n    item.append(button);\n    for (var key in this.app.keyMap) {\n        if (this.app.keyMap.hasOwnProperty(key) && this.app.keyMap[key] === action) {\n            button.append('<span class=\"shortcut\">' + key + '</span>');\n        }\n    }\n    this.itemList.append(item);\n};\n\nfunction Dialog(parent) {\n    this.deferred = null;\n    this.parent = parent;\n    this.overlay = $('<div class=\"dialog-overlay\">');\n    this.frame = $('<div class=\"frame\">').appendTo(this.overlay);\n    this.head = $('<div class=\"frame-head\">').appendTo(this.frame);\n    this.body = $('<form class=\"frame-body\">').appendTo(this.frame);\n    $('<div class=\"frame-title\">').appendTo(this.head);\n};\n\nDialog.prototype.setTitle = function (title) {\n    this.head.find('.frame-title').text(title);\n};\n\nDialog.prototype.open = function () {\n    this.deferred = $.Deferred();\n    if (this.parent.children('.dialog-overlay').length > 0) {\n        // TODO: what to do? queue or something else?\n        this.deferred.reject();\n    } else {\n        this.overlay.appendTo(this.parent);\n    }\n    return this.deferred.promise();\n};\n\nDialog.prototype.close = function (result) {\n    this.overlay.detach();\n    this.deferred.resolve(result);\n};\n\nDialog.alert = function (parent, title, message) {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var okButton = $('<button>').text('OK').appendTo(footer);\n    okButton.click(function () {\n        dialog.close();\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    okButton.focus();\n    return dfr;\n};\n\nDialog.confirm = function (parent, title, message) {\n    var choices = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : ['OK', 'Cancel'];\n    var defaultChoice = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'OK';\n\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var defaultButton = null;\n    for (var i = 0; i < choices.length; i++) {\n        footer.append(' ');\n        var button = $('<button>').text(choices[i]).appendTo(footer);\n        button.click(function () {\n            dialog.close($(this).text());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n        if (choices[i] === defaultChoice) {\n            defaultButton = button;\n        }\n    }\n    var dfr = dialog.open();\n    if (defaultButton !== null) {\n        defaultButton.focus();\n    }\n    return dfr;\n};\n\nDialog.prompt = function (parent, title, message) {\n    var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    var content = $('<div class=\"frame-content\">').appendTo(dialog.body);\n    $('<div>').text(message).appendTo(content);\n    var input = $('<input type=\"text\">').appendTo(content);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    dialog.body.submit(function (e) {\n        dialog.close(input.val());\n    });\n    input.keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    $('<input type=\"submit\">').text('OK').appendTo(footer).click(function () {\n        dialog.close(input.val());\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    footer.append(' ');\n    $('<button>').text('Cancel').appendTo(footer).click(function () {\n        dialog.close(null);\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    input.focus();\n    if (value.length > 0) {\n        input.val(value);\n        input[0].setSelectionRange(0, value.length);\n    }\n    return dfr;\n};\n\nfunction App(name) {\n    this.name = name;\n    this.title = '';\n    this.state = 'loading';\n    this.deferred = null;\n    this.args = null;\n    this.frame = null;\n    this.head = null;\n    this.body = null;\n    this.dockFrame = null;\n    this.actions = {};\n    this.actionGroups = {};\n    this.keyMap = {};\n    this.menus = [];\n    this.toolFrames = {};\n    this.onInit = null;\n    this.onSuspend = null;\n    this.onResume = null;\n    this.onOpen = null;\n    this.onReopen = null;\n    this.onFocus = null;\n    this.onKeydown = null;\n    this.onUnfocus = null;\n    this.onClose = null;\n    this.onResize = null;\n    this.isUnsaved = null;\n}\n\nApp.prototype.addMenu = function (title) {\n    var menu = new Menu(this, title);\n    this.menus.push(menu);\n    return menu;\n};\n\nApp.prototype.alert = function (title, message) {\n    return Dialog.alert(this.body, title, message);\n};\n\nApp.prototype.confirm = function (title, message, choices, defaultChoice) {\n    return Dialog.confirm(this.body, title, message, choices, defaultChoice);\n};\n\nApp.prototype.prompt = function (title, message, value) {\n    return Dialog.prompt(this.body, title, message, value);\n};\n\nApp.prototype.keydown = function (e) {\n    if (e.defaultPrevented || this.isDialogOpen()) {\n        return;\n    }\n    if (this.onKeydown !== null) {\n        if (!this.onKeydown(e)) {\n            return false;\n        }\n    }\n    var key = '';\n    if (e.ctrlKey) {\n        key += 'Ctrl+';\n    }\n    if (e.altKey) {\n        key += 'Alt+';\n    }\n    if (e.shiftKey) {\n        key += 'Shift+';\n    }\n    if (e.metaKey) {\n        key += 'Meta+';\n    }\n    key += e.key.toUpperCase();\n    if (this.keyMap.hasOwnProperty(key)) {\n        e.preventDefault();\n        this.activate(this.keyMap[key]);\n        return false;\n    }\n};\n\nApp.prototype.bindKey = function (key, action) {\n    var parts = key.toLowerCase().split(/-|\\+/);\n    var e = { ctrlKey: '', altKey: '', shiftKey: '' };\n    var key = parts[parts.length - 1];\n    for (var i = 0; i < parts.length - 1; i++) {\n        switch (parts[i]) {\n            case 'c':\n                e.ctrlKey = 'Ctrl+';\n                break;\n            case 'a':\n                e.altKey = 'Alt+';\n                break;\n            case 's':\n                e.shiftKey = 'Shift+';\n                break;\n            case 'm':\n                e.metaKey = 'Meta+';\n                break;\n        }\n    }\n    key = e.ctrlKey + e.altKey + e.shiftKey + key.toUpperCase();\n    this.keyMap[key] = action;\n};\n\nApp.prototype.defineAction = function (name, callback, groups) {\n    var app = this;\n    this.actions[name] = callback;\n    this.frame.find('[data-action=\"' + name + '\"]').click(function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        app.activate(name);\n        return false;\n    });\n    if (typeof groups !== 'undefined') {\n        groups.forEach(function (group) {\n            if (!this.actionGroups.hasOwnProperty(group)) {\n                this.actionGroups[group] = [];\n            }\n            this.actionGroups[group].push(name);\n        }, this);\n    }\n};\n\nApp.prototype.activate = function (name) {\n    if (typeof name === 'string') {\n        this.actions[name].apply(this, [name]);\n    } else {\n        name.apply(this);\n    }\n};\n\nApp.prototype.isDialogOpen = function () {\n    return this.body.children('.dialog-overlay').length > 0;\n};\n\nApp.prototype.enableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.enableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        });\n    } else {\n        name.forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        });\n    } else {\n        name.forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.setTitle = function (title) {\n    this.title = title;\n    this.head.find('.frame-title').text(this.title);\n    this.dockFrame.attr('title', this.title);\n    document.title = this.title;\n};\n\nApp.prototype.setArgs = function (args) {\n    this.args = args;\n    if (!skipHistory) {\n        var path = BLOGSTEP.PATH + '/app/' + this.name;\n        if (!$.isEmptyObject(args)) {\n            path += '?' + $.param(args).replace(/%2F/gi, '/');\n        }\n        if (previousTitle !== null) {\n            document.title = previousTitle;\n        }\n        history.pushState({ app: this.name, args: args }, previousTitle, path);\n        document.title = this.title;\n        previousTitle = this.title;\n    }\n};\n\nApp.prototype.init = function () {\n    if (this.state !== 'loaded') {\n        console.error('init: unexpected state', this.state, 'app', this.name);\n        return;\n    }\n    this.state = 'initializing';\n    this.defineAction('close', this.close);\n    this.bindKey('c-s-c', 'close');\n    if (this.onInit !== null) {\n        this.onInit(this);\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            $('#menu').prepend(this.toolFrames[name]);\n        }\n    }\n    for (var i = 0; i < this.menus.length; i++) {\n        $('#menu').prepend(this.menus[i].frame);\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.open = function (args) {\n    if (this.state !== 'initialized') {\n        console.error(this.name + ': open: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'opening';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onOpen !== null) {\n        try {\n            this.onOpen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': open: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    }\n    if (this.dockFrame !== null) {\n        $('#dock').append(this.dockFrame);\n    }\n    this.setArgs(args);\n    this.state = 'running';\n};\n\nApp.prototype.kill = function () {\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        try {\n            this.onClose(this);\n        } catch (e) {}\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.close = function (action) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': close: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        var ok = this.onClose(this, action);\n        if (ok === false) {\n            this.state = 'running';\n            return false;\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n    return true;\n};\n\nApp.prototype.reopen = function (args) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': reopen: unexpected state:', this.state);\n        return;\n    }\n    if (this.onReopen !== null) {\n        try {\n            this.onReopen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': reopen: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    } else {\n        this.state = 'closing';\n        if (this.onClose !== null) {\n            this.onClose(this);\n        }\n        this.state = 'initialized';\n        this.open(args);\n    }\n};\n\nApp.prototype.suspend = function () {\n    if (this.state !== 'running') {\n        console.error(this.name + ': suspend: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'suspending';\n    if (this.onSuspend !== null) {\n        this.onSuspend(this);\n    }\n    if (this.state === 'suspending') {\n        this.frame.removeClass('active').hide();\n        for (var i = 0; i < this.menus.length; i++) {\n            this.menus[i].frame.hide();\n        }\n        for (var name in this.toolFrames) {\n            if (this.toolFrames.hasOwnProperty(name)) {\n                this.toolFrames[name].hide();\n            }\n        }\n        this.state = 'suspended';\n    }\n};\n\nApp.prototype.resume = function () {\n    if (this.state !== 'suspended') {\n        console.error(this.name + ': resume: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'resuming';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onResume !== null) {\n        this.onResume(this);\n    }\n    this.setArgs(this.args);\n    if (this.onResize !== null) {\n        this.onResize();\n    }\n    this.state = 'running';\n};\n\nBLOGSTEP.PATH = $('body').data('path').replace(/\\/$/, '');\n\nBLOGSTEP.init = function (name, onInit) {\n    apps[name].onInit = onInit;\n    apps[name].init();\n    if (apps[name].deferred !== null) {\n        apps[name].deferred.resolve(apps[name]);\n        apps[name].deferred = null;\n    }\n};\n\nBLOGSTEP.restore = function (name) {\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'suspended') {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            var index = tasks.indexOf(apps[name]);\n            if (index >= 0) {\n                tasks.splice(index, 1);\n            }\n            apps[name].resume();\n            return true;\n        } else if (apps[name].state === 'running') {\n            return true;\n        }\n    }\n    return false;\n};\n\nBLOGSTEP.getTasks = function () {\n    return Object.values(apps);\n};\n\nBLOGSTEP.run = function (name, args) {\n    var dfr = $.Deferred();\n    args = args || {};\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'running') {\n            apps[name].reopen(args);\n        } else {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            if (apps[name].state === 'suspended') {\n                var index = tasks.indexOf(apps[name]);\n                if (index >= 0) {\n                    tasks.splice(index, 1);\n                }\n                apps[name].resume();\n                apps[name].reopen(args);\n            } else {\n                apps[name].open(args);\n            }\n        }\n        dfr.resolve(apps[name]);\n    } else {\n        if (running !== null) {\n            running.suspend();\n            tasks.push(running);\n            running = null;\n        }\n        load(name).done(function (app) {\n            running = app;\n            app.open(args);\n            dfr.resolve(app);\n        });\n    }\n    return dfr.promise();\n};\n\nBLOGSTEP.open = function (path) {\n    var fileName = paths.fileName(path);\n    if (fileName.match(/\\.md/i)) {\n        BLOGSTEP.run('editor', { path: path });\n    } else if (fileName.match(/\\.webm/i)) {\n        BLOGSTEP.run('player', { path: path });\n    } else if (fileName.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n        BLOGSTEP.run('viewer', { path: path });\n    } else if (fileName.match(/\\.(?:php|log|json|html|css|js|sass|scss)/i)) {\n        BLOGSTEP.run('code-editor', { path: path });\n    } else {\n        BLOGSTEP.get('list-files', { path: path }).done(function (data) {\n            if (data.type === 'directory') {\n                BLOGSTEP.run('files', { path: path });\n            } else {\n                BLOGSTEP.run('code-editor', { path: path });\n            }\n        });\n    }\n};\n\nBLOGSTEP.getToken = function () {\n    return Cookies.get('csrf_token');\n};\n\nBLOGSTEP.addToken = function (xhr) {\n    xhr.setRequestHeader('X-Csrf-Token', BLOGSTEP.getToken());\n};\n\nBLOGSTEP.ajax = function (url, method, data, responseType) {\n    var dfr = $.Deferred();\n\n    var settings = {\n        url: url,\n        method: method,\n        data: data,\n        dataType: responseType,\n        headers: { 'X-Csrf-Token': BLOGSTEP.getToken() }\n    };\n\n    var xhr = $.ajax(settings);\n    xhr.done(dfr.resolve);\n    xhr.fail(function (jqXhr, textStatus, errorThrown) {\n        console.log(jqXhr, textStatus, errorThrown);\n        var newToken = BLOGSTEP.getToken();\n        if (settings.headers['X-Csrf-Token'] !== newToken) {\n            settings.headers['X-Csrf-Token'] = newToken;\n            if (xhr.status === 400) {\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n                return;\n            }\n        }\n        if (xhr.status === 401) {\n            $('#login-overlay').show();\n            if ($('#login-username').val() === '') {\n                $('#login-username').focus();\n            } else {\n                $('#login-password').focus();\n            }\n            handleLogin(function () {\n                $('#login-overlay').hide();\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n            });\n            return;\n        } else if (typeof xhr.responseJSON !== 'undefined') {\n            alert(xhr.responseJSON.message);\n        }\n        ui.shake($('main > .frame.active'));\n\n        var args = Array.prototype.slice.call(arguments);\n        dfr.rejectWith(xhr, args);\n    });\n\n    return dfr.promise();\n};\n\nBLOGSTEP.get = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'get', data, responseType);\n};\nBLOGSTEP.post = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'post', data, responseType);\n};\n\nfunction load(name) {\n    var dfr = $.Deferred();\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].deferred === null) {\n            dfr.resolve(apps[name]);\n        } else {\n            apps[name].deferred.then(dfr.resolve, dfr.reject);\n        }\n    } else {\n        apps[name] = new App(name);\n        apps[name].deferred = dfr;\n        BLOGSTEP.get('load', { name: name }, 'html').done(function (data) {\n            var $doc = $('<div></div>');\n            $doc.html(data);\n            var $styles = $doc.children('link[rel=\"stylesheet\"]');\n            var $scripts = $doc.children('script[src]');\n            apps[name].frame = $doc.children('.frame');\n            apps[name].head = apps[name].frame.children('.frame-head');\n            apps[name].body = apps[name].frame.children('.frame-body');\n            apps[name].title = apps[name].head.find('.frame-title').text();\n            apps[name].state = 'loaded';\n            $doc.children('.tool-frame').each(function () {\n                apps[name].toolFrames[$(this).data('name')] = $(this);\n            });\n            var $dockFrame = $doc.children('.dock-frame').first();\n            if ($dockFrame.length === 0) {\n                $dockFrame = $('<div class=\"dock-frame\">');\n                $('<img>').attr('src', BLOGSTEP.PATH + '/assets/img/icons/32/app.png').attr('alt', name).appendTo($dockFrame);\n                $('<label>').text(name).appendTo($dockFrame);\n            }\n            $dockFrame.click(function () {\n                BLOGSTEP.restore(name);\n            });\n            apps[name].dockFrame = $dockFrame;\n            $('head').append($styles);\n            $('main').append(apps[name].frame);\n            $scripts.each(function () {\n                $.getScript($(this).attr('src')).fail(dfr.reject);\n            });\n        }).fail(dfr.reject);\n    }\n    return dfr.promise();\n}\n\nfunction handleLogin(done) {\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        var data = {\n            username: $('#login-username').val(),\n            password: $('#login-password').val(),\n            remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n        };\n        BLOGSTEP.post('login', data).done(function () {\n            $('#login').find('input').prop('disabled', false);\n            $('#workspace-menu .username').text(data.username);\n            $('#login-frame').css({ overflow: 'hidden', whiteSpace: 'no-wrap' }).animate({ width: 0 }, function () {\n                $(this).hide().css({ overflow: '', whiteSpace: '', width: '' });\n                $('#login').off('submit');\n                $('#login-password').val('');\n                done();\n            });\n        }).fail(function () {\n            $('#login').find('input').prop('disabled', false);\n            ui.shake($('#login-frame'));\n            $('#login-username').select();\n            $('#login-password').val('');\n        });\n        return false;\n    });\n}\n;\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': BLOGSTEP.getToken() }\n});\n\n$(document).ready(function () {\n    BLOGSTEP.get('who-am-i').done(function (data) {\n        $('#workspace-menu').show();\n        $('#workspace-menu .username').text(data.username);\n\n        $('#workspace-menu [data-action=\"file-system\"]').click(function () {\n            if (!BLOGSTEP.restore('files')) {\n                BLOGSTEP.run('files');\n            }\n        });\n        $('#workspace-menu [data-action=\"builder\"]').click(function () {\n            BLOGSTEP.run('builder');\n        });\n        $('#workspace-menu [data-action=\"terminal\"]').click(function () {\n            BLOGSTEP.run('terminal');\n        });\n        $('#workspace-menu [data-action=\"control-panel\"]').click(function () {\n            BLOGSTEP.run('control-panel');\n        });\n        $('#workspace-menu [data-action=\"switch-user\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                $('#login-overlay').show();\n                $('#login-frame').show();\n                $('#login-username').select().focus();\n                handleLogin(function () {\n                    $('#login-overlay').hide();\n                });\n            });\n        });\n        $('#workspace-menu [data-action=\"logout\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                location.reload();\n            });\n        });\n\n        $('#login-username').val(data.username);\n        $('#login-overlay').addClass('login-overlay-dark');\n\n        var run = $('body').data('run');\n        if (run !== '') {\n            var args = $('body').data('args');\n            console.log(args);\n            BLOGSTEP.run(run, args);\n        } else {\n            BLOGSTEP.run('files', { path: '/' });\n        }\n    });\n});\n\n$(document).on('click', '[data-action=\"toggle-menu\"]', function (e) {\n    $('body').toggleClass('show-menu');\n    return false;\n});\n\n$('body').click(function (e) {\n    if ($('body').hasClass('show-menu')) {\n        $('body').removeClass('show-menu');\n    }\n});\n\n$(document).on('click', '[data-toggle] > *', function (e) {\n    if ($(this).is($(this).parent().data('toggle'))) {\n        $(this).toggleClass('active');\n    }\n});\n\n$(document).on('click', '[data-choice] > *', function (e) {\n    var selector = $(this).parent().data('choice');\n    if ($(this).is(selector)) {\n        $(this).parent().children(selector).removeClass('active');\n        $(this).addClass('active');\n    }\n});\n\n$(window).resize(function () {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            if (apps[name].onResize !== null) {\n                apps[name].onResize();\n            }\n        }\n    }\n});\n\n$(window).keydown(function (e) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            apps[name].keydown(e);\n        }\n    }\n});\n\nwindow.onpopstate = function (event) {\n    if (event.state !== null) {\n        skipHistory = true;\n        BLOGSTEP.run(event.state.app, event.state.args);\n        skipHistory = false;\n    }\n};\n\nwindow.onbeforeunload = function (event) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && (apps[name].state === 'running' || apps[name].state === 'suspended')) {\n            if (apps[name].isUnsaved !== null) {\n                if (apps[name].isUnsaved()) {\n                    if (apps[name].state === 'suspended') {\n                        BLOGSTEP.restore(name);\n                    }\n                    return 'Unsaved data in: ' + apps[name].title;\n                }\n            }\n        }\n    }\n};\n\n/***/ }),\n\n/***/ 4:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (true) {\n\t\t!(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (true) {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n/***/ })\n\n},[33]);\n\n\n// WEBPACK FOOTER //\n// dist/workspace.js","/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path)\n{\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path)\n{\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd)\n{\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n\n// WEBPACK FOOTER //\n// ./common/paths.js","/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = require('jquery');\nvar Cookies = require('js-cookie');\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width())\n            .animate({marginLeft: '+=' + amount}, 50)\n            .animate({marginLeft: '-=' + dbl}, 50)\n            .animate({marginLeft: '+=' + dbl}, 50)\n            .animate({marginLeft: '-=' + amount}, 50)\n            .queue(function () {\n                $(el).css('width', '')\n                        .css('margin-left', '')\n                        .finish();\n            });\n};\n\nexports.onLongPress = function(el, callback) {\n    var touching = false;\n    \n    var start = function (e) {\n        touching = true;\n    };\n    \n    var end = function (e) {\n        touching = false;\n    };\n    \n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function(el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function () {\n                $('#login-frame').css({overflow: 'hidden', whiteSpace: 'no-wrap'}).animate({width: 0}, function () {\n                    $(this).hide().css({overflow: '', whiteSpace: '', width: ''});\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function (xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n\tif ($('#login-username').val() === '') {\n\t    $('#login-username').focus();\n\t} else {\n\t    $('#login-password').focus();\n\t}\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./common/ui.js","/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\n\nvar $ = require('jquery');\nvar Cookies = require('js-cookie');\nvar ui = require('./common/ui');\nvar paths = require('./common/paths');\n\nwindow.BLOGSTEP = {};\n\nwindow.BLOGSTEP.ui = ui;\nwindow.BLOGSTEP.paths = paths;\n\nvar apps = {};\n\nvar tasks = [];\nvar running = null;\nvar skipHistory = false;\nvar previousTitle = null;\n\nfunction Menu(app, title) {\n    this.app = app;\n    this.title = title;\n    this.frame = $('<div><header></header><nav><ul></ul></div>');\n    this.header = this.frame.find('header');\n    this.itemList = this.frame.find('ul');\n    this.header.text(title);\n}\n\nMenu.prototype.addItem = function (label, action) {\n    var button = $('<button/>');\n    button.text(label);\n    if (typeof action === 'string') {\n        button.attr('data-action', action);\n    }\n    var app = this.app;\n    button.click(function () {\n        app.activate(action);\n    });\n    var item = $('<li>');\n    item.append(button);\n    for (var key in this.app.keyMap) {\n        if (this.app.keyMap.hasOwnProperty(key) && this.app.keyMap[key] === action) {\n            button.append('<span class=\"shortcut\">' + key + '</span>');\n        }\n    }\n    this.itemList.append(item);\n};\n\nfunction Dialog(parent) {\n    this.deferred = null;\n    this.parent = parent;\n    this.overlay = $('<div class=\"dialog-overlay\">');\n    this.frame = $('<div class=\"frame\">').appendTo(this.overlay);\n    this.head = $('<div class=\"frame-head\">').appendTo(this.frame);\n    this.body = $('<form class=\"frame-body\">').appendTo(this.frame);\n    $('<div class=\"frame-title\">').appendTo(this.head);\n};\n\nDialog.prototype.setTitle = function (title) {\n    this.head.find('.frame-title').text(title);\n};\n\nDialog.prototype.open = function () {\n    this.deferred = $.Deferred();\n    if (this.parent.children('.dialog-overlay').length > 0) {\n        // TODO: what to do? queue or something else?\n        this.deferred.reject();\n    } else {\n        this.overlay.appendTo(this.parent);\n    }\n    return this.deferred.promise();\n};\n\nDialog.prototype.close = function (result) {\n    this.overlay.detach();\n    this.deferred.resolve(result);\n};\n\nDialog.alert = function (parent, title, message) {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var okButton = $('<button>').text('OK').appendTo(footer);\n    okButton.click(function () {\n        dialog.close();\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    okButton.focus();\n    return dfr;\n};\n\nDialog.confirm = function (parent, title, message, choices = ['OK', 'Cancel'], defaultChoice = 'OK') {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var defaultButton = null;\n    for (var i = 0; i < choices.length; i++) {\n        footer.append(' ');\n        var button = $('<button>').text(choices[i]).appendTo(footer);\n        button.click(function () {\n            dialog.close($(this).text());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n        if (choices[i] === defaultChoice) {\n            defaultButton = button;\n        }\n    }\n    var dfr = dialog.open();\n    if (defaultButton !== null) {\n        defaultButton.focus();\n    }\n    return dfr;\n};\n\nDialog.prompt = function (parent, title, message, value = '') {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    var content = $('<div class=\"frame-content\">').appendTo(dialog.body);\n    $('<div>').text(message).appendTo(content);\n    var input = $('<input type=\"text\">').appendTo(content);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    dialog.body.submit(function (e) {\n        dialog.close(input.val());\n    });\n    input.keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    $('<input type=\"submit\">').text('OK').appendTo(footer)\n        .click(function () {\n            dialog.close(input.val());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n    footer.append(' ');\n    $('<button>').text('Cancel').appendTo(footer)\n        .click(function () {\n            dialog.close(null);\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n    var dfr = dialog.open();\n    input.focus();\n    if (value.length > 0) {\n        input.val(value);\n        input[0].setSelectionRange(0, value.length)\n    }\n    return dfr;\n};\n\nfunction App(name) {\n    this.name = name;\n    this.title = '';\n    this.state = 'loading';\n    this.deferred = null;\n    this.args = null;\n    this.frame = null;\n    this.head = null;\n    this.body = null;\n    this.dockFrame = null;\n    this.actions = {};\n    this.actionGroups = {};\n    this.keyMap = {};\n    this.menus = [];\n    this.toolFrames = {};\n    this.onInit = null;\n    this.onSuspend = null;\n    this.onResume = null;\n    this.onOpen = null;\n    this.onReopen = null;\n    this.onFocus = null;\n    this.onKeydown = null;\n    this.onUnfocus = null;\n    this.onClose = null;\n    this.onResize = null;\n    this.isUnsaved = null;\n}\n\nApp.prototype.addMenu = function (title) {\n    var menu = new Menu(this, title);\n    this.menus.push(menu);\n    return menu;\n};\n\nApp.prototype.alert = function (title, message) {\n    return Dialog.alert(this.body, title, message);\n};\n\nApp.prototype.confirm = function (title, message, choices, defaultChoice) {\n    return Dialog.confirm(this.body, title, message, choices, defaultChoice);\n};\n\nApp.prototype.prompt = function (title, message, value) {\n    return Dialog.prompt(this.body, title, message, value);\n};\n\nApp.prototype.keydown = function (e) {\n    if (e.defaultPrevented || this.isDialogOpen()) {\n        return;\n    }\n    if (this.onKeydown !== null) {\n        if (!this.onKeydown(e)) {\n            return false;\n        }\n    }\n    var key = '';\n    if (e.ctrlKey) {\n        key += 'Ctrl+';\n    }\n    if (e.altKey) {\n        key += 'Alt+';\n    }\n    if (e.shiftKey) {\n        key += 'Shift+';\n    }\n    if (e.metaKey) {\n        key += 'Meta+';\n    }\n    key += e.key.toUpperCase();\n    if (this.keyMap.hasOwnProperty(key)) {\n        e.preventDefault();\n        this.activate(this.keyMap[key]);\n        return false;\n    }\n};\n\nApp.prototype.bindKey = function (key, action) {\n    var parts = key.toLowerCase().split(/-|\\+/);\n    var e = {ctrlKey: '', altKey: '', shiftKey: ''};\n    var key = parts[parts.length - 1];\n    for (var i = 0; i < parts.length - 1; i++) {\n        switch (parts[i]) {\n            case 'c':\n                e.ctrlKey = 'Ctrl+';\n                break;\n            case 'a':\n                e.altKey = 'Alt+';\n                break;\n            case 's':\n                e.shiftKey = 'Shift+';\n                break;\n            case 'm':\n                e.metaKey = 'Meta+';\n                break;\n        }\n    }\n    key = e.ctrlKey + e.altKey + e.shiftKey + key.toUpperCase();\n    this.keyMap[key] = action;\n};\n\nApp.prototype.defineAction = function (name, callback, groups) {\n    var app = this;\n    this.actions[name] = callback;\n    this.frame.find('[data-action=\"' + name + '\"]').click(function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        app.activate(name);\n        return false;\n    });\n    if (typeof groups !== 'undefined') {\n        groups.forEach(function (group) {\n            if (!this.actionGroups.hasOwnProperty(group)) {\n                this.actionGroups[group] = [];\n            }\n            this.actionGroups[group].push(name);\n        }, this);\n    }\n};\n\nApp.prototype.activate = function (name) {\n    if (typeof name === 'string') {\n        this.actions[name].apply(this, [name]);\n    } else {\n        name.apply(this);\n    }\n};\n\nApp.prototype.isDialogOpen = function () {\n    return this.body.children('.dialog-overlay').length > 0;\n};\n\nApp.prototype.enableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.enableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        });\n    } else {\n        name.forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        });\n    } else {\n        name.forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.setTitle = function (title) {\n    this.title = title;\n    this.head.find('.frame-title').text(this.title);\n    this.dockFrame.attr('title', this.title);\n    document.title = this.title;\n};\n\nApp.prototype.setArgs = function (args) {\n    this.args = args;\n    if (!skipHistory) {\n        var path = BLOGSTEP.PATH + '/app/' + this.name;\n        if (!$.isEmptyObject(args)) {\n            path += '?' + $.param(args).replace(/%2F/gi, '/');\n        }\n        if (previousTitle !== null) {\n            document.title = previousTitle;\n        }\n        history.pushState({app: this.name, args: args}, previousTitle, path);\n        document.title = this.title;\n        previousTitle = this.title;\n    }\n};\n\nApp.prototype.init = function () {\n    if (this.state !== 'loaded') {\n        console.error('init: unexpected state', this.state, 'app', this.name);\n        return;\n    }\n    this.state = 'initializing';\n    this.defineAction('close', this.close);\n    this.bindKey('c-s-c', 'close');\n    if (this.onInit !== null) {\n        this.onInit(this);\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            $('#menu').prepend(this.toolFrames[name]);\n        }\n    }\n    for (var i = 0; i < this.menus.length; i++) {\n        $('#menu').prepend(this.menus[i].frame);\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.open = function (args) {\n    if (this.state !== 'initialized') {\n        console.error(this.name + ': open: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'opening';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onOpen !== null) {\n        try {\n            this.onOpen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': open: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    }\n    if (this.dockFrame !== null) {\n        $('#dock').append(this.dockFrame);\n    }\n    this.setArgs(args);\n    this.state = 'running';\n};\n\nApp.prototype.kill = function () {\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        try {\n            this.onClose(this);\n        } catch (e) {\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.close = function (action) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': close: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        var ok = this.onClose(this, action);\n        if (ok === false) {\n            this.state = 'running';\n            return false;\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n    return true;\n};\n\nApp.prototype.reopen = function (args) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': reopen: unexpected state:', this.state);\n        return;\n    }\n    if (this.onReopen !== null) {\n        try {\n            this.onReopen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': reopen: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    } else {\n        this.state = 'closing';\n        if (this.onClose !== null) {\n            this.onClose(this);\n        }\n        this.state = 'initialized';\n        this.open(args);\n    }\n};\n\nApp.prototype.suspend = function () {\n    if (this.state !== 'running') {\n        console.error(this.name + ': suspend: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'suspending';\n    if (this.onSuspend !== null) {\n        this.onSuspend(this);\n    }\n    if (this.state === 'suspending') {\n        this.frame.removeClass('active').hide();\n        for (var i = 0; i < this.menus.length; i++) {\n            this.menus[i].frame.hide();\n        }\n        for (var name in this.toolFrames) {\n            if (this.toolFrames.hasOwnProperty(name)) {\n                this.toolFrames[name].hide();\n            }\n        }\n        this.state = 'suspended';\n    }\n};\n\nApp.prototype.resume = function () {\n    if (this.state !== 'suspended') {\n        console.error(this.name + ': resume: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'resuming';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onResume !== null) {\n        this.onResume(this);\n    }\n    this.setArgs(this.args);\n    if (this.onResize !== null) {\n        this.onResize();\n    }\n    this.state = 'running';\n};\n\nBLOGSTEP.PATH = $('body').data('path').replace(/\\/$/, '');\n\nBLOGSTEP.init = function (name, onInit) {\n    apps[name].onInit = onInit;\n    apps[name].init();\n    if (apps[name].deferred !== null) {\n        apps[name].deferred.resolve(apps[name]);\n        apps[name].deferred = null;\n    }\n};\n\nBLOGSTEP.restore = function (name) {\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'suspended') {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            var index = tasks.indexOf(apps[name]);\n            if (index >= 0) {\n                tasks.splice(index, 1);\n            }\n            apps[name].resume();\n            return true;\n        } else if (apps[name].state === 'running') {\n            return true;\n        }\n    }\n    return false;\n};\n\nBLOGSTEP.getTasks = function () {\n    return Object.values(apps);\n};\n\nBLOGSTEP.run = function (name, args) {\n    var dfr = $.Deferred();\n    args = args || {};\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'running') {\n            apps[name].reopen(args);\n        } else {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            if (apps[name].state === 'suspended') {\n                var index = tasks.indexOf(apps[name]);\n                if (index >= 0) {\n                    tasks.splice(index, 1);\n                }\n                apps[name].resume();\n                apps[name].reopen(args);\n            } else {\n                apps[name].open(args);\n            }\n        }\n        dfr.resolve(apps[name]);\n    } else {\n        if (running !== null) {\n            running.suspend();\n            tasks.push(running);\n            running = null;\n        }\n        load(name).done(function (app) {\n            running = app;\n            app.open(args);\n            dfr.resolve(app);\n        });\n    }\n    return dfr.promise();\n};\n\nBLOGSTEP.open = function (path) {\n    var fileName = paths.fileName(path);\n    if (fileName.match(/\\.md/i)) {\n        BLOGSTEP.run('editor', {path: path});\n    } else if (fileName.match(/\\.webm/i)) {\n        BLOGSTEP.run('player', {path: path});\n    } else if (fileName.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n        BLOGSTEP.run('viewer', {path: path});\n    } else if (fileName.match(/\\.(?:php|log|json|html|css|js|sass|scss)/i)) {\n        BLOGSTEP.run('code-editor', {path: path});\n    } else {\n        BLOGSTEP.get('list-files', {path: path}).done(function (data) {\n            if (data.type === 'directory') {\n                BLOGSTEP.run('files', {path: path});\n            } else {\n                BLOGSTEP.run('code-editor', {path: path});\n            }\n        });\n    }\n};\n\nBLOGSTEP.getToken = function () {\n    return Cookies.get('csrf_token');\n};\n\nBLOGSTEP.addToken = function (xhr) {\n    xhr.setRequestHeader('X-Csrf-Token', BLOGSTEP.getToken());\n};\n\nBLOGSTEP.ajax = function (url, method, data, responseType) {\n    var dfr = $.Deferred();\n\n    var settings = {\n        url: url,\n        method: method,\n        data: data,\n        dataType: responseType,\n        headers: {'X-Csrf-Token': BLOGSTEP.getToken()}\n    };\n\n    var xhr = $.ajax(settings);\n    xhr.done(dfr.resolve);\n    xhr.fail(function (jqXhr, textStatus, errorThrown) {\n        console.log(jqXhr, textStatus, errorThrown);\n        var newToken = BLOGSTEP.getToken();\n        if (settings.headers['X-Csrf-Token'] !== newToken) {\n            settings.headers['X-Csrf-Token'] = newToken;\n            if (xhr.status === 400) {\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n                return;\n            }\n        }\n        if (xhr.status === 401) {\n            $('#login-overlay').show();\n            if ($('#login-username').val() === '') {\n                $('#login-username').focus();\n            } else {\n                $('#login-password').focus();\n            }\n            handleLogin(function () {\n                $('#login-overlay').hide();\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n            });\n            return;\n        } else if (typeof xhr.responseJSON !== 'undefined') {\n            alert(xhr.responseJSON.message);\n        }\n        ui.shake($('main > .frame.active'));\n\n        var args = Array.prototype.slice.call(arguments);\n        dfr.rejectWith(xhr, args);\n    });\n\n    return dfr.promise();\n};\n\nBLOGSTEP.get = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'get', data, responseType);\n};\nBLOGSTEP.post = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'post', data, responseType);\n};\n\nfunction load(name) {\n    var dfr = $.Deferred();\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].deferred === null) {\n            dfr.resolve(apps[name]);\n        } else {\n            apps[name].deferred.then(dfr.resolve, dfr.reject);\n        }\n    } else {\n        apps[name] = new App(name);\n        apps[name].deferred = dfr;\n        BLOGSTEP.get('load', {name: name}, 'html').done(function (data) {\n            var $doc = $('<div></div>');\n            $doc.html(data);\n            var $styles = $doc.children('link[rel=\"stylesheet\"]');\n            var $scripts = $doc.children('script[src]');\n            apps[name].frame = $doc.children('.frame');\n            apps[name].head = apps[name].frame.children('.frame-head');\n            apps[name].body = apps[name].frame.children('.frame-body');\n            apps[name].title = apps[name].head.find('.frame-title').text();\n            apps[name].state = 'loaded';\n            $doc.children('.tool-frame').each(function () {\n                apps[name].toolFrames[$(this).data('name')] = $(this);\n            });\n            var $dockFrame = $doc.children('.dock-frame').first();\n            if ($dockFrame.length === 0) {\n                $dockFrame = $('<div class=\"dock-frame\">');\n                $('<img>')\n                        .attr('src', BLOGSTEP.PATH + '/assets/img/icons/32/app.png')\n                        .attr('alt', name)\n                        .appendTo($dockFrame);\n                $('<label>')\n                        .text(name)\n                        .appendTo($dockFrame);\n            }\n            $dockFrame.click(function () {\n                BLOGSTEP.restore(name);\n            });\n            apps[name].dockFrame = $dockFrame;\n            $('head').append($styles);\n            $('main').append(apps[name].frame);\n            $scripts.each(function () {\n                $.getScript($(this).attr('src')).fail(dfr.reject);\n            });\n        }).fail(dfr.reject);\n    }\n    return dfr.promise();\n}\n\nfunction handleLogin(done) {\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        var data = {\n            username: $('#login-username').val(),\n            password: $('#login-password').val(),\n            remember: $('#login-remember').is(':checked') ? {remember: 'remember'} : null\n        };\n        BLOGSTEP.post('login', data).done(function () {\n            $('#login').find('input').prop('disabled', false);\n            $('#workspace-menu .username').text(data.username);\n            $('#login-frame').css({overflow: 'hidden', whiteSpace: 'no-wrap'}).animate({width: 0}, function () {\n                $(this).hide().css({overflow: '', whiteSpace: '', width: ''});\n                $('#login').off('submit');\n                $('#login-password').val('');\n                done();\n            });\n        }).fail(function () {\n            $('#login').find('input').prop('disabled', false);\n            ui.shake($('#login-frame'));\n            $('#login-username').select();\n            $('#login-password').val('');\n        });\n        return false;\n    });\n}\n;\n\n$.ajaxSetup({\n    headers: {'X-Csrf-Token': BLOGSTEP.getToken()}\n});\n\n$(document).ready(function () {\n    BLOGSTEP.get('who-am-i').done(function (data) {\n        $('#workspace-menu').show();\n        $('#workspace-menu .username').text(data.username);\n\n        $('#workspace-menu [data-action=\"file-system\"]').click(function () {\n            if (!BLOGSTEP.restore('files')) {\n                BLOGSTEP.run('files');\n            }\n        });\n        $('#workspace-menu [data-action=\"builder\"]').click(function () {\n            BLOGSTEP.run('builder');\n        });\n        $('#workspace-menu [data-action=\"terminal\"]').click(function () {\n            BLOGSTEP.run('terminal');\n        });\n        $('#workspace-menu [data-action=\"control-panel\"]').click(function () {\n            BLOGSTEP.run('control-panel');\n        });\n        $('#workspace-menu [data-action=\"switch-user\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                $('#login-overlay').show();\n                $('#login-frame').show();\n                $('#login-username').select().focus();\n                handleLogin(function () {\n                    $('#login-overlay').hide();\n                });\n            });\n        });\n        $('#workspace-menu [data-action=\"logout\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                location.reload();\n            });\n        });\n\n        $('#login-username').val(data.username);\n        $('#login-overlay').addClass('login-overlay-dark');\n\n        var run = $('body').data('run');\n        if (run !== '') {\n            var args = $('body').data('args');\n            console.log(args);\n            BLOGSTEP.run(run, args);\n        } else {\n            BLOGSTEP.run('files', {path: '/'});\n        }\n    });\n});\n\n$(document).on('click', '[data-action=\"toggle-menu\"]', function (e) {\n    $('body').toggleClass('show-menu');\n    return false;\n});\n\n$('body').click(function (e) {\n    if ($('body').hasClass('show-menu')) {\n        $('body').removeClass('show-menu');\n    }\n});\n\n$(document).on('click', '[data-toggle] > *', function (e) {\n    if ($(this).is($(this).parent().data('toggle'))) {\n        $(this).toggleClass('active');\n    }\n});\n\n$(document).on('click', '[data-choice] > *', function (e) {\n    var selector = $(this).parent().data('choice');\n    if ($(this).is(selector)) {\n        $(this).parent().children(selector).removeClass('active');\n        $(this).addClass('active');\n    }\n});\n\n$(window).resize(function () {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            if (apps[name].onResize !== null) {\n                apps[name].onResize();\n            }\n        }\n    }\n});\n\n$(window).keydown(function (e) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            apps[name].keydown(e);\n        }\n    }\n});\n\nwindow.onpopstate = function (event) {\n    if (event.state !== null) {\n        skipHistory = true;\n        BLOGSTEP.run(event.state.app, event.state.args);\n        skipHistory = false;\n    }\n};\n\nwindow.onbeforeunload = function (event) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && (apps[name].state === 'running' || apps[name].state === 'suspended')) {\n            if (apps[name].isUnsaved !== null) {\n                if (apps[name].isUnsaved()) {\n                    if (apps[name].state === 'suspended') {\n                        BLOGSTEP.restore(name);\n                    }\n                    return 'Unsaved data in: ' + apps[name].title;\n                }\n            }\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./workspace.js","/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/www/blogstep/~/js-cookie/src/js.cookie.js\n// module id = 4\n// module chunks = 0 1 2 4 5 6"],"sourceRoot":""}
{"version":3,"sources":["webpack:///dist/workspace.js","webpack:///./Config.js","webpack:///./common/paths.js?9de7**","webpack:///./common/ui.js?8332**","webpack:///./workspace.js","webpack:////home/www/blogstep/~/js-cookie/src/js.cookie.js?cd36**"],"names":["webpackJsonp","12","module","exports","__webpack_require__","Config","getter","setter","this","root","ns","data","Property","listeners","value","dirty","Object","defineProperty","default","prototype","getSubconfig","subconfig","get","key","hasOwnProperty","update","keys","push","config","done","set","commit","result","i","length","bind","element","is","property","val","on","change","callback","apply","2","dirName","path","replace","fileName","convert","cwd","trim","startsWith","names","split","stack","pop","join","3","$","Cookies","ajaxSetup","headers","X-Csrf-Token","shake","el","amount","dbl","width","animate","marginLeft","queue","css","finish","onLongPress","touching","start","e","end","addEventListener","setProgress","progress","status","bar","children","label","Math","floor","className","style","innerText","handleLogin","find","prop","show","submit","ajax","url","method","username","password","remember","success","overflow","whiteSpace","hide","off","error","xhr","select","global","handleError","event","settings","thrownError","newToken","focus","responseJSON","alert","message","responseText","console","log","34","Menu","app","title","frame","header","itemList","text","Dialog","parent","deferred","overlay","appendTo","head","body","App","name","state","args","dockFrame","actions","actionGroups","keyMap","menus","toolFrames","onInit","onSuspend","onResume","onOpen","onReopen","onFocus","onKeydown","onUnfocus","onClose","onResize","isUnsaved","load","dfr","Deferred","apps","resolve","then","reject","BLOGSTEP","$doc","html","$styles","$scripts","each","$dockFrame","first","attr","PATH","click","restore","append","getScript","fail","promise","post","ui","_Config","_Config2","obj","__esModule","paths","window","tasks","running","skipHistory","previousTitle","addItem","action","button","activate","item","setTitle","open","close","detach","dialog","footer","okButton","keydown","confirm","choices","arguments","undefined","defaultChoice","defaultButton","prompt","content","input","setSelectionRange","addMenu","menu","defaultPrevented","isDialogOpen","ctrlKey","altKey","shiftKey","metaKey","toUpperCase","preventDefault","bindKey","parts","toLowerCase","defineAction","groups","stopPropagation","forEach","group","enableGroup","enableAction","disableGroup","disableAction","document","setArgs","isEmptyObject","param","history","pushState","init","prepend","addClass","kill","removeClass","resume","reopen","suspend","index","indexOf","splice","getTasks","values","run","match","type","getToken","addToken","setRequestHeader","responseType","dataType","jqXhr","textStatus","errorThrown","warn","Array","slice","call","rejectWith","ready","location","reload","toggleClass","hasClass","selector","resize","onpopstate","onbeforeunload","4","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","factory","registeredInModuleLoader","OldCookies","api","noConflict","extend","attributes","converter","defaults","expires","Date","setMilliseconds","getMilliseconds","toUTCString","JSON","stringify","test","write","encodeURIComponent","String","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","cookies","rdecode","json","charAt","read","parse","getJSON","remove","withConverter"],"mappings":"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","file":"dist/workspace.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ 12:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = Config;\n/* \n * BlogSTEP\n * Copyright (c) 2018 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar nsRegex = /^([a-zA-Z_][a-zA-Z0-9_]*(\\.[a-zA-Z_][a-zA-Z0-9_]*)*)?$/;\n\nfunction Config(getter, setter) {\n    this.getter = getter;\n    this.setter = setter;\n    this.root = this;\n    this.ns = '';\n    this.data = {};\n}\n\nConfig.prototype.getSubconfig = function (ns) {\n    var subconfig = new Config(null, null);\n    subconfig.root = this.root;\n    subconfig.ns = this.ns + ns + '.';\n    return subconfig;\n};\n\nConfig.prototype.get = function (key) {\n    if (this.ns !== '') {\n        return this.root.get(this.ns + key);\n    }\n    if (!this.data.hasOwnProperty(key)) {\n        this.data[key] = new Property();\n    }\n    return this.data[key];\n};\n\nConfig.prototype.update = function () {\n    var keys = [];\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key)) {\n            keys.push(key);\n        }\n    }\n    var config = this;\n    this.getter(keys).done(function (data) {\n        for (var key in data) {\n            if (!config.data.hasOwnProperty(key)) {\n                config.data[key] = new Property();\n            }\n            config.data[key].set(data[key]);\n            config.data[key].dirty = false;\n        }\n    });\n};\n\nConfig.prototype.commit = function () {\n    var data = {};\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key) && this.data[key].dirty) {\n            data[key] = this.data[key].get();\n        }\n    }\n    var config = this;\n    this.setter(data).done(function (result) {\n        for (var i = 0; i < result.length; i++) {\n            config.data[result[i]].dirty = false;\n        }\n    });\n};\n\nfunction Property() {\n    this.listeners = [];\n    this.value = null;\n    this.dirty = false;\n}\n\nProperty.prototype.bind = function (element) {\n    if (element.is('input')) {\n        var property = this;\n        element.val(this.value);\n        element.on('keydown keyup', function () {\n            property.set(element.val());\n        });\n        this.change(function (value) {\n            element.val(value);\n        });\n    }\n};\n\nProperty.prototype.change = function (callback) {\n    this.listeners.push(callback);\n};\n\nProperty.prototype.set = function (value) {\n    this.value = value;\n    this.dirty = true;\n    for (var i = 0; i < this.listeners.length; i++) {\n        this.listeners[i].apply(this, [value]);\n    }\n};\n\nProperty.prototype.get = function () {\n    return this.value;\n};\n\n/***/ }),\n\n/***/ 2:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path) {\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path) {\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd) {\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n/***/ }),\n\n/***/ 3:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar Cookies = __webpack_require__(4);\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width()).animate({ marginLeft: '+=' + amount }, 50).animate({ marginLeft: '-=' + dbl }, 50).animate({ marginLeft: '+=' + dbl }, 50).animate({ marginLeft: '-=' + amount }, 50).queue(function () {\n        $(el).css('width', '').css('margin-left', '').finish();\n    });\n};\n\nexports.onLongPress = function (el, callback) {\n    var touching = false;\n\n    var start = function start(e) {\n        touching = true;\n    };\n\n    var end = function end(e) {\n        touching = false;\n    };\n\n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function (el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function success() {\n                $('#login-frame').css({ overflow: 'hidden', whiteSpace: 'no-wrap' }).animate({ width: 0 }, function () {\n                    $(this).hide().css({ overflow: '', whiteSpace: '', width: '' });\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function error(xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n        if ($('#login-username').val() === '') {\n            $('#login-username').focus();\n        } else {\n            $('#login-password').focus();\n        }\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n/***/ }),\n\n/***/ 34:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _Config = __webpack_require__(12);\n\nvar _Config2 = _interopRequireDefault(_Config);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar Cookies = __webpack_require__(4);\nvar ui = __webpack_require__(3);\nvar paths = __webpack_require__(2);\n\nwindow.BLOGSTEP = {};\n\nwindow.BLOGSTEP.ui = ui;\nwindow.BLOGSTEP.paths = paths;\n\nwindow.BLOGSTEP.config = new _Config2.default(function (keys) {\n    return BLOGSTEP.get('get-conf', { keys: keys });\n}, function (data) {\n    return BLOGSTEP.post('set-conf', { data: data });\n});\n\nvar apps = {};\n\nvar tasks = [];\nvar running = null;\nvar skipHistory = false;\nvar previousTitle = null;\n\nfunction Menu(app, title) {\n    this.app = app;\n    this.title = title;\n    this.frame = $('<div><header></header><nav><ul></ul></div>');\n    this.header = this.frame.find('header');\n    this.itemList = this.frame.find('ul');\n    this.header.text(title);\n}\n\nMenu.prototype.addItem = function (label, action) {\n    var button = $('<button/>');\n    button.text(label);\n    if (typeof action === 'string') {\n        button.attr('data-action', action);\n    }\n    var app = this.app;\n    button.click(function () {\n        app.activate(action);\n    });\n    var item = $('<li>');\n    item.append(button);\n    for (var key in this.app.keyMap) {\n        if (this.app.keyMap.hasOwnProperty(key) && this.app.keyMap[key] === action) {\n            button.append('<span class=\"shortcut\">' + key + '</span>');\n        }\n    }\n    this.itemList.append(item);\n};\n\nfunction Dialog(parent) {\n    this.deferred = null;\n    this.parent = parent;\n    this.overlay = $('<div class=\"dialog-overlay\">');\n    this.frame = $('<div class=\"frame\">').appendTo(this.overlay);\n    this.head = $('<div class=\"frame-head\">').appendTo(this.frame);\n    this.body = $('<form class=\"frame-body\">').appendTo(this.frame);\n    $('<div class=\"frame-title\">').appendTo(this.head);\n};\n\nDialog.prototype.setTitle = function (title) {\n    this.head.find('.frame-title').text(title);\n};\n\nDialog.prototype.open = function () {\n    this.deferred = $.Deferred();\n    if (this.parent.children('.dialog-overlay').length > 0) {\n        // TODO: what to do? queue or something else?\n        this.deferred.reject();\n    } else {\n        this.overlay.appendTo(this.parent);\n    }\n    return this.deferred.promise();\n};\n\nDialog.prototype.close = function (result) {\n    this.overlay.detach();\n    this.deferred.resolve(result);\n};\n\nDialog.alert = function (parent, title, message) {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var okButton = $('<button>').text('OK').appendTo(footer);\n    okButton.click(function () {\n        dialog.close();\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    okButton.focus();\n    return dfr;\n};\n\nDialog.confirm = function (parent, title, message) {\n    var choices = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : ['OK', 'Cancel'];\n    var defaultChoice = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'OK';\n\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var defaultButton = null;\n    for (var i = 0; i < choices.length; i++) {\n        footer.append(' ');\n        var button = $('<button>').text(choices[i]).appendTo(footer);\n        button.click(function () {\n            dialog.close($(this).text());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n        if (choices[i] === defaultChoice) {\n            defaultButton = button;\n        }\n    }\n    var dfr = dialog.open();\n    if (defaultButton !== null) {\n        defaultButton.focus();\n    }\n    return dfr;\n};\n\nDialog.prompt = function (parent, title, message) {\n    var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    var content = $('<div class=\"frame-content\">').appendTo(dialog.body);\n    $('<div>').text(message).appendTo(content);\n    var input = $('<input type=\"text\">').appendTo(content);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    dialog.body.submit(function (e) {\n        dialog.close(input.val());\n    });\n    input.keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    $('<input type=\"submit\">').text('OK').appendTo(footer).click(function () {\n        dialog.close(input.val());\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    footer.append(' ');\n    $('<button>').text('Cancel').appendTo(footer).click(function () {\n        dialog.close(null);\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    input.focus();\n    if (value.length > 0) {\n        input.val(value);\n        input[0].setSelectionRange(0, value.length);\n    }\n    return dfr;\n};\n\nfunction App(name) {\n    this.name = name;\n    this.title = '';\n    this.state = 'loading';\n    this.deferred = null;\n    this.args = null;\n    this.frame = null;\n    this.head = null;\n    this.body = null;\n    this.dockFrame = null;\n    this.actions = {};\n    this.actionGroups = {};\n    this.keyMap = {};\n    this.menus = [];\n    this.toolFrames = {};\n    this.onInit = null;\n    this.onSuspend = null;\n    this.onResume = null;\n    this.onOpen = null;\n    this.onReopen = null;\n    this.onFocus = null;\n    this.onKeydown = null;\n    this.onUnfocus = null;\n    this.onClose = null;\n    this.onResize = null;\n    this.isUnsaved = null;\n}\n\nApp.prototype.addMenu = function (title) {\n    var menu = new Menu(this, title);\n    this.menus.push(menu);\n    return menu;\n};\n\nApp.prototype.alert = function (title, message) {\n    return Dialog.alert(this.body, title, message);\n};\n\nApp.prototype.confirm = function (title, message, choices, defaultChoice) {\n    return Dialog.confirm(this.body, title, message, choices, defaultChoice);\n};\n\nApp.prototype.prompt = function (title, message, value) {\n    return Dialog.prompt(this.body, title, message, value);\n};\n\nApp.prototype.keydown = function (e) {\n    if (e.defaultPrevented || this.isDialogOpen()) {\n        return;\n    }\n    if (this.onKeydown !== null) {\n        if (!this.onKeydown(e)) {\n            return false;\n        }\n    }\n    var key = '';\n    if (e.ctrlKey) {\n        key += 'Ctrl+';\n    }\n    if (e.altKey) {\n        key += 'Alt+';\n    }\n    if (e.shiftKey) {\n        key += 'Shift+';\n    }\n    if (e.metaKey) {\n        key += 'Meta+';\n    }\n    key += e.key.toUpperCase();\n    if (this.keyMap.hasOwnProperty(key)) {\n        e.preventDefault();\n        this.activate(this.keyMap[key]);\n        return false;\n    }\n};\n\nApp.prototype.bindKey = function (key, action) {\n    var parts = key.toLowerCase().split(/-|\\+/);\n    var e = { ctrlKey: '', altKey: '', shiftKey: '' };\n    var key = parts[parts.length - 1];\n    for (var i = 0; i < parts.length - 1; i++) {\n        switch (parts[i]) {\n            case 'c':\n                e.ctrlKey = 'Ctrl+';\n                break;\n            case 'a':\n                e.altKey = 'Alt+';\n                break;\n            case 's':\n                e.shiftKey = 'Shift+';\n                break;\n            case 'm':\n                e.metaKey = 'Meta+';\n                break;\n        }\n    }\n    key = e.ctrlKey + e.altKey + e.shiftKey + key.toUpperCase();\n    this.keyMap[key] = action;\n};\n\nApp.prototype.defineAction = function (name, callback, groups) {\n    var app = this;\n    this.actions[name] = callback;\n    this.frame.find('[data-action=\"' + name + '\"]').click(function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        app.activate(name);\n        return false;\n    });\n    if (typeof groups !== 'undefined') {\n        groups.forEach(function (group) {\n            if (!this.actionGroups.hasOwnProperty(group)) {\n                this.actionGroups[group] = [];\n            }\n            this.actionGroups[group].push(name);\n        }, this);\n    }\n};\n\nApp.prototype.activate = function (name) {\n    if (typeof name === 'string') {\n        this.actions[name].apply(this, [name]);\n    } else {\n        name.apply(this);\n    }\n};\n\nApp.prototype.isDialogOpen = function () {\n    return this.body.children('.dialog-overlay').length > 0;\n};\n\nApp.prototype.enableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.enableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        });\n    } else {\n        name.forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        });\n    } else {\n        name.forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.setTitle = function (title) {\n    this.title = title;\n    this.head.find('.frame-title').text(this.title);\n    this.dockFrame.attr('title', this.title);\n    document.title = this.title;\n};\n\nApp.prototype.setArgs = function (args) {\n    this.args = args;\n    if (!skipHistory) {\n        var path = BLOGSTEP.PATH + '/app/' + this.name;\n        if (!$.isEmptyObject(args)) {\n            path += '?' + $.param(args).replace(/%2F/gi, '/');\n        }\n        if (previousTitle !== null) {\n            document.title = previousTitle;\n        }\n        history.pushState({ app: this.name, args: args }, previousTitle, path);\n        document.title = this.title;\n        previousTitle = this.title;\n    }\n};\n\nApp.prototype.init = function () {\n    if (this.state !== 'loaded') {\n        console.error('init: unexpected state', this.state, 'app', this.name);\n        return;\n    }\n    this.state = 'initializing';\n    this.defineAction('close', this.close);\n    this.bindKey('c-s-c', 'close');\n    if (this.onInit !== null) {\n        this.onInit(this);\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            $('#menu').prepend(this.toolFrames[name]);\n        }\n    }\n    for (var i = 0; i < this.menus.length; i++) {\n        $('#menu').prepend(this.menus[i].frame);\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.open = function (args) {\n    if (this.state !== 'initialized') {\n        console.error(this.name + ': open: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'opening';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onOpen !== null) {\n        try {\n            this.onOpen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': open: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    }\n    if (this.dockFrame !== null) {\n        $('#dock').append(this.dockFrame);\n    }\n    this.setArgs(args);\n    this.state = 'running';\n};\n\nApp.prototype.kill = function () {\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        try {\n            this.onClose(this);\n        } catch (e) {}\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.close = function (action) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': close: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        var ok = this.onClose(this, action);\n        if (ok === false) {\n            this.state = 'running';\n            return false;\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n    return true;\n};\n\nApp.prototype.reopen = function (args) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': reopen: unexpected state:', this.state);\n        return;\n    }\n    if (this.onReopen !== null) {\n        try {\n            this.onReopen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': reopen: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    } else {\n        this.state = 'closing';\n        if (this.onClose !== null) {\n            this.onClose(this);\n        }\n        this.state = 'initialized';\n        this.open(args);\n    }\n};\n\nApp.prototype.suspend = function () {\n    if (this.state !== 'running') {\n        console.error(this.name + ': suspend: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'suspending';\n    if (this.onSuspend !== null) {\n        this.onSuspend(this);\n    }\n    if (this.state === 'suspending') {\n        this.frame.removeClass('active').hide();\n        for (var i = 0; i < this.menus.length; i++) {\n            this.menus[i].frame.hide();\n        }\n        for (var name in this.toolFrames) {\n            if (this.toolFrames.hasOwnProperty(name)) {\n                this.toolFrames[name].hide();\n            }\n        }\n        this.state = 'suspended';\n    }\n};\n\nApp.prototype.resume = function () {\n    if (this.state !== 'suspended') {\n        console.error(this.name + ': resume: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'resuming';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onResume !== null) {\n        this.onResume(this);\n    }\n    this.setArgs(this.args);\n    if (this.onResize !== null) {\n        this.onResize();\n    }\n    this.state = 'running';\n};\n\nBLOGSTEP.PATH = $('body').data('path').replace(/\\/$/, '');\n\nBLOGSTEP.init = function (name, onInit) {\n    apps[name].onInit = onInit;\n    apps[name].init();\n    if (apps[name].deferred !== null) {\n        apps[name].deferred.resolve(apps[name]);\n        apps[name].deferred = null;\n    }\n};\n\nBLOGSTEP.restore = function (name) {\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'suspended') {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            var index = tasks.indexOf(apps[name]);\n            if (index >= 0) {\n                tasks.splice(index, 1);\n            }\n            apps[name].resume();\n            return true;\n        } else if (apps[name].state === 'running') {\n            return true;\n        }\n    }\n    return false;\n};\n\nBLOGSTEP.getTasks = function () {\n    return Object.values(apps);\n};\n\nBLOGSTEP.run = function (name, args) {\n    var dfr = $.Deferred();\n    args = args || {};\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'running') {\n            apps[name].reopen(args);\n        } else {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            if (apps[name].state === 'suspended') {\n                var index = tasks.indexOf(apps[name]);\n                if (index >= 0) {\n                    tasks.splice(index, 1);\n                }\n                apps[name].resume();\n                apps[name].reopen(args);\n            } else {\n                apps[name].open(args);\n            }\n        }\n        dfr.resolve(apps[name]);\n    } else {\n        if (running !== null) {\n            running.suspend();\n            tasks.push(running);\n            running = null;\n        }\n        load(name).done(function (app) {\n            running = app;\n            app.open(args);\n            dfr.resolve(app);\n        });\n    }\n    return dfr.promise();\n};\n\nBLOGSTEP.open = function (path) {\n    var fileName = paths.fileName(path);\n    if (fileName.match(/\\.md/i)) {\n        BLOGSTEP.run('editor', { path: path });\n    } else if (fileName.match(/\\.webm/i)) {\n        BLOGSTEP.run('player', { path: path });\n    } else if (fileName.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n        BLOGSTEP.run('viewer', { path: path });\n    } else if (fileName.match(/\\.(?:php|log|json|html|css|js|sass|scss)/i)) {\n        BLOGSTEP.run('code-editor', { path: path });\n    } else {\n        BLOGSTEP.get('list-files', { path: path }).done(function (data) {\n            if (data.type === 'directory') {\n                BLOGSTEP.run('files', { path: path });\n            } else {\n                BLOGSTEP.run('code-editor', { path: path });\n            }\n        });\n    }\n};\n\nBLOGSTEP.getToken = function () {\n    return Cookies.get('csrf_token');\n};\n\nBLOGSTEP.addToken = function (xhr) {\n    xhr.setRequestHeader('X-Csrf-Token', BLOGSTEP.getToken());\n};\n\nBLOGSTEP.ajax = function (url, method, data, responseType) {\n    var dfr = $.Deferred();\n\n    var settings = {\n        url: url,\n        method: method,\n        data: data,\n        dataType: responseType,\n        headers: { 'X-Csrf-Token': BLOGSTEP.getToken() }\n    };\n\n    var xhr = $.ajax(settings);\n    xhr.done(dfr.resolve);\n    xhr.fail(function (jqXhr, textStatus, errorThrown) {\n        console.log(jqXhr, textStatus, errorThrown);\n        var newToken = BLOGSTEP.getToken();\n        if (settings.headers['X-Csrf-Token'] !== newToken) {\n            settings.headers['X-Csrf-Token'] = newToken;\n            if (xhr.status === 400) {\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n                return;\n            }\n        }\n        if (xhr.status === 401) {\n            $('#login-overlay').show();\n            if ($('#login-username').val() === '') {\n                $('#login-username').focus();\n            } else {\n                $('#login-password').focus();\n            }\n            handleLogin(function () {\n                $('#login-overlay').hide();\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n            });\n            return;\n        } else if (typeof xhr.responseJSON !== 'undefined') {\n            console.warn(xhr.responseJSON.message);\n        }\n        ui.shake($('main > .frame.active'));\n\n        var args = Array.prototype.slice.call(arguments);\n        dfr.rejectWith(xhr, args);\n    });\n\n    return dfr.promise();\n};\n\nBLOGSTEP.get = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'get', data, responseType);\n};\nBLOGSTEP.post = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'post', data, responseType);\n};\n\nfunction load(name) {\n    var dfr = $.Deferred();\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].deferred === null) {\n            dfr.resolve(apps[name]);\n        } else {\n            apps[name].deferred.then(dfr.resolve, dfr.reject);\n        }\n    } else {\n        apps[name] = new App(name);\n        apps[name].deferred = dfr;\n        BLOGSTEP.get('load', { name: name }, 'html').done(function (data) {\n            var $doc = $('<div></div>');\n            $doc.html(data);\n            var $styles = $doc.children('link[rel=\"stylesheet\"]');\n            var $scripts = $doc.children('script[src]');\n            apps[name].frame = $doc.children('.frame');\n            apps[name].head = apps[name].frame.children('.frame-head');\n            apps[name].body = apps[name].frame.children('.frame-body');\n            apps[name].title = apps[name].head.find('.frame-title').text();\n            apps[name].state = 'loaded';\n            $doc.children('.tool-frame').each(function () {\n                apps[name].toolFrames[$(this).data('name')] = $(this);\n            });\n            var $dockFrame = $doc.children('.dock-frame').first();\n            if ($dockFrame.length === 0) {\n                $dockFrame = $('<div class=\"dock-frame\">');\n                $('<img>').attr('src', BLOGSTEP.PATH + '/assets/img/icons/32/app.png').attr('alt', name).appendTo($dockFrame);\n                $('<label>').text(name).appendTo($dockFrame);\n            }\n            $dockFrame.click(function () {\n                BLOGSTEP.restore(name);\n            });\n            apps[name].dockFrame = $dockFrame;\n            $('head').append($styles);\n            $('main').append(apps[name].frame);\n            $scripts.each(function () {\n                $.getScript($(this).attr('src')).fail(dfr.reject);\n            });\n        }).fail(dfr.reject);\n    }\n    return dfr.promise();\n}\n\nfunction handleLogin(done) {\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        var data = {\n            username: $('#login-username').val(),\n            password: $('#login-password').val(),\n            remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n        };\n        BLOGSTEP.post('login', data).done(function () {\n            $('#login').find('input').prop('disabled', false);\n            $('#workspace-menu .username').text(data.username);\n            $('#login-frame').css({ overflow: 'hidden', whiteSpace: 'no-wrap' }).animate({ width: 0 }, function () {\n                $(this).hide().css({ overflow: '', whiteSpace: '', width: '' });\n                $('#login').off('submit');\n                $('#login-password').val('');\n                done();\n            });\n        }).fail(function () {\n            $('#login').find('input').prop('disabled', false);\n            ui.shake($('#login-frame'));\n            $('#login-username').select();\n            $('#login-password').val('');\n        });\n        return false;\n    });\n}\n;\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': BLOGSTEP.getToken() }\n});\n\n$(document).ready(function () {\n    BLOGSTEP.get('who-am-i').done(function (data) {\n        $('#workspace-menu').show();\n        $('#workspace-menu .username').text(data.username);\n\n        $('#workspace-menu [data-action=\"file-system\"]').click(function () {\n            if (!BLOGSTEP.restore('files')) {\n                BLOGSTEP.run('files');\n            }\n        });\n        $('#workspace-menu [data-action=\"builder\"]').click(function () {\n            BLOGSTEP.run('builder');\n        });\n        $('#workspace-menu [data-action=\"terminal\"]').click(function () {\n            BLOGSTEP.run('terminal');\n        });\n        $('#workspace-menu [data-action=\"control-panel\"]').click(function () {\n            BLOGSTEP.run('control-panel');\n        });\n        $('#workspace-menu [data-action=\"switch-user\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                $('#login-overlay').show();\n                $('#login-frame').show();\n                $('#login-username').select().focus();\n                handleLogin(function () {\n                    $('#login-overlay').hide();\n                });\n            });\n        });\n        $('#workspace-menu [data-action=\"logout\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                location.reload();\n            });\n        });\n\n        $('#login-username').val(data.username);\n        $('#login-overlay').addClass('login-overlay-dark');\n\n        var run = $('body').data('run');\n        if (run !== '') {\n            var args = $('body').data('args');\n            console.log(args);\n            BLOGSTEP.run(run, args);\n        } else {\n            BLOGSTEP.run('files', { path: '/' });\n        }\n    });\n});\n\n$(document).on('click', '[data-action=\"toggle-menu\"]', function (e) {\n    $('body').toggleClass('show-menu');\n    return false;\n});\n\n$('body').click(function (e) {\n    if ($('body').hasClass('show-menu')) {\n        $('body').removeClass('show-menu');\n    }\n});\n\n$(document).on('click', '[data-toggle] > *', function (e) {\n    if ($(this).is($(this).parent().data('toggle'))) {\n        $(this).toggleClass('active');\n    }\n});\n\n$(document).on('click', '[data-choice] > *', function (e) {\n    var selector = $(this).parent().data('choice');\n    if ($(this).is(selector)) {\n        $(this).parent().children(selector).removeClass('active');\n        $(this).addClass('active');\n    }\n});\n\n$(window).resize(function () {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            if (apps[name].onResize !== null) {\n                apps[name].onResize();\n            }\n        }\n    }\n});\n\n$(window).keydown(function (e) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            apps[name].keydown(e);\n        }\n    }\n});\n\nwindow.onpopstate = function (event) {\n    if (event.state !== null) {\n        skipHistory = true;\n        BLOGSTEP.run(event.state.app, event.state.args);\n        skipHistory = false;\n    }\n};\n\nwindow.onbeforeunload = function (event) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && (apps[name].state === 'running' || apps[name].state === 'suspended')) {\n            if (apps[name].isUnsaved !== null) {\n                if (apps[name].isUnsaved()) {\n                    if (apps[name].state === 'suspended') {\n                        BLOGSTEP.restore(name);\n                    }\n                    return 'Unsaved data in: ' + apps[name].title;\n                }\n            }\n        }\n    }\n};\n\n/***/ }),\n\n/***/ 4:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (true) {\n\t\t!(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (true) {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n/***/ })\n\n},[34]);\n\n\n// WEBPACK FOOTER //\n// dist/workspace.js","/* \n * BlogSTEP\n * Copyright (c) 2018 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar nsRegex = /^([a-zA-Z_][a-zA-Z0-9_]*(\\.[a-zA-Z_][a-zA-Z0-9_]*)*)?$/;\n\nexport default function Config(getter, setter) {\n    this.getter = getter;\n    this.setter = setter;\n    this.root = this;\n    this.ns = '';\n    this.data = {};\n}\n\nConfig.prototype.getSubconfig = function (ns) {\n    var subconfig = new Config(null, null);\n    subconfig.root = this.root;\n    subconfig.ns = this.ns + ns + '.';\n    return subconfig;\n};\n\nConfig.prototype.get = function (key) {\n    if (this.ns !== '') {\n        return this.root.get(this.ns + key);\n    }\n    if (!this.data.hasOwnProperty(key)) {\n        this.data[key] = new Property();\n    }\n    return this.data[key];\n};\n\nConfig.prototype.update = function () {\n    var keys = [];\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key)) {\n            keys.push(key);\n        }\n    }\n    var config = this;\n    this.getter(keys).done(function (data) {\n        for (var key in data) {\n            if (!config.data.hasOwnProperty(key)) {\n                config.data[key] = new Property();\n            }\n            config.data[key].set(data[key]);\n            config.data[key].dirty = false;\n        }\n    });\n};\n\nConfig.prototype.commit = function () {\n    var data = {};\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key) && this.data[key].dirty) {\n            data[key] = this.data[key].get();\n        }\n    }\n    var config = this;\n    this.setter(data).done(function (result) {\n        for (var i = 0; i < result.length; i++) {\n            config.data[result[i]].dirty = false;\n        }\n    });\n};\n\n\nfunction Property() {\n    this.listeners = [];\n    this.value = null;\n    this.dirty = false;\n}\n\nProperty.prototype.bind = function (element) {\n    if (element.is('input')) {\n        var property = this;\n        element.val(this.value);\n        element.on('keydown keyup', function () {\n            property.set(element.val());\n        });\n        this.change(function (value) {\n            element.val(value);\n        });\n    }\n};\n\nProperty.prototype.change = function (callback) {\n    this.listeners.push(callback);\n};\n\nProperty.prototype.set = function (value) {\n    this.value = value;\n    this.dirty = true;\n    for (var i = 0; i < this.listeners.length; i++) {\n        this.listeners[i].apply(this, [value]);\n    }\n};\n\nProperty.prototype.get = function () {\n    return this.value;\n};\n\n\n// WEBPACK FOOTER //\n// ./Config.js","/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path)\n{\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path)\n{\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd)\n{\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n\n// WEBPACK FOOTER //\n// ./common/paths.js","/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = require('jquery');\nvar Cookies = require('js-cookie');\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width())\n            .animate({marginLeft: '+=' + amount}, 50)\n            .animate({marginLeft: '-=' + dbl}, 50)\n            .animate({marginLeft: '+=' + dbl}, 50)\n            .animate({marginLeft: '-=' + amount}, 50)\n            .queue(function () {\n                $(el).css('width', '')\n                        .css('margin-left', '')\n                        .finish();\n            });\n};\n\nexports.onLongPress = function(el, callback) {\n    var touching = false;\n    \n    var start = function (e) {\n        touching = true;\n    };\n    \n    var end = function (e) {\n        touching = false;\n    };\n    \n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function(el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function () {\n                $('#login-frame').css({overflow: 'hidden', whiteSpace: 'no-wrap'}).animate({width: 0}, function () {\n                    $(this).hide().css({overflow: '', whiteSpace: '', width: ''});\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function (xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n        if ($('#login-username').val() === '') {\n            $('#login-username').focus();\n        } else {\n            $('#login-password').focus();\n        }\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./common/ui.js","/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\n\nvar $ = require('jquery');\nvar Cookies = require('js-cookie');\nvar ui = require('./common/ui');\nvar paths = require('./common/paths');\n\nimport Config from './Config';\n\nwindow.BLOGSTEP = {};\n\nwindow.BLOGSTEP.ui = ui;\nwindow.BLOGSTEP.paths = paths;\n\nwindow.BLOGSTEP.config = new Config(function (keys) {\n    return BLOGSTEP.get('get-conf', { keys: keys });\n}, function (data) {\n    return BLOGSTEP.post('set-conf', { data: data });\n});\n\nvar apps = {};\n\nvar tasks = [];\nvar running = null;\nvar skipHistory = false;\nvar previousTitle = null;\n\nfunction Menu(app, title) {\n    this.app = app;\n    this.title = title;\n    this.frame = $('<div><header></header><nav><ul></ul></div>');\n    this.header = this.frame.find('header');\n    this.itemList = this.frame.find('ul');\n    this.header.text(title);\n}\n\nMenu.prototype.addItem = function (label, action) {\n    var button = $('<button/>');\n    button.text(label);\n    if (typeof action === 'string') {\n        button.attr('data-action', action);\n    }\n    var app = this.app;\n    button.click(function () {\n        app.activate(action);\n    });\n    var item = $('<li>');\n    item.append(button);\n    for (var key in this.app.keyMap) {\n        if (this.app.keyMap.hasOwnProperty(key) && this.app.keyMap[key] === action) {\n            button.append('<span class=\"shortcut\">' + key + '</span>');\n        }\n    }\n    this.itemList.append(item);\n};\n\nfunction Dialog(parent) {\n    this.deferred = null;\n    this.parent = parent;\n    this.overlay = $('<div class=\"dialog-overlay\">');\n    this.frame = $('<div class=\"frame\">').appendTo(this.overlay);\n    this.head = $('<div class=\"frame-head\">').appendTo(this.frame);\n    this.body = $('<form class=\"frame-body\">').appendTo(this.frame);\n    $('<div class=\"frame-title\">').appendTo(this.head);\n};\n\nDialog.prototype.setTitle = function (title) {\n    this.head.find('.frame-title').text(title);\n};\n\nDialog.prototype.open = function () {\n    this.deferred = $.Deferred();\n    if (this.parent.children('.dialog-overlay').length > 0) {\n        // TODO: what to do? queue or something else?\n        this.deferred.reject();\n    } else {\n        this.overlay.appendTo(this.parent);\n    }\n    return this.deferred.promise();\n};\n\nDialog.prototype.close = function (result) {\n    this.overlay.detach();\n    this.deferred.resolve(result);\n};\n\nDialog.alert = function (parent, title, message) {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var okButton = $('<button>').text('OK').appendTo(footer);\n    okButton.click(function () {\n        dialog.close();\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    okButton.focus();\n    return dfr;\n};\n\nDialog.confirm = function (parent, title, message, choices = ['OK', 'Cancel'], defaultChoice = 'OK') {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var defaultButton = null;\n    for (var i = 0; i < choices.length; i++) {\n        footer.append(' ');\n        var button = $('<button>').text(choices[i]).appendTo(footer);\n        button.click(function () {\n            dialog.close($(this).text());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n        if (choices[i] === defaultChoice) {\n            defaultButton = button;\n        }\n    }\n    var dfr = dialog.open();\n    if (defaultButton !== null) {\n        defaultButton.focus();\n    }\n    return dfr;\n};\n\nDialog.prompt = function (parent, title, message, value = '') {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    var content = $('<div class=\"frame-content\">').appendTo(dialog.body);\n    $('<div>').text(message).appendTo(content);\n    var input = $('<input type=\"text\">').appendTo(content);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    dialog.body.submit(function (e) {\n        dialog.close(input.val());\n    });\n    input.keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    $('<input type=\"submit\">').text('OK').appendTo(footer)\n        .click(function () {\n            dialog.close(input.val());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n    footer.append(' ');\n    $('<button>').text('Cancel').appendTo(footer)\n        .click(function () {\n            dialog.close(null);\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n    var dfr = dialog.open();\n    input.focus();\n    if (value.length > 0) {\n        input.val(value);\n        input[0].setSelectionRange(0, value.length)\n    }\n    return dfr;\n};\n\nfunction App(name) {\n    this.name = name;\n    this.title = '';\n    this.state = 'loading';\n    this.deferred = null;\n    this.args = null;\n    this.frame = null;\n    this.head = null;\n    this.body = null;\n    this.dockFrame = null;\n    this.actions = {};\n    this.actionGroups = {};\n    this.keyMap = {};\n    this.menus = [];\n    this.toolFrames = {};\n    this.onInit = null;\n    this.onSuspend = null;\n    this.onResume = null;\n    this.onOpen = null;\n    this.onReopen = null;\n    this.onFocus = null;\n    this.onKeydown = null;\n    this.onUnfocus = null;\n    this.onClose = null;\n    this.onResize = null;\n    this.isUnsaved = null;\n}\n\nApp.prototype.addMenu = function (title) {\n    var menu = new Menu(this, title);\n    this.menus.push(menu);\n    return menu;\n};\n\nApp.prototype.alert = function (title, message) {\n    return Dialog.alert(this.body, title, message);\n};\n\nApp.prototype.confirm = function (title, message, choices, defaultChoice) {\n    return Dialog.confirm(this.body, title, message, choices, defaultChoice);\n};\n\nApp.prototype.prompt = function (title, message, value) {\n    return Dialog.prompt(this.body, title, message, value);\n};\n\nApp.prototype.keydown = function (e) {\n    if (e.defaultPrevented || this.isDialogOpen()) {\n        return;\n    }\n    if (this.onKeydown !== null) {\n        if (!this.onKeydown(e)) {\n            return false;\n        }\n    }\n    var key = '';\n    if (e.ctrlKey) {\n        key += 'Ctrl+';\n    }\n    if (e.altKey) {\n        key += 'Alt+';\n    }\n    if (e.shiftKey) {\n        key += 'Shift+';\n    }\n    if (e.metaKey) {\n        key += 'Meta+';\n    }\n    key += e.key.toUpperCase();\n    if (this.keyMap.hasOwnProperty(key)) {\n        e.preventDefault();\n        this.activate(this.keyMap[key]);\n        return false;\n    }\n};\n\nApp.prototype.bindKey = function (key, action) {\n    var parts = key.toLowerCase().split(/-|\\+/);\n    var e = {ctrlKey: '', altKey: '', shiftKey: ''};\n    var key = parts[parts.length - 1];\n    for (var i = 0; i < parts.length - 1; i++) {\n        switch (parts[i]) {\n            case 'c':\n                e.ctrlKey = 'Ctrl+';\n                break;\n            case 'a':\n                e.altKey = 'Alt+';\n                break;\n            case 's':\n                e.shiftKey = 'Shift+';\n                break;\n            case 'm':\n                e.metaKey = 'Meta+';\n                break;\n        }\n    }\n    key = e.ctrlKey + e.altKey + e.shiftKey + key.toUpperCase();\n    this.keyMap[key] = action;\n};\n\nApp.prototype.defineAction = function (name, callback, groups) {\n    var app = this;\n    this.actions[name] = callback;\n    this.frame.find('[data-action=\"' + name + '\"]').click(function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        app.activate(name);\n        return false;\n    });\n    if (typeof groups !== 'undefined') {\n        groups.forEach(function (group) {\n            if (!this.actionGroups.hasOwnProperty(group)) {\n                this.actionGroups[group] = [];\n            }\n            this.actionGroups[group].push(name);\n        }, this);\n    }\n};\n\nApp.prototype.activate = function (name) {\n    if (typeof name === 'string') {\n        this.actions[name].apply(this, [name]);\n    } else {\n        name.apply(this);\n    }\n};\n\nApp.prototype.isDialogOpen = function () {\n    return this.body.children('.dialog-overlay').length > 0;\n};\n\nApp.prototype.enableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.enableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        });\n    } else {\n        name.forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        });\n    } else {\n        name.forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.setTitle = function (title) {\n    this.title = title;\n    this.head.find('.frame-title').text(this.title);\n    this.dockFrame.attr('title', this.title);\n    document.title = this.title;\n};\n\nApp.prototype.setArgs = function (args) {\n    this.args = args;\n    if (!skipHistory) {\n        var path = BLOGSTEP.PATH + '/app/' + this.name;\n        if (!$.isEmptyObject(args)) {\n            path += '?' + $.param(args).replace(/%2F/gi, '/');\n        }\n        if (previousTitle !== null) {\n            document.title = previousTitle;\n        }\n        history.pushState({app: this.name, args: args}, previousTitle, path);\n        document.title = this.title;\n        previousTitle = this.title;\n    }\n};\n\nApp.prototype.init = function () {\n    if (this.state !== 'loaded') {\n        console.error('init: unexpected state', this.state, 'app', this.name);\n        return;\n    }\n    this.state = 'initializing';\n    this.defineAction('close', this.close);\n    this.bindKey('c-s-c', 'close');\n    if (this.onInit !== null) {\n        this.onInit(this);\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            $('#menu').prepend(this.toolFrames[name]);\n        }\n    }\n    for (var i = 0; i < this.menus.length; i++) {\n        $('#menu').prepend(this.menus[i].frame);\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.open = function (args) {\n    if (this.state !== 'initialized') {\n        console.error(this.name + ': open: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'opening';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onOpen !== null) {\n        try {\n            this.onOpen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': open: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    }\n    if (this.dockFrame !== null) {\n        $('#dock').append(this.dockFrame);\n    }\n    this.setArgs(args);\n    this.state = 'running';\n};\n\nApp.prototype.kill = function () {\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        try {\n            this.onClose(this);\n        } catch (e) {\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.close = function (action) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': close: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        var ok = this.onClose(this, action);\n        if (ok === false) {\n            this.state = 'running';\n            return false;\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n    return true;\n};\n\nApp.prototype.reopen = function (args) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': reopen: unexpected state:', this.state);\n        return;\n    }\n    if (this.onReopen !== null) {\n        try {\n            this.onReopen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': reopen: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    } else {\n        this.state = 'closing';\n        if (this.onClose !== null) {\n            this.onClose(this);\n        }\n        this.state = 'initialized';\n        this.open(args);\n    }\n};\n\nApp.prototype.suspend = function () {\n    if (this.state !== 'running') {\n        console.error(this.name + ': suspend: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'suspending';\n    if (this.onSuspend !== null) {\n        this.onSuspend(this);\n    }\n    if (this.state === 'suspending') {\n        this.frame.removeClass('active').hide();\n        for (var i = 0; i < this.menus.length; i++) {\n            this.menus[i].frame.hide();\n        }\n        for (var name in this.toolFrames) {\n            if (this.toolFrames.hasOwnProperty(name)) {\n                this.toolFrames[name].hide();\n            }\n        }\n        this.state = 'suspended';\n    }\n};\n\nApp.prototype.resume = function () {\n    if (this.state !== 'suspended') {\n        console.error(this.name + ': resume: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'resuming';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onResume !== null) {\n        this.onResume(this);\n    }\n    this.setArgs(this.args);\n    if (this.onResize !== null) {\n        this.onResize();\n    }\n    this.state = 'running';\n};\n\nBLOGSTEP.PATH = $('body').data('path').replace(/\\/$/, '');\n\nBLOGSTEP.init = function (name, onInit) {\n    apps[name].onInit = onInit;\n    apps[name].init();\n    if (apps[name].deferred !== null) {\n        apps[name].deferred.resolve(apps[name]);\n        apps[name].deferred = null;\n    }\n};\n\nBLOGSTEP.restore = function (name) {\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'suspended') {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            var index = tasks.indexOf(apps[name]);\n            if (index >= 0) {\n                tasks.splice(index, 1);\n            }\n            apps[name].resume();\n            return true;\n        } else if (apps[name].state === 'running') {\n            return true;\n        }\n    }\n    return false;\n};\n\nBLOGSTEP.getTasks = function () {\n    return Object.values(apps);\n};\n\nBLOGSTEP.run = function (name, args) {\n    var dfr = $.Deferred();\n    args = args || {};\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'running') {\n            apps[name].reopen(args);\n        } else {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            if (apps[name].state === 'suspended') {\n                var index = tasks.indexOf(apps[name]);\n                if (index >= 0) {\n                    tasks.splice(index, 1);\n                }\n                apps[name].resume();\n                apps[name].reopen(args);\n            } else {\n                apps[name].open(args);\n            }\n        }\n        dfr.resolve(apps[name]);\n    } else {\n        if (running !== null) {\n            running.suspend();\n            tasks.push(running);\n            running = null;\n        }\n        load(name).done(function (app) {\n            running = app;\n            app.open(args);\n            dfr.resolve(app);\n        });\n    }\n    return dfr.promise();\n};\n\nBLOGSTEP.open = function (path) {\n    var fileName = paths.fileName(path);\n    if (fileName.match(/\\.md/i)) {\n        BLOGSTEP.run('editor', {path: path});\n    } else if (fileName.match(/\\.webm/i)) {\n        BLOGSTEP.run('player', {path: path});\n    } else if (fileName.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n        BLOGSTEP.run('viewer', {path: path});\n    } else if (fileName.match(/\\.(?:php|log|json|html|css|js|sass|scss)/i)) {\n        BLOGSTEP.run('code-editor', {path: path});\n    } else {\n        BLOGSTEP.get('list-files', {path: path}).done(function (data) {\n            if (data.type === 'directory') {\n                BLOGSTEP.run('files', {path: path});\n            } else {\n                BLOGSTEP.run('code-editor', {path: path});\n            }\n        });\n    }\n};\n\nBLOGSTEP.getToken = function () {\n    return Cookies.get('csrf_token');\n};\n\nBLOGSTEP.addToken = function (xhr) {\n    xhr.setRequestHeader('X-Csrf-Token', BLOGSTEP.getToken());\n};\n\nBLOGSTEP.ajax = function (url, method, data, responseType) {\n    var dfr = $.Deferred();\n\n    var settings = {\n        url: url,\n        method: method,\n        data: data,\n        dataType: responseType,\n        headers: {'X-Csrf-Token': BLOGSTEP.getToken()}\n    };\n\n    var xhr = $.ajax(settings);\n    xhr.done(dfr.resolve);\n    xhr.fail(function (jqXhr, textStatus, errorThrown) {\n        console.log(jqXhr, textStatus, errorThrown);\n        var newToken = BLOGSTEP.getToken();\n        if (settings.headers['X-Csrf-Token'] !== newToken) {\n            settings.headers['X-Csrf-Token'] = newToken;\n            if (xhr.status === 400) {\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n                return;\n            }\n        }\n        if (xhr.status === 401) {\n            $('#login-overlay').show();\n            if ($('#login-username').val() === '') {\n                $('#login-username').focus();\n            } else {\n                $('#login-password').focus();\n            }\n            handleLogin(function () {\n                $('#login-overlay').hide();\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n            });\n            return;\n        } else if (typeof xhr.responseJSON !== 'undefined') {\n            console.warn(xhr.responseJSON.message);\n        }\n        ui.shake($('main > .frame.active'));\n\n        var args = Array.prototype.slice.call(arguments);\n        dfr.rejectWith(xhr, args);\n    });\n\n    return dfr.promise();\n};\n\nBLOGSTEP.get = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'get', data, responseType);\n};\nBLOGSTEP.post = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'post', data, responseType);\n};\n\nfunction load(name) {\n    var dfr = $.Deferred();\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].deferred === null) {\n            dfr.resolve(apps[name]);\n        } else {\n            apps[name].deferred.then(dfr.resolve, dfr.reject);\n        }\n    } else {\n        apps[name] = new App(name);\n        apps[name].deferred = dfr;\n        BLOGSTEP.get('load', {name: name}, 'html').done(function (data) {\n            var $doc = $('<div></div>');\n            $doc.html(data);\n            var $styles = $doc.children('link[rel=\"stylesheet\"]');\n            var $scripts = $doc.children('script[src]');\n            apps[name].frame = $doc.children('.frame');\n            apps[name].head = apps[name].frame.children('.frame-head');\n            apps[name].body = apps[name].frame.children('.frame-body');\n            apps[name].title = apps[name].head.find('.frame-title').text();\n            apps[name].state = 'loaded';\n            $doc.children('.tool-frame').each(function () {\n                apps[name].toolFrames[$(this).data('name')] = $(this);\n            });\n            var $dockFrame = $doc.children('.dock-frame').first();\n            if ($dockFrame.length === 0) {\n                $dockFrame = $('<div class=\"dock-frame\">');\n                $('<img>')\n                        .attr('src', BLOGSTEP.PATH + '/assets/img/icons/32/app.png')\n                        .attr('alt', name)\n                        .appendTo($dockFrame);\n                $('<label>')\n                        .text(name)\n                        .appendTo($dockFrame);\n            }\n            $dockFrame.click(function () {\n                BLOGSTEP.restore(name);\n            });\n            apps[name].dockFrame = $dockFrame;\n            $('head').append($styles);\n            $('main').append(apps[name].frame);\n            $scripts.each(function () {\n                $.getScript($(this).attr('src')).fail(dfr.reject);\n            });\n        }).fail(dfr.reject);\n    }\n    return dfr.promise();\n}\n\nfunction handleLogin(done) {\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        var data = {\n            username: $('#login-username').val(),\n            password: $('#login-password').val(),\n            remember: $('#login-remember').is(':checked') ? {remember: 'remember'} : null\n        };\n        BLOGSTEP.post('login', data).done(function () {\n            $('#login').find('input').prop('disabled', false);\n            $('#workspace-menu .username').text(data.username);\n            $('#login-frame').css({overflow: 'hidden', whiteSpace: 'no-wrap'}).animate({width: 0}, function () {\n                $(this).hide().css({overflow: '', whiteSpace: '', width: ''});\n                $('#login').off('submit');\n                $('#login-password').val('');\n                done();\n            });\n        }).fail(function () {\n            $('#login').find('input').prop('disabled', false);\n            ui.shake($('#login-frame'));\n            $('#login-username').select();\n            $('#login-password').val('');\n        });\n        return false;\n    });\n}\n;\n\n$.ajaxSetup({\n    headers: {'X-Csrf-Token': BLOGSTEP.getToken()}\n});\n\n$(document).ready(function () {\n    BLOGSTEP.get('who-am-i').done(function (data) {\n        $('#workspace-menu').show();\n        $('#workspace-menu .username').text(data.username);\n\n        $('#workspace-menu [data-action=\"file-system\"]').click(function () {\n            if (!BLOGSTEP.restore('files')) {\n                BLOGSTEP.run('files');\n            }\n        });\n        $('#workspace-menu [data-action=\"builder\"]').click(function () {\n            BLOGSTEP.run('builder');\n        });\n        $('#workspace-menu [data-action=\"terminal\"]').click(function () {\n            BLOGSTEP.run('terminal');\n        });\n        $('#workspace-menu [data-action=\"control-panel\"]').click(function () {\n            BLOGSTEP.run('control-panel');\n        });\n        $('#workspace-menu [data-action=\"switch-user\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                $('#login-overlay').show();\n                $('#login-frame').show();\n                $('#login-username').select().focus();\n                handleLogin(function () {\n                    $('#login-overlay').hide();\n                });\n            });\n        });\n        $('#workspace-menu [data-action=\"logout\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                location.reload();\n            });\n        });\n\n        $('#login-username').val(data.username);\n        $('#login-overlay').addClass('login-overlay-dark');\n\n        var run = $('body').data('run');\n        if (run !== '') {\n            var args = $('body').data('args');\n            console.log(args);\n            BLOGSTEP.run(run, args);\n        } else {\n            BLOGSTEP.run('files', {path: '/'});\n        }\n    });\n});\n\n$(document).on('click', '[data-action=\"toggle-menu\"]', function (e) {\n    $('body').toggleClass('show-menu');\n    return false;\n});\n\n$('body').click(function (e) {\n    if ($('body').hasClass('show-menu')) {\n        $('body').removeClass('show-menu');\n    }\n});\n\n$(document).on('click', '[data-toggle] > *', function (e) {\n    if ($(this).is($(this).parent().data('toggle'))) {\n        $(this).toggleClass('active');\n    }\n});\n\n$(document).on('click', '[data-choice] > *', function (e) {\n    var selector = $(this).parent().data('choice');\n    if ($(this).is(selector)) {\n        $(this).parent().children(selector).removeClass('active');\n        $(this).addClass('active');\n    }\n});\n\n$(window).resize(function () {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            if (apps[name].onResize !== null) {\n                apps[name].onResize();\n            }\n        }\n    }\n});\n\n$(window).keydown(function (e) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            apps[name].keydown(e);\n        }\n    }\n});\n\nwindow.onpopstate = function (event) {\n    if (event.state !== null) {\n        skipHistory = true;\n        BLOGSTEP.run(event.state.app, event.state.args);\n        skipHistory = false;\n    }\n};\n\nwindow.onbeforeunload = function (event) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && (apps[name].state === 'running' || apps[name].state === 'suspended')) {\n            if (apps[name].isUnsaved !== null) {\n                if (apps[name].isUnsaved()) {\n                    if (apps[name].state === 'suspended') {\n                        BLOGSTEP.restore(name);\n                    }\n                    return 'Unsaved data in: ' + apps[name].title;\n                }\n            }\n        }\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./workspace.js","/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/www/blogstep/~/js-cookie/src/js.cookie.js\n// module id = 4\n// module chunks = 0 1 2 3 5 6"],"sourceRoot":""}
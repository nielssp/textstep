{"version":3,"sources":["webpack:///dist/workspace.js","webpack:///./common/paths.js","webpack:///./common/ui.js","webpack:///./workspace.js","webpack:////home/www/blogstep/~/js-cookie/src/js.cookie.js","webpack:///./Config.js"],"names":["webpackJsonp","2","module","exports","__webpack_require__","dirName","path","replace","fileName","convert","cwd","trim","startsWith","names","split","stack","i","length","pop","push","join","3","$","Cookies","ajaxSetup","headers","X-Csrf-Token","get","shake","el","amount","dbl","width","animate","marginLeft","queue","css","finish","onLongPress","callback","touching","start","e","end","addEventListener","setProgress","progress","status","bar","children","label","Math","floor","className","style","innerText","handleLogin","done","data","find","prop","show","submit","this","ajax","url","method","username","val","password","remember","is","success","overflow","whiteSpace","hide","off","error","xhr","select","global","handleError","event","settings","thrownError","newToken","focus","responseJSON","alert","message","responseText","console","log","33","Menu","app","title","frame","header","itemList","text","Dialog","parent","deferred","overlay","appendTo","head","body","App","name","state","args","dockFrame","actions","actionGroups","keyMap","menus","toolFrames","onInit","onSuspend","onResume","onOpen","onReopen","onFocus","onKeydown","onUnfocus","onClose","onResize","isUnsaved","load","dfr","Deferred","apps","hasOwnProperty","resolve","then","reject","BLOGSTEP","$doc","html","$styles","$scripts","each","$dockFrame","first","attr","PATH","click","restore","append","getScript","fail","promise","post","ui","_Config","_Config2","obj","__esModule","default","paths","window","config","keys","tasks","running","skipHistory","previousTitle","prototype","addItem","action","button","activate","item","key","setTitle","open","close","result","detach","dialog","footer","okButton","keydown","confirm","choices","arguments","undefined","defaultChoice","defaultButton","prompt","value","content","input","setSelectionRange","addMenu","menu","defaultPrevented","isDialogOpen","ctrlKey","altKey","shiftKey","metaKey","toUpperCase","preventDefault","bindKey","parts","toLowerCase","defineAction","groups","stopPropagation","forEach","group","apply","enableGroup","enableAction","disableGroup","disableAction","document","setArgs","isEmptyObject","param","history","pushState","init","prepend","addClass","kill","removeClass","resume","reopen","suspend","index","indexOf","splice","getTasks","Object","values","run","match","type","getToken","addToken","setRequestHeader","responseType","dataType","jqXhr","textStatus","errorThrown","Array","slice","call","rejectWith","ready","location","reload","on","toggleClass","hasClass","selector","resize","onpopstate","onbeforeunload","4","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","factory","registeredInModuleLoader","OldCookies","api","noConflict","extend","attributes","converter","defaults","expires","Date","setMilliseconds","getMilliseconds","toUTCString","JSON","stringify","test","write","encodeURIComponent","String","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","cookies","rdecode","json","charAt","read","parse","set","getJSON","remove","withConverter","67","Config","getter","setter","root","ns","Property","listeners","dirty","defineProperty","getSubconfig","subconfig","update","commit","bind","element","property","change"],"mappings":"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","file":"dist/workspace.js","sourcesContent":["webpackJsonp([4],{\n\n/***/ 2:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path) {\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path) {\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd) {\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n/***/ }),\n\n/***/ 3:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar Cookies = __webpack_require__(4);\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width()).animate({ marginLeft: '+=' + amount }, 50).animate({ marginLeft: '-=' + dbl }, 50).animate({ marginLeft: '+=' + dbl }, 50).animate({ marginLeft: '-=' + amount }, 50).queue(function () {\n        $(el).css('width', '').css('margin-left', '').finish();\n    });\n};\n\nexports.onLongPress = function (el, callback) {\n    var touching = false;\n\n    var start = function start(e) {\n        touching = true;\n    };\n\n    var end = function end(e) {\n        touching = false;\n    };\n\n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function (el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function success() {\n                $('#login-frame').css({ overflow: 'hidden', whiteSpace: 'no-wrap' }).animate({ width: 0 }, function () {\n                    $(this).hide().css({ overflow: '', whiteSpace: '', width: '' });\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function error(xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n        if ($('#login-username').val() === '') {\n            $('#login-username').focus();\n        } else {\n            $('#login-password').focus();\n        }\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n/***/ }),\n\n/***/ 33:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _Config = __webpack_require__(67);\n\nvar _Config2 = _interopRequireDefault(_Config);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = __webpack_require__(0);\nvar Cookies = __webpack_require__(4);\nvar ui = __webpack_require__(3);\nvar paths = __webpack_require__(2);\n\nwindow.BLOGSTEP = {};\n\nwindow.BLOGSTEP.ui = ui;\nwindow.BLOGSTEP.paths = paths;\n\nwindow.BLOGSTEP.config = new _Config2.default(function (keys) {\n    return BLOGSTEP.get('get-conf', { keys: keys });\n}, function (data) {\n    return BLOGSTEP.post('set-conf', { data: data });\n});\n\nvar apps = {};\n\nvar tasks = [];\nvar running = null;\nvar skipHistory = false;\nvar previousTitle = null;\n\nfunction Menu(app, title) {\n    this.app = app;\n    this.title = title;\n    this.frame = $('<div><header></header><nav><ul></ul></div>');\n    this.header = this.frame.find('header');\n    this.itemList = this.frame.find('ul');\n    this.header.text(title);\n}\n\nMenu.prototype.addItem = function (label, action) {\n    var button = $('<button/>');\n    button.text(label);\n    if (typeof action === 'string') {\n        button.attr('data-action', action);\n    }\n    var app = this.app;\n    button.click(function () {\n        app.activate(action);\n    });\n    var item = $('<li>');\n    item.append(button);\n    for (var key in this.app.keyMap) {\n        if (this.app.keyMap.hasOwnProperty(key) && this.app.keyMap[key] === action) {\n            button.append('<span class=\"shortcut\">' + key + '</span>');\n        }\n    }\n    this.itemList.append(item);\n};\n\nfunction Dialog(parent) {\n    this.deferred = null;\n    this.parent = parent;\n    this.overlay = $('<div class=\"dialog-overlay\">');\n    this.frame = $('<div class=\"frame\">').appendTo(this.overlay);\n    this.head = $('<div class=\"frame-head\">').appendTo(this.frame);\n    this.body = $('<form class=\"frame-body\">').appendTo(this.frame);\n    $('<div class=\"frame-title\">').appendTo(this.head);\n};\n\nDialog.prototype.setTitle = function (title) {\n    this.head.find('.frame-title').text(title);\n};\n\nDialog.prototype.open = function () {\n    this.deferred = $.Deferred();\n    if (this.parent.children('.dialog-overlay').length > 0) {\n        // TODO: what to do? queue or something else?\n        this.deferred.reject();\n    } else {\n        this.overlay.appendTo(this.parent);\n    }\n    return this.deferred.promise();\n};\n\nDialog.prototype.close = function (result) {\n    this.overlay.detach();\n    this.deferred.resolve(result);\n};\n\nDialog.alert = function (parent, title, message) {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var okButton = $('<button>').text('OK').appendTo(footer);\n    okButton.click(function () {\n        dialog.close();\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    okButton.focus();\n    return dfr;\n};\n\nDialog.confirm = function (parent, title, message) {\n    var choices = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : ['OK', 'Cancel'];\n    var defaultChoice = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'OK';\n\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var defaultButton = null;\n    for (var i = 0; i < choices.length; i++) {\n        footer.append(' ');\n        var button = $('<button>').text(choices[i]).appendTo(footer);\n        button.click(function () {\n            dialog.close($(this).text());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n        if (choices[i] === defaultChoice) {\n            defaultButton = button;\n        }\n    }\n    var dfr = dialog.open();\n    if (defaultButton !== null) {\n        defaultButton.focus();\n    }\n    return dfr;\n};\n\nDialog.prompt = function (parent, title, message) {\n    var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    var content = $('<div class=\"frame-content\">').appendTo(dialog.body);\n    $('<div>').text(message).appendTo(content);\n    var input = $('<input type=\"text\">').appendTo(content);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    dialog.body.submit(function (e) {\n        dialog.close(input.val());\n    });\n    input.keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    $('<input type=\"submit\">').text('OK').appendTo(footer).click(function () {\n        dialog.close(input.val());\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    footer.append(' ');\n    $('<button>').text('Cancel').appendTo(footer).click(function () {\n        dialog.close(null);\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    input.focus();\n    if (value.length > 0) {\n        input.val(value);\n        input[0].setSelectionRange(0, value.length);\n    }\n    return dfr;\n};\n\nfunction App(name) {\n    this.name = name;\n    this.title = '';\n    this.state = 'loading';\n    this.deferred = null;\n    this.args = null;\n    this.frame = null;\n    this.head = null;\n    this.body = null;\n    this.dockFrame = null;\n    this.actions = {};\n    this.actionGroups = {};\n    this.keyMap = {};\n    this.menus = [];\n    this.toolFrames = {};\n    this.onInit = null;\n    this.onSuspend = null;\n    this.onResume = null;\n    this.onOpen = null;\n    this.onReopen = null;\n    this.onFocus = null;\n    this.onKeydown = null;\n    this.onUnfocus = null;\n    this.onClose = null;\n    this.onResize = null;\n    this.isUnsaved = null;\n}\n\nApp.prototype.addMenu = function (title) {\n    var menu = new Menu(this, title);\n    this.menus.push(menu);\n    return menu;\n};\n\nApp.prototype.alert = function (title, message) {\n    return Dialog.alert(this.body, title, message);\n};\n\nApp.prototype.confirm = function (title, message, choices, defaultChoice) {\n    return Dialog.confirm(this.body, title, message, choices, defaultChoice);\n};\n\nApp.prototype.prompt = function (title, message, value) {\n    return Dialog.prompt(this.body, title, message, value);\n};\n\nApp.prototype.keydown = function (e) {\n    if (e.defaultPrevented || this.isDialogOpen()) {\n        return;\n    }\n    if (this.onKeydown !== null) {\n        if (!this.onKeydown(e)) {\n            return false;\n        }\n    }\n    var key = '';\n    if (e.ctrlKey) {\n        key += 'Ctrl+';\n    }\n    if (e.altKey) {\n        key += 'Alt+';\n    }\n    if (e.shiftKey) {\n        key += 'Shift+';\n    }\n    if (e.metaKey) {\n        key += 'Meta+';\n    }\n    key += e.key.toUpperCase();\n    if (this.keyMap.hasOwnProperty(key)) {\n        e.preventDefault();\n        this.activate(this.keyMap[key]);\n        return false;\n    }\n};\n\nApp.prototype.bindKey = function (key, action) {\n    var parts = key.toLowerCase().split(/-|\\+/);\n    var e = { ctrlKey: '', altKey: '', shiftKey: '' };\n    var key = parts[parts.length - 1];\n    for (var i = 0; i < parts.length - 1; i++) {\n        switch (parts[i]) {\n            case 'c':\n                e.ctrlKey = 'Ctrl+';\n                break;\n            case 'a':\n                e.altKey = 'Alt+';\n                break;\n            case 's':\n                e.shiftKey = 'Shift+';\n                break;\n            case 'm':\n                e.metaKey = 'Meta+';\n                break;\n        }\n    }\n    key = e.ctrlKey + e.altKey + e.shiftKey + key.toUpperCase();\n    this.keyMap[key] = action;\n};\n\nApp.prototype.defineAction = function (name, callback, groups) {\n    var app = this;\n    this.actions[name] = callback;\n    this.frame.find('[data-action=\"' + name + '\"]').click(function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        app.activate(name);\n        return false;\n    });\n    if (typeof groups !== 'undefined') {\n        groups.forEach(function (group) {\n            if (!this.actionGroups.hasOwnProperty(group)) {\n                this.actionGroups[group] = [];\n            }\n            this.actionGroups[group].push(name);\n        }, this);\n    }\n};\n\nApp.prototype.activate = function (name) {\n    if (typeof name === 'string') {\n        this.actions[name].apply(this, [name]);\n    } else {\n        name.apply(this);\n    }\n};\n\nApp.prototype.isDialogOpen = function () {\n    return this.body.children('.dialog-overlay').length > 0;\n};\n\nApp.prototype.enableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.enableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        });\n    } else {\n        name.forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        });\n    } else {\n        name.forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.setTitle = function (title) {\n    this.title = title;\n    this.head.find('.frame-title').text(this.title);\n    this.dockFrame.attr('title', this.title);\n    document.title = this.title;\n};\n\nApp.prototype.setArgs = function (args) {\n    this.args = args;\n    if (!skipHistory) {\n        var path = BLOGSTEP.PATH + '/app/' + this.name;\n        if (!$.isEmptyObject(args)) {\n            path += '?' + $.param(args).replace(/%2F/gi, '/');\n        }\n        if (previousTitle !== null) {\n            document.title = previousTitle;\n        }\n        history.pushState({ app: this.name, args: args }, previousTitle, path);\n        document.title = this.title;\n        previousTitle = this.title;\n    }\n};\n\nApp.prototype.init = function () {\n    if (this.state !== 'loaded') {\n        console.error('init: unexpected state', this.state, 'app', this.name);\n        return;\n    }\n    this.state = 'initializing';\n    this.defineAction('close', this.close);\n    this.bindKey('c-s-c', 'close');\n    if (this.onInit !== null) {\n        this.onInit(this);\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            $('#menu').prepend(this.toolFrames[name]);\n        }\n    }\n    for (var i = 0; i < this.menus.length; i++) {\n        $('#menu').prepend(this.menus[i].frame);\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.open = function (args) {\n    if (this.state !== 'initialized') {\n        console.error(this.name + ': open: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'opening';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onOpen !== null) {\n        try {\n            this.onOpen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': open: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    }\n    if (this.dockFrame !== null) {\n        $('#dock').append(this.dockFrame);\n    }\n    this.setArgs(args);\n    this.state = 'running';\n};\n\nApp.prototype.kill = function () {\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        try {\n            this.onClose(this);\n        } catch (e) {}\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.close = function (action) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': close: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        var ok = this.onClose(this, action);\n        if (ok === false) {\n            this.state = 'running';\n            return false;\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n    return true;\n};\n\nApp.prototype.reopen = function (args) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': reopen: unexpected state:', this.state);\n        return;\n    }\n    if (this.onReopen !== null) {\n        try {\n            this.onReopen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': reopen: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    } else {\n        this.state = 'closing';\n        if (this.onClose !== null) {\n            this.onClose(this);\n        }\n        this.state = 'initialized';\n        this.open(args);\n    }\n};\n\nApp.prototype.suspend = function () {\n    if (this.state !== 'running') {\n        console.error(this.name + ': suspend: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'suspending';\n    if (this.onSuspend !== null) {\n        this.onSuspend(this);\n    }\n    if (this.state === 'suspending') {\n        this.frame.removeClass('active').hide();\n        for (var i = 0; i < this.menus.length; i++) {\n            this.menus[i].frame.hide();\n        }\n        for (var name in this.toolFrames) {\n            if (this.toolFrames.hasOwnProperty(name)) {\n                this.toolFrames[name].hide();\n            }\n        }\n        this.state = 'suspended';\n    }\n};\n\nApp.prototype.resume = function () {\n    if (this.state !== 'suspended') {\n        console.error(this.name + ': resume: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'resuming';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onResume !== null) {\n        this.onResume(this);\n    }\n    this.setArgs(this.args);\n    if (this.onResize !== null) {\n        this.onResize();\n    }\n    this.state = 'running';\n};\n\nBLOGSTEP.PATH = $('body').data('path').replace(/\\/$/, '');\n\nBLOGSTEP.init = function (name, onInit) {\n    apps[name].onInit = onInit;\n    apps[name].init();\n    if (apps[name].deferred !== null) {\n        apps[name].deferred.resolve(apps[name]);\n        apps[name].deferred = null;\n    }\n};\n\nBLOGSTEP.restore = function (name) {\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'suspended') {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            var index = tasks.indexOf(apps[name]);\n            if (index >= 0) {\n                tasks.splice(index, 1);\n            }\n            apps[name].resume();\n            return true;\n        } else if (apps[name].state === 'running') {\n            return true;\n        }\n    }\n    return false;\n};\n\nBLOGSTEP.getTasks = function () {\n    return Object.values(apps);\n};\n\nBLOGSTEP.run = function (name, args) {\n    var dfr = $.Deferred();\n    args = args || {};\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'running') {\n            apps[name].reopen(args);\n        } else {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            if (apps[name].state === 'suspended') {\n                var index = tasks.indexOf(apps[name]);\n                if (index >= 0) {\n                    tasks.splice(index, 1);\n                }\n                apps[name].resume();\n                apps[name].reopen(args);\n            } else {\n                apps[name].open(args);\n            }\n        }\n        dfr.resolve(apps[name]);\n    } else {\n        if (running !== null) {\n            running.suspend();\n            tasks.push(running);\n            running = null;\n        }\n        load(name).done(function (app) {\n            running = app;\n            app.open(args);\n            dfr.resolve(app);\n        });\n    }\n    return dfr.promise();\n};\n\nBLOGSTEP.open = function (path) {\n    var fileName = paths.fileName(path);\n    if (fileName.match(/\\.md/i)) {\n        BLOGSTEP.run('editor', { path: path });\n    } else if (fileName.match(/\\.webm/i)) {\n        BLOGSTEP.run('player', { path: path });\n    } else if (fileName.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n        BLOGSTEP.run('viewer', { path: path });\n    } else if (fileName.match(/\\.(?:php|log|json|html|css|js|sass|scss)/i)) {\n        BLOGSTEP.run('code-editor', { path: path });\n    } else {\n        BLOGSTEP.get('list-files', { path: path }).done(function (data) {\n            if (data.type === 'directory') {\n                BLOGSTEP.run('files', { path: path });\n            } else {\n                BLOGSTEP.run('code-editor', { path: path });\n            }\n        });\n    }\n};\n\nBLOGSTEP.getToken = function () {\n    return Cookies.get('csrf_token');\n};\n\nBLOGSTEP.addToken = function (xhr) {\n    xhr.setRequestHeader('X-Csrf-Token', BLOGSTEP.getToken());\n};\n\nBLOGSTEP.ajax = function (url, method, data, responseType) {\n    var dfr = $.Deferred();\n\n    var settings = {\n        url: url,\n        method: method,\n        data: data,\n        dataType: responseType,\n        headers: { 'X-Csrf-Token': BLOGSTEP.getToken() }\n    };\n\n    var xhr = $.ajax(settings);\n    xhr.done(dfr.resolve);\n    xhr.fail(function (jqXhr, textStatus, errorThrown) {\n        console.log(jqXhr, textStatus, errorThrown);\n        var newToken = BLOGSTEP.getToken();\n        if (settings.headers['X-Csrf-Token'] !== newToken) {\n            settings.headers['X-Csrf-Token'] = newToken;\n            if (xhr.status === 400) {\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n                return;\n            }\n        }\n        if (xhr.status === 401) {\n            $('#login-overlay').show();\n            if ($('#login-username').val() === '') {\n                $('#login-username').focus();\n            } else {\n                $('#login-password').focus();\n            }\n            handleLogin(function () {\n                $('#login-overlay').hide();\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n            });\n            return;\n        } else if (typeof xhr.responseJSON !== 'undefined') {\n            alert(xhr.responseJSON.message);\n        }\n        ui.shake($('main > .frame.active'));\n\n        var args = Array.prototype.slice.call(arguments);\n        dfr.rejectWith(xhr, args);\n    });\n\n    return dfr.promise();\n};\n\nBLOGSTEP.get = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'get', data, responseType);\n};\nBLOGSTEP.post = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'post', data, responseType);\n};\n\nfunction load(name) {\n    var dfr = $.Deferred();\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].deferred === null) {\n            dfr.resolve(apps[name]);\n        } else {\n            apps[name].deferred.then(dfr.resolve, dfr.reject);\n        }\n    } else {\n        apps[name] = new App(name);\n        apps[name].deferred = dfr;\n        BLOGSTEP.get('load', { name: name }, 'html').done(function (data) {\n            var $doc = $('<div></div>');\n            $doc.html(data);\n            var $styles = $doc.children('link[rel=\"stylesheet\"]');\n            var $scripts = $doc.children('script[src]');\n            apps[name].frame = $doc.children('.frame');\n            apps[name].head = apps[name].frame.children('.frame-head');\n            apps[name].body = apps[name].frame.children('.frame-body');\n            apps[name].title = apps[name].head.find('.frame-title').text();\n            apps[name].state = 'loaded';\n            $doc.children('.tool-frame').each(function () {\n                apps[name].toolFrames[$(this).data('name')] = $(this);\n            });\n            var $dockFrame = $doc.children('.dock-frame').first();\n            if ($dockFrame.length === 0) {\n                $dockFrame = $('<div class=\"dock-frame\">');\n                $('<img>').attr('src', BLOGSTEP.PATH + '/assets/img/icons/32/app.png').attr('alt', name).appendTo($dockFrame);\n                $('<label>').text(name).appendTo($dockFrame);\n            }\n            $dockFrame.click(function () {\n                BLOGSTEP.restore(name);\n            });\n            apps[name].dockFrame = $dockFrame;\n            $('head').append($styles);\n            $('main').append(apps[name].frame);\n            $scripts.each(function () {\n                $.getScript($(this).attr('src')).fail(dfr.reject);\n            });\n        }).fail(dfr.reject);\n    }\n    return dfr.promise();\n}\n\nfunction handleLogin(done) {\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        var data = {\n            username: $('#login-username').val(),\n            password: $('#login-password').val(),\n            remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n        };\n        BLOGSTEP.post('login', data).done(function () {\n            $('#login').find('input').prop('disabled', false);\n            $('#workspace-menu .username').text(data.username);\n            $('#login-frame').css({ overflow: 'hidden', whiteSpace: 'no-wrap' }).animate({ width: 0 }, function () {\n                $(this).hide().css({ overflow: '', whiteSpace: '', width: '' });\n                $('#login').off('submit');\n                $('#login-password').val('');\n                done();\n            });\n        }).fail(function () {\n            $('#login').find('input').prop('disabled', false);\n            ui.shake($('#login-frame'));\n            $('#login-username').select();\n            $('#login-password').val('');\n        });\n        return false;\n    });\n}\n;\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': BLOGSTEP.getToken() }\n});\n\n$(document).ready(function () {\n    BLOGSTEP.get('who-am-i').done(function (data) {\n        $('#workspace-menu').show();\n        $('#workspace-menu .username').text(data.username);\n\n        $('#workspace-menu [data-action=\"file-system\"]').click(function () {\n            if (!BLOGSTEP.restore('files')) {\n                BLOGSTEP.run('files');\n            }\n        });\n        $('#workspace-menu [data-action=\"builder\"]').click(function () {\n            BLOGSTEP.run('builder');\n        });\n        $('#workspace-menu [data-action=\"terminal\"]').click(function () {\n            BLOGSTEP.run('terminal');\n        });\n        $('#workspace-menu [data-action=\"control-panel\"]').click(function () {\n            BLOGSTEP.run('control-panel');\n        });\n        $('#workspace-menu [data-action=\"switch-user\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                $('#login-overlay').show();\n                $('#login-frame').show();\n                $('#login-username').select().focus();\n                handleLogin(function () {\n                    $('#login-overlay').hide();\n                });\n            });\n        });\n        $('#workspace-menu [data-action=\"logout\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                location.reload();\n            });\n        });\n\n        $('#login-username').val(data.username);\n        $('#login-overlay').addClass('login-overlay-dark');\n\n        var run = $('body').data('run');\n        if (run !== '') {\n            var args = $('body').data('args');\n            console.log(args);\n            BLOGSTEP.run(run, args);\n        } else {\n            BLOGSTEP.run('files', { path: '/' });\n        }\n    });\n});\n\n$(document).on('click', '[data-action=\"toggle-menu\"]', function (e) {\n    $('body').toggleClass('show-menu');\n    return false;\n});\n\n$('body').click(function (e) {\n    if ($('body').hasClass('show-menu')) {\n        $('body').removeClass('show-menu');\n    }\n});\n\n$(document).on('click', '[data-toggle] > *', function (e) {\n    if ($(this).is($(this).parent().data('toggle'))) {\n        $(this).toggleClass('active');\n    }\n});\n\n$(document).on('click', '[data-choice] > *', function (e) {\n    var selector = $(this).parent().data('choice');\n    if ($(this).is(selector)) {\n        $(this).parent().children(selector).removeClass('active');\n        $(this).addClass('active');\n    }\n});\n\n$(window).resize(function () {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            if (apps[name].onResize !== null) {\n                apps[name].onResize();\n            }\n        }\n    }\n});\n\n$(window).keydown(function (e) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            apps[name].keydown(e);\n        }\n    }\n});\n\nwindow.onpopstate = function (event) {\n    if (event.state !== null) {\n        skipHistory = true;\n        BLOGSTEP.run(event.state.app, event.state.args);\n        skipHistory = false;\n    }\n};\n\nwindow.onbeforeunload = function (event) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && (apps[name].state === 'running' || apps[name].state === 'suspended')) {\n            if (apps[name].isUnsaved !== null) {\n                if (apps[name].isUnsaved()) {\n                    if (apps[name].state === 'suspended') {\n                        BLOGSTEP.restore(name);\n                    }\n                    return 'Unsaved data in: ' + apps[name].title;\n                }\n            }\n        }\n    }\n};\n\n/***/ }),\n\n/***/ 4:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (true) {\n\t\t!(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (true) {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n/***/ }),\n\n/***/ 67:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = Config;\n/* \n * BlogSTEP\n * Copyright (c) 2018 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar nsRegex = /^([a-zA-Z_][a-zA-Z0-9_]*(\\.[a-zA-Z_][a-zA-Z0-9_]*)*)?$/;\n\nfunction Config(getter, setter) {\n    this.getter = getter;\n    this.setter = setter;\n    this.root = this;\n    this.ns = '';\n    this.data = {};\n}\n\nConfig.prototype.getSubconfig = function (ns) {\n    var subconfig = new Config(null, null);\n    subconfig.root = this.root;\n    subconfig.ns = this.ns + ns + '.';\n    return subconfig;\n};\n\nConfig.prototype.get = function (key) {\n    if (this.ns !== '') {\n        return this.root.get(this.ns + key);\n    }\n    if (!this.data.hasOwnProperty(key)) {\n        this.data[key] = new Property();\n    }\n    return this.data[key];\n};\n\nConfig.prototype.update = function () {\n    var keys = [];\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key)) {\n            keys.push(key);\n        }\n    }\n    var config = this;\n    this.getter(keys).done(function (data) {\n        for (var key in data) {\n            if (!config.data.hasOwnProperty(key)) {\n                config.data[key] = new Property();\n            }\n            config.data[key].set(data[key]);\n            config.data[key].dirty = false;\n        }\n    });\n};\n\nConfig.prototype.commit = function () {\n    var data = {};\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key) && this.data[key].dirty) {\n            data[key] = this.data[key].get();\n        }\n    }\n    var config = this;\n    this.setter(data).done(function (result) {\n        for (var i = 0; i < result.length; i++) {\n            config.data[result[i]].dirty = false;\n        }\n    });\n};\n\nfunction Property() {\n    this.listeners = [];\n    this.value = null;\n    this.dirty = false;\n}\n\nProperty.prototype.bind = function (element) {\n    if (element.is('input')) {\n        var property = this;\n        element.val(this.value);\n        element.on('keydown keyup', function () {\n            property.set(element.val());\n        });\n        this.change(function (value) {\n            element.val(value);\n        });\n    }\n};\n\nProperty.prototype.change = function (callback) {\n    this.listeners.push(callback);\n};\n\nProperty.prototype.set = function (value) {\n    this.value = value;\n    this.dirty = true;\n    for (var i = 0; i < this.listeners.length; i++) {\n        this.listeners[i].apply(this, [value]);\n    }\n};\n\nProperty.prototype.get = function () {\n    return this.value;\n};\n\n/***/ })\n\n},[33]);\n\n\n// WEBPACK FOOTER //\n// dist/workspace.js","/* \n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nexports.dirName = dirName;\nexports.fileName = fileName;\nexports.convert = convert;\n\nfunction dirName(path)\n{\n    var path = path.replace(/\\/[^\\/]+$/, '');\n    if (path === '') {\n        return '/';\n    }\n    return path;\n}\n\nfunction fileName(path)\n{\n    return path.replace(/^.*\\//, '');\n}\n\nfunction convert(path, cwd)\n{\n    path = path.trim();\n    if (!path.startsWith('/')) {\n        path = cwd + '/' + path;\n    }\n    var names = path.split('/');\n    var stack = [];\n    for (var i = 0; i < names.length; i++) {\n        if (names[i] === '..') {\n            if (stack.length >= 1) {\n                stack.pop();\n            }\n        } else if (names[i] !== '' && names[i] !== '.') {\n            stack.push(names[i]);\n        }\n    }\n    return '/' + stack.join('/');\n}\n\n\n// WEBPACK FOOTER //\n// ./common/paths.js","/*\n * BlogSTEP\n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar $ = require('jquery');\nvar Cookies = require('js-cookie');\n\n$.ajaxSetup({\n    headers: { 'X-Csrf-Token': Cookies.get('csrf_token') }\n});\n\nexports.shake = function (el, amount) {\n    amount = typeof amount === \"undefined\" ? 10 : amount;\n    var dbl = amount * 2;\n    return $(el).width($(el).width())\n            .animate({marginLeft: '+=' + amount}, 50)\n            .animate({marginLeft: '-=' + dbl}, 50)\n            .animate({marginLeft: '+=' + dbl}, 50)\n            .animate({marginLeft: '-=' + amount}, 50)\n            .queue(function () {\n                $(el).css('width', '')\n                        .css('margin-left', '')\n                        .finish();\n            });\n};\n\nexports.onLongPress = function(el, callback) {\n    var touching = false;\n    \n    var start = function (e) {\n        touching = true;\n    };\n    \n    var end = function (e) {\n        touching = false;\n    };\n    \n    el.addEventListener('touchstart', start);\n    el.addEventListener('touchend', end);\n    el.addEventListener('touchcancel', end);\n    el.addEventListener('touchmove', end);\n    el.addEventListener('contextmenu', function (e) {\n        if (touching) {\n            return callback(e);\n        }\n    });\n};\n\nexports.setProgress = function(el, progress, status) {\n    var bar = el.children[0];\n    var label = el.children[1];\n    progress = Math.floor(progress);\n    if (progress >= 100) {\n        el.className = 'progress success';\n    } else {\n        el.className = 'progress active';\n    }\n    bar.style.width = progress + '%';\n    bar.innerText = progress + '%';\n    if (typeof status !== 'undefined') {\n        label.innerText = status;\n    }\n};\n\nexports.handleLogin = function (done) {\n    var path = $('body').data('path').replace(/\\/$/, '');\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        $.ajax({\n            url: path,\n            method: 'post',\n            data: {\n                username: $('#login-username').val(),\n                password: $('#login-password').val(),\n                remember: $('#login-remember').is(':checked') ? { remember: 'remember' } : null\n            },\n            success: function () {\n                $('#login-frame').css({overflow: 'hidden', whiteSpace: 'no-wrap'}).animate({width: 0}, function () {\n                    $(this).hide().css({overflow: '', whiteSpace: '', width: ''});\n                    $('#login').off('submit');\n                    $('#login-password').val('');\n                    done();\n                });\n            },\n            error: function (xhr) {\n                $('#login').find('input').prop('disabled', false);\n                exports.shake($('#login-frame'));\n                $('#login-username').select();\n                $('#login-password').val('');\n            },\n            global: false\n        });\n        return false;\n    });\n};\n\nexports.handleError = function (event, xhr, settings, thrownError) {\n    var newToken = Cookies.get('csrf_token');\n    if (settings.headers['X-Csrf-Token'] !== newToken) {\n        $.ajaxSetup({\n            headers: { 'X-Csrf-Token': newToken }\n        });\n        settings.headers['X-Csrf-Token'] = newToken;\n        $.ajax(settings);\n        return;\n    }\n    if (xhr.status === 401) {\n        $('#login-overlay').show();\n\tif ($('#login-username').val() === '') {\n\t    $('#login-username').focus();\n\t} else {\n\t    $('#login-password').focus();\n\t}\n        exports.handleLogin(function () {\n            $('#login-overlay').hide();\n            $.ajax(settings);\n        });\n        return;\n    } else if (typeof xhr.responseJSON !== 'undefined') {\n        alert(xhr.responseJSON.message);\n    } else {\n        alert(xhr.responseText);\n    }\n    exports.shake($('main > .frame.active'));\n    console.log(event, xhr, settings, thrownError);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./common/ui.js","/*\n * BlogSTEP \n * Copyright (c) 2016 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\n\nvar $ = require('jquery');\nvar Cookies = require('js-cookie');\nvar ui = require('./common/ui');\nvar paths = require('./common/paths');\n\nimport Config from './Config';\n\nwindow.BLOGSTEP = {};\n\nwindow.BLOGSTEP.ui = ui;\nwindow.BLOGSTEP.paths = paths;\n\nwindow.BLOGSTEP.config = new Config(function (keys) {\n    return BLOGSTEP.get('get-conf', { keys: keys });\n}, function (data) {\n    return BLOGSTEP.post('set-conf', { data: data });\n});\n\nvar apps = {};\n\nvar tasks = [];\nvar running = null;\nvar skipHistory = false;\nvar previousTitle = null;\n\nfunction Menu(app, title) {\n    this.app = app;\n    this.title = title;\n    this.frame = $('<div><header></header><nav><ul></ul></div>');\n    this.header = this.frame.find('header');\n    this.itemList = this.frame.find('ul');\n    this.header.text(title);\n}\n\nMenu.prototype.addItem = function (label, action) {\n    var button = $('<button/>');\n    button.text(label);\n    if (typeof action === 'string') {\n        button.attr('data-action', action);\n    }\n    var app = this.app;\n    button.click(function () {\n        app.activate(action);\n    });\n    var item = $('<li>');\n    item.append(button);\n    for (var key in this.app.keyMap) {\n        if (this.app.keyMap.hasOwnProperty(key) && this.app.keyMap[key] === action) {\n            button.append('<span class=\"shortcut\">' + key + '</span>');\n        }\n    }\n    this.itemList.append(item);\n};\n\nfunction Dialog(parent) {\n    this.deferred = null;\n    this.parent = parent;\n    this.overlay = $('<div class=\"dialog-overlay\">');\n    this.frame = $('<div class=\"frame\">').appendTo(this.overlay);\n    this.head = $('<div class=\"frame-head\">').appendTo(this.frame);\n    this.body = $('<form class=\"frame-body\">').appendTo(this.frame);\n    $('<div class=\"frame-title\">').appendTo(this.head);\n};\n\nDialog.prototype.setTitle = function (title) {\n    this.head.find('.frame-title').text(title);\n};\n\nDialog.prototype.open = function () {\n    this.deferred = $.Deferred();\n    if (this.parent.children('.dialog-overlay').length > 0) {\n        // TODO: what to do? queue or something else?\n        this.deferred.reject();\n    } else {\n        this.overlay.appendTo(this.parent);\n    }\n    return this.deferred.promise();\n};\n\nDialog.prototype.close = function (result) {\n    this.overlay.detach();\n    this.deferred.resolve(result);\n};\n\nDialog.alert = function (parent, title, message) {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var okButton = $('<button>').text('OK').appendTo(footer);\n    okButton.click(function () {\n        dialog.close();\n    }).keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    var dfr = dialog.open();\n    okButton.focus();\n    return dfr;\n};\n\nDialog.confirm = function (parent, title, message, choices = ['OK', 'Cancel'], defaultChoice = 'OK') {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    $('<div class=\"frame-content\">').text(message).appendTo(dialog.body);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    var defaultButton = null;\n    for (var i = 0; i < choices.length; i++) {\n        footer.append(' ');\n        var button = $('<button>').text(choices[i]).appendTo(footer);\n        button.click(function () {\n            dialog.close($(this).text());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n        if (choices[i] === defaultChoice) {\n            defaultButton = button;\n        }\n    }\n    var dfr = dialog.open();\n    if (defaultButton !== null) {\n        defaultButton.focus();\n    }\n    return dfr;\n};\n\nDialog.prompt = function (parent, title, message, value = '') {\n    var dialog = new Dialog(parent);\n    dialog.setTitle(title);\n    var content = $('<div class=\"frame-content\">').appendTo(dialog.body);\n    $('<div>').text(message).appendTo(content);\n    var input = $('<input type=\"text\">').appendTo(content);\n    var footer = $('<div class=\"frame-footer frame-footer-buttons\">').appendTo(dialog.body);\n    dialog.body.submit(function (e) {\n        dialog.close(input.val());\n    });\n    input.keydown(function (e) {\n        if (e.key === 'Escape') {\n            dialog.close(null);\n        }\n    });\n    $('<input type=\"submit\">').text('OK').appendTo(footer)\n        .click(function () {\n            dialog.close(input.val());\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n    footer.append(' ');\n    $('<button>').text('Cancel').appendTo(footer)\n        .click(function () {\n            dialog.close(null);\n        }).keydown(function (e) {\n            if (e.key === 'Escape') {\n                dialog.close(null);\n            }\n        });\n    var dfr = dialog.open();\n    input.focus();\n    if (value.length > 0) {\n        input.val(value);\n        input[0].setSelectionRange(0, value.length)\n    }\n    return dfr;\n};\n\nfunction App(name) {\n    this.name = name;\n    this.title = '';\n    this.state = 'loading';\n    this.deferred = null;\n    this.args = null;\n    this.frame = null;\n    this.head = null;\n    this.body = null;\n    this.dockFrame = null;\n    this.actions = {};\n    this.actionGroups = {};\n    this.keyMap = {};\n    this.menus = [];\n    this.toolFrames = {};\n    this.onInit = null;\n    this.onSuspend = null;\n    this.onResume = null;\n    this.onOpen = null;\n    this.onReopen = null;\n    this.onFocus = null;\n    this.onKeydown = null;\n    this.onUnfocus = null;\n    this.onClose = null;\n    this.onResize = null;\n    this.isUnsaved = null;\n}\n\nApp.prototype.addMenu = function (title) {\n    var menu = new Menu(this, title);\n    this.menus.push(menu);\n    return menu;\n};\n\nApp.prototype.alert = function (title, message) {\n    return Dialog.alert(this.body, title, message);\n};\n\nApp.prototype.confirm = function (title, message, choices, defaultChoice) {\n    return Dialog.confirm(this.body, title, message, choices, defaultChoice);\n};\n\nApp.prototype.prompt = function (title, message, value) {\n    return Dialog.prompt(this.body, title, message, value);\n};\n\nApp.prototype.keydown = function (e) {\n    if (e.defaultPrevented || this.isDialogOpen()) {\n        return;\n    }\n    if (this.onKeydown !== null) {\n        if (!this.onKeydown(e)) {\n            return false;\n        }\n    }\n    var key = '';\n    if (e.ctrlKey) {\n        key += 'Ctrl+';\n    }\n    if (e.altKey) {\n        key += 'Alt+';\n    }\n    if (e.shiftKey) {\n        key += 'Shift+';\n    }\n    if (e.metaKey) {\n        key += 'Meta+';\n    }\n    key += e.key.toUpperCase();\n    if (this.keyMap.hasOwnProperty(key)) {\n        e.preventDefault();\n        this.activate(this.keyMap[key]);\n        return false;\n    }\n};\n\nApp.prototype.bindKey = function (key, action) {\n    var parts = key.toLowerCase().split(/-|\\+/);\n    var e = {ctrlKey: '', altKey: '', shiftKey: ''};\n    var key = parts[parts.length - 1];\n    for (var i = 0; i < parts.length - 1; i++) {\n        switch (parts[i]) {\n            case 'c':\n                e.ctrlKey = 'Ctrl+';\n                break;\n            case 'a':\n                e.altKey = 'Alt+';\n                break;\n            case 's':\n                e.shiftKey = 'Shift+';\n                break;\n            case 'm':\n                e.metaKey = 'Meta+';\n                break;\n        }\n    }\n    key = e.ctrlKey + e.altKey + e.shiftKey + key.toUpperCase();\n    this.keyMap[key] = action;\n};\n\nApp.prototype.defineAction = function (name, callback, groups) {\n    var app = this;\n    this.actions[name] = callback;\n    this.frame.find('[data-action=\"' + name + '\"]').click(function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        app.activate(name);\n        return false;\n    });\n    if (typeof groups !== 'undefined') {\n        groups.forEach(function (group) {\n            if (!this.actionGroups.hasOwnProperty(group)) {\n                this.actionGroups[group] = [];\n            }\n            this.actionGroups[group].push(name);\n        }, this);\n    }\n};\n\nApp.prototype.activate = function (name) {\n    if (typeof name === 'string') {\n        this.actions[name].apply(this, [name]);\n    } else {\n        name.apply(this);\n    }\n};\n\nApp.prototype.isDialogOpen = function () {\n    return this.body.children('.dialog-overlay').length > 0;\n};\n\nApp.prototype.enableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableGroup = function (group) {\n    if (this.actionGroups.hasOwnProperty(group)) {\n        this.actionGroups[group].forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.enableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', false);\n        });\n    } else {\n        name.forEach(this.enableAction, this);\n    }\n};\n\nApp.prototype.disableAction = function (name) {\n    if (typeof name === 'string') {\n        this.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        this.menus.forEach(function (menu) {\n            menu.frame.find('[data-action=\"' + name + '\"]').attr('disabled', true);\n        });\n    } else {\n        name.forEach(this.disableAction, this);\n    }\n};\n\nApp.prototype.setTitle = function (title) {\n    this.title = title;\n    this.head.find('.frame-title').text(this.title);\n    this.dockFrame.attr('title', this.title);\n    document.title = this.title;\n};\n\nApp.prototype.setArgs = function (args) {\n    this.args = args;\n    if (!skipHistory) {\n        var path = BLOGSTEP.PATH + '/app/' + this.name;\n        if (!$.isEmptyObject(args)) {\n            path += '?' + $.param(args).replace(/%2F/gi, '/');\n        }\n        if (previousTitle !== null) {\n            document.title = previousTitle;\n        }\n        history.pushState({app: this.name, args: args}, previousTitle, path);\n        document.title = this.title;\n        previousTitle = this.title;\n    }\n};\n\nApp.prototype.init = function () {\n    if (this.state !== 'loaded') {\n        console.error('init: unexpected state', this.state, 'app', this.name);\n        return;\n    }\n    this.state = 'initializing';\n    this.defineAction('close', this.close);\n    this.bindKey('c-s-c', 'close');\n    if (this.onInit !== null) {\n        this.onInit(this);\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            $('#menu').prepend(this.toolFrames[name]);\n        }\n    }\n    for (var i = 0; i < this.menus.length; i++) {\n        $('#menu').prepend(this.menus[i].frame);\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.open = function (args) {\n    if (this.state !== 'initialized') {\n        console.error(this.name + ': open: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'opening';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onOpen !== null) {\n        try {\n            this.onOpen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': open: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    }\n    if (this.dockFrame !== null) {\n        $('#dock').append(this.dockFrame);\n    }\n    this.setArgs(args);\n    this.state = 'running';\n};\n\nApp.prototype.kill = function () {\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        try {\n            this.onClose(this);\n        } catch (e) {\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n};\n\nApp.prototype.close = function (action) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': close: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'closing';\n    if (this.onClose !== null) {\n        var ok = this.onClose(this, action);\n        if (ok === false) {\n            this.state = 'running';\n            return false;\n        }\n    }\n    this.frame.removeClass('active').hide();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.hide();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].hide();\n        }\n    }\n    if (running === this) {\n        if (tasks.length > 0) {\n            running = tasks.pop();\n            running.resume();\n        } else {\n            running = null;\n        }\n    }\n    if (this.dockFrame !== null) {\n        this.dockFrame.detach();\n    }\n    this.state = 'initialized';\n    return true;\n};\n\nApp.prototype.reopen = function (args) {\n    if (this.state !== 'running') {\n        console.error(this.name + ': reopen: unexpected state:', this.state);\n        return;\n    }\n    if (this.onReopen !== null) {\n        try {\n            this.onReopen(this, args || {});\n        } catch (e) {\n            console.error(this.name + ': reopen: exception caught:', e);\n            alert('Could not open application: ' + this.name);\n            this.kill();\n            return;\n        }\n    } else {\n        this.state = 'closing';\n        if (this.onClose !== null) {\n            this.onClose(this);\n        }\n        this.state = 'initialized';\n        this.open(args);\n    }\n};\n\nApp.prototype.suspend = function () {\n    if (this.state !== 'running') {\n        console.error(this.name + ': suspend: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'suspending';\n    if (this.onSuspend !== null) {\n        this.onSuspend(this);\n    }\n    if (this.state === 'suspending') {\n        this.frame.removeClass('active').hide();\n        for (var i = 0; i < this.menus.length; i++) {\n            this.menus[i].frame.hide();\n        }\n        for (var name in this.toolFrames) {\n            if (this.toolFrames.hasOwnProperty(name)) {\n                this.toolFrames[name].hide();\n            }\n        }\n        this.state = 'suspended';\n    }\n};\n\nApp.prototype.resume = function () {\n    if (this.state !== 'suspended') {\n        console.error(this.name + ': resume: unexpected state:', this.state);\n        return;\n    }\n    this.state = 'resuming';\n    this.setTitle(this.title);\n    this.frame.addClass('active').show();\n    for (var i = 0; i < this.menus.length; i++) {\n        this.menus[i].frame.show();\n    }\n    for (var name in this.toolFrames) {\n        if (this.toolFrames.hasOwnProperty(name)) {\n            this.toolFrames[name].show();\n        }\n    }\n    if (this.onResume !== null) {\n        this.onResume(this);\n    }\n    this.setArgs(this.args);\n    if (this.onResize !== null) {\n        this.onResize();\n    }\n    this.state = 'running';\n};\n\nBLOGSTEP.PATH = $('body').data('path').replace(/\\/$/, '');\n\nBLOGSTEP.init = function (name, onInit) {\n    apps[name].onInit = onInit;\n    apps[name].init();\n    if (apps[name].deferred !== null) {\n        apps[name].deferred.resolve(apps[name]);\n        apps[name].deferred = null;\n    }\n};\n\nBLOGSTEP.restore = function (name) {\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'suspended') {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            var index = tasks.indexOf(apps[name]);\n            if (index >= 0) {\n                tasks.splice(index, 1);\n            }\n            apps[name].resume();\n            return true;\n        } else if (apps[name].state === 'running') {\n            return true;\n        }\n    }\n    return false;\n};\n\nBLOGSTEP.getTasks = function () {\n    return Object.values(apps);\n};\n\nBLOGSTEP.run = function (name, args) {\n    var dfr = $.Deferred();\n    args = args || {};\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].state === 'running') {\n            apps[name].reopen(args);\n        } else {\n            if (running !== null) {\n                running.suspend();\n                tasks.push(running);\n            }\n            running = apps[name];\n            if (apps[name].state === 'suspended') {\n                var index = tasks.indexOf(apps[name]);\n                if (index >= 0) {\n                    tasks.splice(index, 1);\n                }\n                apps[name].resume();\n                apps[name].reopen(args);\n            } else {\n                apps[name].open(args);\n            }\n        }\n        dfr.resolve(apps[name]);\n    } else {\n        if (running !== null) {\n            running.suspend();\n            tasks.push(running);\n            running = null;\n        }\n        load(name).done(function (app) {\n            running = app;\n            app.open(args);\n            dfr.resolve(app);\n        });\n    }\n    return dfr.promise();\n};\n\nBLOGSTEP.open = function (path) {\n    var fileName = paths.fileName(path);\n    if (fileName.match(/\\.md/i)) {\n        BLOGSTEP.run('editor', {path: path});\n    } else if (fileName.match(/\\.webm/i)) {\n        BLOGSTEP.run('player', {path: path});\n    } else if (fileName.match(/\\.(?:jpe?g|png|gif|ico)/i)) {\n        BLOGSTEP.run('viewer', {path: path});\n    } else if (fileName.match(/\\.(?:php|log|json|html|css|js|sass|scss)/i)) {\n        BLOGSTEP.run('code-editor', {path: path});\n    } else {\n        BLOGSTEP.get('list-files', {path: path}).done(function (data) {\n            if (data.type === 'directory') {\n                BLOGSTEP.run('files', {path: path});\n            } else {\n                BLOGSTEP.run('code-editor', {path: path});\n            }\n        });\n    }\n};\n\nBLOGSTEP.getToken = function () {\n    return Cookies.get('csrf_token');\n};\n\nBLOGSTEP.addToken = function (xhr) {\n    xhr.setRequestHeader('X-Csrf-Token', BLOGSTEP.getToken());\n};\n\nBLOGSTEP.ajax = function (url, method, data, responseType) {\n    var dfr = $.Deferred();\n\n    var settings = {\n        url: url,\n        method: method,\n        data: data,\n        dataType: responseType,\n        headers: {'X-Csrf-Token': BLOGSTEP.getToken()}\n    };\n\n    var xhr = $.ajax(settings);\n    xhr.done(dfr.resolve);\n    xhr.fail(function (jqXhr, textStatus, errorThrown) {\n        console.log(jqXhr, textStatus, errorThrown);\n        var newToken = BLOGSTEP.getToken();\n        if (settings.headers['X-Csrf-Token'] !== newToken) {\n            settings.headers['X-Csrf-Token'] = newToken;\n            if (xhr.status === 400) {\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n                return;\n            }\n        }\n        if (xhr.status === 401) {\n            $('#login-overlay').show();\n            if ($('#login-username').val() === '') {\n                $('#login-username').focus();\n            } else {\n                $('#login-password').focus();\n            }\n            handleLogin(function () {\n                $('#login-overlay').hide();\n                $.ajax(settings).then(dfr.resolve, dfr.reject);\n            });\n            return;\n        } else if (typeof xhr.responseJSON !== 'undefined') {\n            alert(xhr.responseJSON.message);\n        }\n        ui.shake($('main > .frame.active'));\n\n        var args = Array.prototype.slice.call(arguments);\n        dfr.rejectWith(xhr, args);\n    });\n\n    return dfr.promise();\n};\n\nBLOGSTEP.get = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'get', data, responseType);\n};\nBLOGSTEP.post = function (action, data, responseType) {\n    return BLOGSTEP.ajax(BLOGSTEP.PATH + '/api/' + action, 'post', data, responseType);\n};\n\nfunction load(name) {\n    var dfr = $.Deferred();\n    if (apps.hasOwnProperty(name)) {\n        if (apps[name].deferred === null) {\n            dfr.resolve(apps[name]);\n        } else {\n            apps[name].deferred.then(dfr.resolve, dfr.reject);\n        }\n    } else {\n        apps[name] = new App(name);\n        apps[name].deferred = dfr;\n        BLOGSTEP.get('load', {name: name}, 'html').done(function (data) {\n            var $doc = $('<div></div>');\n            $doc.html(data);\n            var $styles = $doc.children('link[rel=\"stylesheet\"]');\n            var $scripts = $doc.children('script[src]');\n            apps[name].frame = $doc.children('.frame');\n            apps[name].head = apps[name].frame.children('.frame-head');\n            apps[name].body = apps[name].frame.children('.frame-body');\n            apps[name].title = apps[name].head.find('.frame-title').text();\n            apps[name].state = 'loaded';\n            $doc.children('.tool-frame').each(function () {\n                apps[name].toolFrames[$(this).data('name')] = $(this);\n            });\n            var $dockFrame = $doc.children('.dock-frame').first();\n            if ($dockFrame.length === 0) {\n                $dockFrame = $('<div class=\"dock-frame\">');\n                $('<img>')\n                        .attr('src', BLOGSTEP.PATH + '/assets/img/icons/32/app.png')\n                        .attr('alt', name)\n                        .appendTo($dockFrame);\n                $('<label>')\n                        .text(name)\n                        .appendTo($dockFrame);\n            }\n            $dockFrame.click(function () {\n                BLOGSTEP.restore(name);\n            });\n            apps[name].dockFrame = $dockFrame;\n            $('head').append($styles);\n            $('main').append(apps[name].frame);\n            $scripts.each(function () {\n                $.getScript($(this).attr('src')).fail(dfr.reject);\n            });\n        }).fail(dfr.reject);\n    }\n    return dfr.promise();\n}\n\nfunction handleLogin(done) {\n    $('#login').find('input').prop('disabled', false);\n    $('#login-frame').show();\n    $('#login').submit(function () {\n        $(this).find('input').prop('disabled', true);\n        var data = {\n            username: $('#login-username').val(),\n            password: $('#login-password').val(),\n            remember: $('#login-remember').is(':checked') ? {remember: 'remember'} : null\n        };\n        BLOGSTEP.post('login', data).done(function () {\n            $('#login').find('input').prop('disabled', false);\n            $('#workspace-menu .username').text(data.username);\n            $('#login-frame').css({overflow: 'hidden', whiteSpace: 'no-wrap'}).animate({width: 0}, function () {\n                $(this).hide().css({overflow: '', whiteSpace: '', width: ''});\n                $('#login').off('submit');\n                $('#login-password').val('');\n                done();\n            });\n        }).fail(function () {\n            $('#login').find('input').prop('disabled', false);\n            ui.shake($('#login-frame'));\n            $('#login-username').select();\n            $('#login-password').val('');\n        });\n        return false;\n    });\n}\n;\n\n$.ajaxSetup({\n    headers: {'X-Csrf-Token': BLOGSTEP.getToken()}\n});\n\n$(document).ready(function () {\n    BLOGSTEP.get('who-am-i').done(function (data) {\n        $('#workspace-menu').show();\n        $('#workspace-menu .username').text(data.username);\n\n        $('#workspace-menu [data-action=\"file-system\"]').click(function () {\n            if (!BLOGSTEP.restore('files')) {\n                BLOGSTEP.run('files');\n            }\n        });\n        $('#workspace-menu [data-action=\"builder\"]').click(function () {\n            BLOGSTEP.run('builder');\n        });\n        $('#workspace-menu [data-action=\"terminal\"]').click(function () {\n            BLOGSTEP.run('terminal');\n        });\n        $('#workspace-menu [data-action=\"control-panel\"]').click(function () {\n            BLOGSTEP.run('control-panel');\n        });\n        $('#workspace-menu [data-action=\"switch-user\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                $('#login-overlay').show();\n                $('#login-frame').show();\n                $('#login-username').select().focus();\n                handleLogin(function () {\n                    $('#login-overlay').hide();\n                });\n            });\n        });\n        $('#workspace-menu [data-action=\"logout\"]').click(function () {\n            BLOGSTEP.post('logout').done(function () {\n                location.reload();\n            });\n        });\n\n        $('#login-username').val(data.username);\n        $('#login-overlay').addClass('login-overlay-dark');\n\n        var run = $('body').data('run');\n        if (run !== '') {\n            var args = $('body').data('args');\n            console.log(args);\n            BLOGSTEP.run(run, args);\n        } else {\n            BLOGSTEP.run('files', {path: '/'});\n        }\n    });\n});\n\n$(document).on('click', '[data-action=\"toggle-menu\"]', function (e) {\n    $('body').toggleClass('show-menu');\n    return false;\n});\n\n$('body').click(function (e) {\n    if ($('body').hasClass('show-menu')) {\n        $('body').removeClass('show-menu');\n    }\n});\n\n$(document).on('click', '[data-toggle] > *', function (e) {\n    if ($(this).is($(this).parent().data('toggle'))) {\n        $(this).toggleClass('active');\n    }\n});\n\n$(document).on('click', '[data-choice] > *', function (e) {\n    var selector = $(this).parent().data('choice');\n    if ($(this).is(selector)) {\n        $(this).parent().children(selector).removeClass('active');\n        $(this).addClass('active');\n    }\n});\n\n$(window).resize(function () {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            if (apps[name].onResize !== null) {\n                apps[name].onResize();\n            }\n        }\n    }\n});\n\n$(window).keydown(function (e) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && apps[name].state === 'running') {\n            apps[name].keydown(e);\n        }\n    }\n});\n\nwindow.onpopstate = function (event) {\n    if (event.state !== null) {\n        skipHistory = true;\n        BLOGSTEP.run(event.state.app, event.state.args);\n        skipHistory = false;\n    }\n};\n\nwindow.onbeforeunload = function (event) {\n    for (var name in apps) {\n        if (apps.hasOwnProperty(name) && (apps[name].state === 'running' || apps[name].state === 'suspended')) {\n            if (apps[name].isUnsaved !== null) {\n                if (apps[name].isUnsaved()) {\n                    if (apps[name].state === 'suspended') {\n                        BLOGSTEP.restore(name);\n                    }\n                    return 'Unsaved data in: ' + apps[name].title;\n                }\n            }\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./workspace.js","/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/www/blogstep/~/js-cookie/src/js.cookie.js\n// module id = 4\n// module chunks = 0 1 2 4 5 6","/* \n * BlogSTEP\n * Copyright (c) 2018 Niels Sonnich Poulsen (http://nielssp.dk)\n * Licensed under the MIT license.\n * See the LICENSE file or http://opensource.org/licenses/MIT for more information.\n */\n\nvar nsRegex = /^([a-zA-Z_][a-zA-Z0-9_]*(\\.[a-zA-Z_][a-zA-Z0-9_]*)*)?$/;\n\nexport default function Config(getter, setter) {\n    this.getter = getter;\n    this.setter = setter;\n    this.root = this;\n    this.ns = '';\n    this.data = {};\n}\n\nConfig.prototype.getSubconfig = function (ns) {\n    var subconfig = new Config(null, null);\n    subconfig.root = this.root;\n    subconfig.ns = this.ns + ns + '.';\n    return subconfig;\n};\n\nConfig.prototype.get = function (key) {\n    if (this.ns !== '') {\n        return this.root.get(this.ns + key);\n    }\n    if (!this.data.hasOwnProperty(key)) {\n        this.data[key] = new Property();\n    }\n    return this.data[key];\n};\n\nConfig.prototype.update = function () {\n    var keys = [];\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key)) {\n            keys.push(key);\n        }\n    }\n    var config = this;\n    this.getter(keys).done(function (data) {\n        for (var key in data) {\n            if (!config.data.hasOwnProperty(key)) {\n                config.data[key] = new Property();\n            }\n            config.data[key].set(data[key]);\n            config.data[key].dirty = false;\n        }\n    });\n};\n\nConfig.prototype.commit = function () {\n    var data = {};\n    for (var key in this.data) {\n        if (this.data.hasOwnProperty(key) && this.data[key].dirty) {\n            data[key] = this.data[key].get();\n        }\n    }\n    var config = this;\n    this.setter(data).done(function (result) {\n        for (var i = 0; i < result.length; i++) {\n            config.data[result[i]].dirty = false;\n        }\n    });\n};\n\n\nfunction Property() {\n    this.listeners = [];\n    this.value = null;\n    this.dirty = false;\n}\n\nProperty.prototype.bind = function (element) {\n    if (element.is('input')) {\n        var property = this;\n        element.val(this.value);\n        element.on('keydown keyup', function () {\n            property.set(element.val());\n        });\n        this.change(function (value) {\n            element.val(value);\n        });\n    }\n};\n\nProperty.prototype.change = function (callback) {\n    this.listeners.push(callback);\n};\n\nProperty.prototype.set = function (value) {\n    this.value = value;\n    this.dirty = true;\n    for (var i = 0; i < this.listeners.length; i++) {\n        this.listeners[i].apply(this, [value]);\n    }\n};\n\nProperty.prototype.get = function () {\n    return this.value;\n};\n\n\n// WEBPACK FOOTER //\n// ./Config.js"],"sourceRoot":""}